{
  Shell parent=getParent();
  Display display=parent.getDisplay();
  shell=new Shell(parent,SWT.DIALOG_TRIM | SWT.RESIZE | SWT.MAX| SWT.MIN);
  props.setLook(shell);
  ModifyListener lsMod=new ModifyListener(){
    public void modifyText(    ModifyEvent e){
      jobentry.setChanged();
    }
  }
;
  changed=jobentry.hasChanged();
  FormLayout formLayout=new FormLayout();
  formLayout.marginWidth=Const.FORM_MARGIN;
  formLayout.marginHeight=Const.FORM_MARGIN;
  shell.setLayout(formLayout);
  shell.setText("Get files by FTP");
  int middle=props.getMiddlePct();
  int margin=Const.MARGIN;
  wlName=new Label(shell,SWT.RIGHT);
  wlName.setText("Job entry name ");
  props.setLook(wlName);
  fdlName=new FormData();
  fdlName.left=new FormAttachment(0,0);
  fdlName.right=new FormAttachment(middle,-margin);
  fdlName.top=new FormAttachment(0,margin);
  wlName.setLayoutData(fdlName);
  wName=new Text(shell,SWT.SINGLE | SWT.LEFT | SWT.BORDER);
  props.setLook(wName);
  wName.addModifyListener(lsMod);
  fdName=new FormData();
  fdName.left=new FormAttachment(middle,0);
  fdName.top=new FormAttachment(0,margin);
  fdName.right=new FormAttachment(100,0);
  wName.setLayoutData(fdName);
  wlURL=new Label(shell,SWT.RIGHT);
  wlURL.setText("URL (HTTP)");
  props.setLook(wlURL);
  fdlURL=new FormData();
  fdlURL.left=new FormAttachment(0,0);
  fdlURL.top=new FormAttachment(wName,margin);
  fdlURL.right=new FormAttachment(middle,-margin);
  wlURL.setLayoutData(fdlURL);
  wURL=new Text(shell,SWT.SINGLE | SWT.LEFT | SWT.BORDER);
  props.setLook(wURL);
  wURL.addModifyListener(lsMod);
  fdURL=new FormData();
  fdURL.left=new FormAttachment(middle,0);
  fdURL.top=new FormAttachment(wName,margin);
  fdURL.right=new FormAttachment(100,0);
  wURL.setLayoutData(fdURL);
  wlRunEveryRow=new Label(shell,SWT.RIGHT);
  wlRunEveryRow.setText("Run for every result row? ");
  props.setLook(wlRunEveryRow);
  fdlRunEveryRow=new FormData();
  fdlRunEveryRow.left=new FormAttachment(0,0);
  fdlRunEveryRow.top=new FormAttachment(wURL,margin);
  fdlRunEveryRow.right=new FormAttachment(middle,-margin);
  wlRunEveryRow.setLayoutData(fdlRunEveryRow);
  wRunEveryRow=new Button(shell,SWT.CHECK);
  props.setLook(wRunEveryRow);
  fdRunEveryRow=new FormData();
  fdRunEveryRow.left=new FormAttachment(middle,0);
  fdRunEveryRow.top=new FormAttachment(wURL,margin);
  fdRunEveryRow.right=new FormAttachment(100,0);
  wRunEveryRow.setLayoutData(fdRunEveryRow);
  wRunEveryRow.addSelectionListener(new SelectionAdapter(){
    public void widgetSelected(    SelectionEvent e){
      setFlags();
    }
  }
);
  wlFieldURL=new Label(shell,SWT.RIGHT);
  wlFieldURL.setText("Fieldname to get URL from");
  props.setLook(wlFieldURL);
  fdlFieldURL=new FormData();
  fdlFieldURL.left=new FormAttachment(0,0);
  fdlFieldURL.top=new FormAttachment(wRunEveryRow,margin);
  fdlFieldURL.right=new FormAttachment(middle,-margin);
  wlFieldURL.setLayoutData(fdlFieldURL);
  wFieldURL=new Text(shell,SWT.SINGLE | SWT.LEFT | SWT.BORDER);
  props.setLook(wFieldURL);
  wFieldURL.addModifyListener(lsMod);
  fdFieldURL=new FormData();
  fdFieldURL.left=new FormAttachment(middle,0);
  fdFieldURL.top=new FormAttachment(wRunEveryRow,margin);
  fdFieldURL.right=new FormAttachment(100,0);
  wFieldURL.setLayoutData(fdFieldURL);
  wlTargetFile=new Label(shell,SWT.RIGHT);
  wlTargetFile.setText("Target filename");
  props.setLook(wlTargetFile);
  fdlTargetFile=new FormData();
  fdlTargetFile.left=new FormAttachment(0,0);
  fdlTargetFile.top=new FormAttachment(wFieldURL,margin);
  fdlTargetFile.right=new FormAttachment(middle,-margin);
  wlTargetFile.setLayoutData(fdlTargetFile);
  wTargetFile=new Text(shell,SWT.SINGLE | SWT.LEFT | SWT.BORDER);
  props.setLook(wTargetFile);
  wTargetFile.addModifyListener(lsMod);
  fdTargetFile=new FormData();
  fdTargetFile.left=new FormAttachment(middle,0);
  fdTargetFile.top=new FormAttachment(wFieldURL,margin);
  fdTargetFile.right=new FormAttachment(100,0);
  wTargetFile.setLayoutData(fdTargetFile);
  wlAppend=new Label(shell,SWT.RIGHT);
  wlAppend.setText("Append to specified target file? ");
  props.setLook(wlAppend);
  fdlAppend=new FormData();
  fdlAppend.left=new FormAttachment(0,0);
  fdlAppend.top=new FormAttachment(wTargetFile,margin);
  fdlAppend.right=new FormAttachment(middle,-margin);
  wlAppend.setLayoutData(fdlAppend);
  wAppend=new Button(shell,SWT.CHECK);
  props.setLook(wAppend);
  fdAppend=new FormData();
  fdAppend.left=new FormAttachment(middle,0);
  fdAppend.top=new FormAttachment(wTargetFile,margin);
  fdAppend.right=new FormAttachment(100,0);
  wAppend.setLayoutData(fdAppend);
  wlDateTimeAdded=new Label(shell,SWT.RIGHT);
  wlDateTimeAdded.setText("Add date and time to target file name? ");
  props.setLook(wlDateTimeAdded);
  fdlDateTimeAdded=new FormData();
  fdlDateTimeAdded.left=new FormAttachment(0,0);
  fdlDateTimeAdded.top=new FormAttachment(wAppend,margin);
  fdlDateTimeAdded.right=new FormAttachment(middle,-margin);
  wlDateTimeAdded.setLayoutData(fdlDateTimeAdded);
  wDateTimeAdded=new Button(shell,SWT.CHECK);
  props.setLook(wDateTimeAdded);
  fdDateTimeAdded=new FormData();
  fdDateTimeAdded.left=new FormAttachment(middle,0);
  fdDateTimeAdded.top=new FormAttachment(wAppend,margin);
  fdDateTimeAdded.right=new FormAttachment(100,0);
  wDateTimeAdded.setLayoutData(fdDateTimeAdded);
  wDateTimeAdded.addSelectionListener(new SelectionAdapter(){
    public void widgetSelected(    SelectionEvent e){
      setFlags();
    }
  }
);
  wlTargetExt=new Label(shell,SWT.RIGHT);
  wlTargetExt.setText("Target filename extention");
  props.setLook(wlTargetExt);
  fdlTargetExt=new FormData();
  fdlTargetExt.left=new FormAttachment(0,0);
  fdlTargetExt.top=new FormAttachment(wDateTimeAdded,margin);
  fdlTargetExt.right=new FormAttachment(middle,-margin);
  wlTargetExt.setLayoutData(fdlTargetExt);
  wTargetExt=new Text(shell,SWT.SINGLE | SWT.LEFT | SWT.BORDER);
  props.setLook(wTargetExt);
  wTargetExt.addModifyListener(lsMod);
  fdTargetExt=new FormData();
  fdTargetExt.left=new FormAttachment(middle,0);
  fdTargetExt.top=new FormAttachment(wDateTimeAdded,margin);
  fdTargetExt.right=new FormAttachment(100,0);
  wTargetExt.setLayoutData(fdTargetExt);
  wlUploadFile=new Label(shell,SWT.RIGHT);
  wlUploadFile.setText("File to upload");
  props.setLook(wlUploadFile);
  fdlUploadFile=new FormData();
  fdlUploadFile.left=new FormAttachment(0,0);
  fdlUploadFile.top=new FormAttachment(wTargetExt,margin * 5);
  fdlUploadFile.right=new FormAttachment(middle,-margin);
  wlUploadFile.setLayoutData(fdlUploadFile);
  wUploadFile=new Text(shell,SWT.SINGLE | SWT.LEFT | SWT.BORDER);
  props.setLook(wUploadFile);
  wUploadFile.addModifyListener(lsMod);
  fdUploadFile=new FormData();
  fdUploadFile.left=new FormAttachment(middle,0);
  fdUploadFile.top=new FormAttachment(wTargetExt,margin * 5);
  fdUploadFile.right=new FormAttachment(100,0);
  wUploadFile.setLayoutData(fdUploadFile);
  wlUserName=new Label(shell,SWT.RIGHT);
  wlUserName.setText("Username");
  props.setLook(wlUserName);
  fdlUserName=new FormData();
  fdlUserName.left=new FormAttachment(0,0);
  fdlUserName.top=new FormAttachment(wUploadFile,margin * 5);
  fdlUserName.right=new FormAttachment(middle,-margin);
  wlUserName.setLayoutData(fdlUserName);
  wUserName=new Text(shell,SWT.SINGLE | SWT.LEFT | SWT.BORDER);
  props.setLook(wUserName);
  wUserName.addModifyListener(lsMod);
  fdUserName=new FormData();
  fdUserName.left=new FormAttachment(middle,0);
  fdUserName.top=new FormAttachment(wUploadFile,margin * 5);
  fdUserName.right=new FormAttachment(100,0);
  wUserName.setLayoutData(fdUserName);
  wlPassword=new Label(shell,SWT.RIGHT);
  wlPassword.setText("Password");
  props.setLook(wlPassword);
  fdlPassword=new FormData();
  fdlPassword.left=new FormAttachment(0,0);
  fdlPassword.top=new FormAttachment(wUserName,margin);
  fdlPassword.right=new FormAttachment(middle,-margin);
  wlPassword.setLayoutData(fdlPassword);
  wPassword=new Text(shell,SWT.SINGLE | SWT.LEFT | SWT.BORDER);
  props.setLook(wPassword);
  wPassword.setEchoChar('*');
  wPassword.addModifyListener(lsMod);
  fdPassword=new FormData();
  fdPassword.left=new FormAttachment(middle,0);
  fdPassword.top=new FormAttachment(wUserName,margin);
  fdPassword.right=new FormAttachment(100,0);
  wPassword.setLayoutData(fdPassword);
  wlProxyServer=new Label(shell,SWT.RIGHT);
  wlProxyServer.setText("Proxy hostname");
  props.setLook(wlProxyServer);
  fdlProxyServer=new FormData();
  fdlProxyServer.left=new FormAttachment(0,0);
  fdlProxyServer.top=new FormAttachment(wPassword,margin * 5);
  fdlProxyServer.right=new FormAttachment(middle,-margin);
  wlProxyServer.setLayoutData(fdlProxyServer);
  wProxyServer=new Text(shell,SWT.SINGLE | SWT.LEFT | SWT.BORDER);
  props.setLook(wProxyServer);
  wProxyServer.addModifyListener(lsMod);
  fdProxyServer=new FormData();
  fdProxyServer.left=new FormAttachment(middle,0);
  fdProxyServer.top=new FormAttachment(wPassword,margin * 5);
  fdProxyServer.right=new FormAttachment(100,0);
  wProxyServer.setLayoutData(fdProxyServer);
  wlProxyPort=new Label(shell,SWT.RIGHT);
  wlProxyPort.setText("Proxy port (usually 8080)");
  props.setLook(wlProxyPort);
  fdlProxyPort=new FormData();
  fdlProxyPort.left=new FormAttachment(0,0);
  fdlProxyPort.top=new FormAttachment(wProxyServer,margin);
  fdlProxyPort.right=new FormAttachment(middle,-margin);
  wlProxyPort.setLayoutData(fdlProxyPort);
  wProxyPort=new Text(shell,SWT.SINGLE | SWT.LEFT | SWT.BORDER);
  props.setLook(wProxyPort);
  wProxyPort.addModifyListener(lsMod);
  fdProxyPort=new FormData();
  fdProxyPort.left=new FormAttachment(middle,0);
  fdProxyPort.top=new FormAttachment(wProxyServer,margin);
  fdProxyPort.right=new FormAttachment(100,0);
  wProxyPort.setLayoutData(fdProxyPort);
  wlNonProxyHosts=new Label(shell,SWT.RIGHT);
  wlNonProxyHosts.setText("Ignore proxy for hosts: regexp | separated");
  props.setLook(wlNonProxyHosts);
  fdlNonProxyHosts=new FormData();
  fdlNonProxyHosts.left=new FormAttachment(0,0);
  fdlNonProxyHosts.top=new FormAttachment(wProxyPort,margin);
  fdlNonProxyHosts.right=new FormAttachment(middle,-margin);
  wlNonProxyHosts.setLayoutData(fdlNonProxyHosts);
  wNonProxyHosts=new Text(shell,SWT.SINGLE | SWT.LEFT | SWT.BORDER);
  props.setLook(wNonProxyHosts);
  wNonProxyHosts.addModifyListener(lsMod);
  fdNonProxyHosts=new FormData();
  fdNonProxyHosts.left=new FormAttachment(middle,0);
  fdNonProxyHosts.top=new FormAttachment(wProxyPort,margin);
  fdNonProxyHosts.right=new FormAttachment(100,0);
  wNonProxyHosts.setLayoutData(fdNonProxyHosts);
  wOK=new Button(shell,SWT.PUSH);
  wOK.setText(" &OK ");
  wCancel=new Button(shell,SWT.PUSH);
  wCancel.setText(" &Cancel ");
  BaseStepDialog.positionBottomButtons(shell,new Button[]{wOK,wCancel},margin,null);
  lsCancel=new Listener(){
    public void handleEvent(    Event e){
      cancel();
    }
  }
;
  lsOK=new Listener(){
    public void handleEvent(    Event e){
      ok();
    }
  }
;
  wCancel.addListener(SWT.Selection,lsCancel);
  wOK.addListener(SWT.Selection,lsOK);
  lsDef=new SelectionAdapter(){
    public void widgetDefaultSelected(    SelectionEvent e){
      ok();
    }
  }
;
  wName.addSelectionListener(lsDef);
  wURL.addSelectionListener(lsDef);
  wTargetFile.addSelectionListener(lsDef);
  shell.addShellListener(new ShellAdapter(){
    public void shellClosed(    ShellEvent e){
      cancel();
    }
  }
);
  getData();
  WindowProperty winprop=props.getScreen(shell.getText());
  if (winprop != null)   winprop.setShell(shell);
 else   shell.pack();
  shell.open();
  while (!shell.isDisposed()) {
    if (!display.readAndDispatch())     display.sleep();
  }
  return jobentry;
}
