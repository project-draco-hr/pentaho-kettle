{
  StringBuffer buffer=new StringBuffer();
  String open="[";
  String close="]";
  String rest=realXPath;
  int i=rest.indexOf(open);
  while (i > -1) {
    int j=rest.indexOf(close,i + open.length());
    if (j > -1) {
      buffer.append(rest.substring(0,i));
      rest=rest.substring(j + close.length());
    }
 else {
      buffer.append(rest);
      rest="";
    }
    i=rest.indexOf(open);
  }
  buffer.append(rest);
  return buffer.toString();
}
