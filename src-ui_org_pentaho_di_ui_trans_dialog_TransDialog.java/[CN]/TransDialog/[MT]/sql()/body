{
  DatabaseMeta ci=transMeta.findDatabase(wLogconnection.getText());
  if (ci != null) {
    String tablename=wLogtable.getText();
    String stepTablename=wStepLogtable.getText();
    if (!Const.isEmpty(tablename) || !Const.isEmpty(stepTablename)) {
      Database db=new Database(ci);
      db.shareVariablesWith(transMeta);
      try {
        db.connect();
        RowMetaInterface r;
        String createTable="";
        if (!Const.isEmpty(tablename)) {
          r=Database.getTransLogrecordFields(false,wBatch.getSelection(),wLogfield.getSelection());
          createTable+=db.getDDL(tablename,r);
        }
        if (!Const.isEmpty(stepTablename)) {
          r=Database.getStepPerformanceLogrecordFields();
          createTable+=db.getDDL(stepTablename,r);
        }
        if (!Const.isEmpty(createTable)) {
          log.logBasic(toString(),createTable);
          SQLEditor sqledit=new SQLEditor(shell,SWT.NONE,ci,transMeta.getDbCache(),createTable);
          sqledit.open();
        }
 else {
          MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_INFORMATION);
          mb.setText(BaseMessages.getString(PKG,"TransDialog.NoSqlNedds.DialogTitle"));
          mb.setMessage(BaseMessages.getString(PKG,"TransDialog.NoSqlNedds.DialogMessage"));
          mb.open();
        }
      }
 catch (      KettleException e) {
        MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
        mb.setText(BaseMessages.getString(PKG,"TransDialog.ErrorOccurred.DialogTitle"));
        mb.setMessage(BaseMessages.getString(PKG,"TransDialog.ErrorOccurred.DialogMessage") + Const.CR + e.getMessage());
        mb.open();
      }
 finally {
        db.disconnect();
      }
    }
 else {
      MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
      mb.setText(BaseMessages.getString(PKG,"TransDialog.NeedLogtableName.DialogTitle"));
      mb.setMessage(BaseMessages.getString(PKG,"TransDialog.NeedLogtableName.DialogMessage"));
      mb.open();
    }
  }
 else {
    MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
    mb.setText(BaseMessages.getString(PKG,"TransDialog.NeedValidLogtableConnection.DialogTitle"));
    mb.setMessage(BaseMessages.getString(PKG,"TransDialog.NeedValidLogtableConnection.DialogMessage"));
    mb.open();
  }
}
