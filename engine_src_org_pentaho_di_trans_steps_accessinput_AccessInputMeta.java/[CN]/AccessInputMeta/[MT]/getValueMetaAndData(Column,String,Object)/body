{
  ValueMetaAndData valueMetaData=new ValueMetaAndData();
  Object o=data;
  DataType type=c.getType();
  int sourceValueType=ValueMetaInterface.TYPE_STRING;
switch (type) {
case BINARY:
    sourceValueType=ValueMetaInterface.TYPE_BINARY;
  break;
case BOOLEAN:
sourceValueType=ValueMetaInterface.TYPE_BOOLEAN;
if (o != null) {
o=Boolean.valueOf(o.toString());
}
break;
case DOUBLE:
sourceValueType=ValueMetaInterface.TYPE_NUMBER;
break;
case FLOAT:
sourceValueType=ValueMetaInterface.TYPE_BIGNUMBER;
if (o != null) {
o=new BigDecimal(Float.toString((Float)o));
}
break;
case INT:
sourceValueType=ValueMetaInterface.TYPE_NUMBER;
if (o != null) {
o=Double.parseDouble(o.toString());
}
break;
case BYTE:
sourceValueType=ValueMetaInterface.TYPE_NUMBER;
if (o != null) {
o=Double.parseDouble(o.toString());
}
break;
case LONG:
sourceValueType=ValueMetaInterface.TYPE_INTEGER;
if (o != null) {
Integer i=(Integer)o;
o=i.longValue();
}
break;
case MEMO:
break;
case MONEY:
sourceValueType=ValueMetaInterface.TYPE_BIGNUMBER;
break;
case NUMERIC:
sourceValueType=ValueMetaInterface.TYPE_BIGNUMBER;
break;
case SHORT_DATE_TIME:
sourceValueType=ValueMetaInterface.TYPE_DATE;
break;
default :
if (o != null) {
o=o.toString();
}
break;
}
ValueMetaInterface sourceValueMeta=new ValueMeta(name == null ? c.getName() : name,sourceValueType);
sourceValueMeta.setLength(c.getLength(),c.getPrecision());
valueMetaData.setValueMeta(sourceValueMeta);
if (o != null) {
valueMetaData.setValueData(o);
}
return valueMetaData;
}
