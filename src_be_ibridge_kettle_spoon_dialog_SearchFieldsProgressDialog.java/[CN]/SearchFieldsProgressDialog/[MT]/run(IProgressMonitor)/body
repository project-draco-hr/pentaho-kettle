{
  int size=transMeta.findNrPrevSteps(stepInfo);
  try {
    if (before) {
      monitor.beginTask(Messages.getString("SearchFieldsProgressDialog.Dialog.SearchInputFields.Message"),size);
      fields=transMeta.getPrevStepFields(stepInfo,monitor);
    }
 else {
      monitor.beginTask(Messages.getString("SearchFieldsProgressDialog.Dialog.SearchOutputFields.Message"),size);
      fields=transMeta.getStepFields(stepInfo,monitor);
    }
  }
 catch (  KettleStepException kse) {
    LogWriter.getInstance().logError(toString(),Messages.getString("SearchFieldsProgressDialog.Log.UnableToGetFields",stepInfo.toString(),kse.getMessage()));
    throw new InvocationTargetException(kse,Messages.getString("SearchFieldsProgressDialog.Log.UnableToGetFields",stepInfo.toString(),kse.getMessage()));
  }
  monitor.done();
}
