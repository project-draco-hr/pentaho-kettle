{
  if (repository instanceof KettleFileRepository) {
    KettleFileRepository fileRep=(KettleFileRepository)repository;
    String transMetaFilename=fileRep.calcFilename(transMeta.getObjectId());
    transMeta.setFilename(transMetaFilename);
    for (    StepMeta stepMeta : transMeta.getSteps()) {
      if (stepMeta.isMapping()) {
        MappingMeta mappingMeta=(MappingMeta)stepMeta.getStepMetaInterface();
        if (mappingMeta.getSpecificationMethod() == ObjectLocationSpecificationMethod.FILENAME) {
          try {
            TransMeta meta=MappingMeta.loadMappingMeta(mappingMeta,fileRep,fileRep.metaStore,transMeta);
            FileObject fileObject=KettleVFS.getFileObject(meta.getFilename());
            mappingMeta.setSpecificationMethod(ObjectLocationSpecificationMethod.REPOSITORY_BY_NAME);
            mappingMeta.setFileName(null);
            mappingMeta.setTransName(meta.getName());
            mappingMeta.setDirectoryPath(Const.NVL(calcRepositoryDirectory(fileRep,fileObject),"/"));
          }
 catch (          Exception e) {
            log.logError(BaseMessages.getString(PKG,"Repository.Exporter.Log.UnableToLoadTransInMap",mappingMeta.getName()),e);
          }
        }
      }
      if (stepMeta.isEtlMetaInject()) {
        MetaInjectMeta metaInjectMeta=(MetaInjectMeta)stepMeta.getStepMetaInterface();
        if (metaInjectMeta.getSpecificationMethod() == ObjectLocationSpecificationMethod.FILENAME) {
          try {
            TransMeta meta=MetaInjectMeta.loadTransformationMeta(metaInjectMeta,fileRep,fileRep.metaStore,transMeta);
            FileObject fileObject=KettleVFS.getFileObject(meta.getFilename());
            metaInjectMeta.setSpecificationMethod(ObjectLocationSpecificationMethod.REPOSITORY_BY_NAME);
            metaInjectMeta.setFileName(null);
            metaInjectMeta.setTransName(meta.getName());
            metaInjectMeta.setDirectoryPath(Const.NVL(calcRepositoryDirectory(fileRep,fileObject),"/"));
          }
 catch (          Exception e) {
            log.logError(BaseMessages.getString(PKG,"Repository.Exporter.Log.UnableToLoadTransInMDI",metaInjectMeta.getName()),e);
          }
        }
      }
    }
  }
}
