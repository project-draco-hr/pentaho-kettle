{
  KettleEnvironment.init();
  TransMeta transMeta=new TransMeta();
  transMeta.setName("row generatortest");
  PluginRegistry registry=PluginRegistry.getInstance();
  String rowGeneratorStepname="row generator step";
  RowGeneratorMeta rm=new RowGeneratorMeta();
  String rowGeneratorPid=registry.getPluginId(StepPluginType.class,rm);
  StepMeta rowGeneratorStep=new StepMeta(rowGeneratorPid,rowGeneratorStepname,rm);
  transMeta.addStep(rowGeneratorStep);
  String[] fieldName={"string","boolean","integer","timestamp"};
  String[] type={"String","Boolean","Integer","Timestamp"};
  String[] value={"string_value","true","20","1970-01-01 00:00:00.000"};
  String[] field={"","","",""};
  String[] group={"","","",""};
  String[] decimal={"","","",""};
  String[] currency={"","","",""};
  int[] intDummies={-1,-1,-1,-1};
  boolean[] setEmptystring={false,false,false,false};
  rm.setDefault();
  rm.setFieldName(fieldName);
  rm.setFieldType(type);
  rm.setValue(value);
  rm.setFieldLength(intDummies);
  rm.setFieldPrecision(intDummies);
  rm.setRowLimit("3");
  rm.setFieldFormat(fieldFormat);
  rm.setGroup(group);
  rm.setDecimal(decimal);
  rm.setCurrency(currency);
  rm.setEmptyString(setEmptystring);
  String dummyStepname="dummy step";
  DummyTransMeta dm=new DummyTransMeta();
  String dummyPid=registry.getPluginId(StepPluginType.class,dm);
  StepMeta dummyStep=new StepMeta(dummyPid,dummyStepname,dm);
  transMeta.addStep(dummyStep);
  TransHopMeta hi=new TransHopMeta(rowGeneratorStep,dummyStep);
  transMeta.addTransHop(hi);
  Trans trans=new Trans(transMeta);
  trans.prepareExecution(null);
  StepInterface si=trans.getStepInterface(dummyStepname,0);
  RowStepCollector rc=new RowStepCollector();
  si.addRowListener(rc);
  trans.startThreads();
  trans.waitUntilFinished();
  List<RowMetaAndData> checkList=createData();
  List<RowMetaAndData> resultRows=rc.getRowsWritten();
  checkRows(resultRows,checkList);
}
