{
  if (Const.isEmpty(wName.getText())) {
    MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
    mb.setText(Messages.getString("System.StepJobEntryNameMissing.Title"));
    mb.setMessage(Messages.getString("System.JobEntryNameMissing.Msg"));
    mb.open();
    return;
  }
  jobEntry.setJobName(wJobname.getText());
  jobEntry.setFileName(wFilename.getText());
  jobEntry.setName(wName.getText());
  if (rep != null) {
    jobEntry.setDirectory(wDirectory.getText());
  }
  int nritems=wFields.nrNonEmpty();
  int nr=0;
  for (int i=0; i < nritems; i++) {
    String arg=wFields.getNonEmpty(i).getText(1);
    if (arg != null && arg.length() != 0)     nr++;
  }
  jobEntry.arguments=new String[nr];
  nr=0;
  for (int i=0; i < nritems; i++) {
    String arg=wFields.getNonEmpty(i).getText(1);
    if (arg != null && arg.length() != 0) {
      jobEntry.arguments[nr]=arg;
      nr++;
    }
  }
  nritems=wParameters.nrNonEmpty();
  nr=0;
  for (int i=0; i < nritems; i++) {
    String param=wParameters.getNonEmpty(i).getText(1);
    if (param != null && param.length() != 0)     nr++;
  }
  jobEntry.parameters=new String[nr];
  jobEntry.parameterFieldNames=new String[nr];
  jobEntry.parameterValues=new String[nr];
  nr=0;
  for (int i=0; i < nritems; i++) {
    String param=wParameters.getNonEmpty(i).getText(1);
    String fieldName=wParameters.getNonEmpty(i).getText(2);
    String value=wParameters.getNonEmpty(i).getText(3);
    jobEntry.parameters[nr]=param;
    if (!Const.isEmpty(Const.trim(fieldName))) {
      jobEntry.parameterFieldNames[nr]=fieldName;
    }
 else {
      jobEntry.parameterFieldNames[nr]="";
    }
    if (!Const.isEmpty(Const.trim(value))) {
      jobEntry.parameterValues[nr]=value;
    }
 else {
      jobEntry.parameterValues[nr]="";
    }
    nr++;
  }
  jobEntry.setLogfile=wSetLogfile.getSelection();
  jobEntry.addDate=wAddDate.getSelection();
  jobEntry.addTime=wAddTime.getSelection();
  jobEntry.logfile=wLogfile.getText();
  jobEntry.logext=wLogext.getText();
  jobEntry.loglevel=wLoglevel.getSelectionIndex();
  jobEntry.argFromPrevious=wPrevious.getSelection();
  jobEntry.paramsFromPrevious=wPrevToParams.getSelection();
  jobEntry.execPerRow=wEveryRow.getSelection();
  jobEntry.setRemoteSlaveServerName(wSlaveServer.getText());
  jobEntry.setAppendLogfile=wAppendLogfile.getSelection();
  jobEntry.setWaitingToFinish(wWaitingToFinish.getSelection());
  jobEntry.setFollowingAbortRemotely(wFollowingAbortRemotely.getSelection());
  dispose();
}
