{
  meta=(SocketWriterMeta)smi;
  data=(SocketWriterData)sdi;
  Row r=getRow();
  if (r == null) {
    setOutputDone();
    return false;
  }
  try {
    if (first) {
      data.clientSocket=data.serverSocket.accept();
      data.outputStream=new DataOutputStream(new GZIPOutputStream(new BufferedOutputStream(data.clientSocket.getOutputStream(),10000)));
      data.inputStream=new DataInputStream(new GZIPInputStream(new BufferedInputStream(data.clientSocket.getInputStream(),10000)));
      r.write(data.outputStream);
      first=false;
    }
    r.writeData(data.outputStream);
    linesOutput++;
    if ((linesOutput & 0xFF) == 0)     data.outputStream.flush();
  }
 catch (  Exception e) {
    logError("Error writing to socket : " + e.toString());
    logError("Failing row : " + r);
    logError("Stack trace: " + Const.CR + Const.getStackTracker(e));
    setErrors(1);
    stopAll();
    setOutputDone();
    return false;
  }
  if (checkFeedback(linesRead))   logBasic(Messages.getString("SocketWriter.Log.LineNumber") + linesRead);
  return true;
}
