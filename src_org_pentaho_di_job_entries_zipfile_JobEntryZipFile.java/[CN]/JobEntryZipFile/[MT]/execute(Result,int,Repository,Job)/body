{
  LogWriter log=LogWriter.getInstance();
  Result result=previousResult;
  List<RowMetaAndData> rows=result.getRows();
  String realZipfilename=null;
  String realWildcard=null;
  String realWildcardExclude=null;
  String realTargetdirectory=null;
  String realMovetodirectory=environmentSubstitute(movetodirectory);
  if (isfromprevious) {
    if (log.isDetailed())     log.logDetailed(toString(),Messages.getString("JobZipFiles.ArgFromPrevious.Found",(rows != null ? rows.size() : 0) + ""));
  }
  if (isfromprevious && rows != null) {
    try {
      for (int iteration=0; iteration < rows.size(); iteration++) {
        RowMetaAndData resultRow=rows.get(iteration);
        realTargetdirectory=resultRow.getString(0,null);
        if (!Const.isEmpty(realTargetdirectory)) {
          if (!Const.isEmpty(resultRow.getString(1,null)))           realWildcard=resultRow.getString(1,null);
          if (!Const.isEmpty(resultRow.getString(2,null)))           realWildcardExclude=resultRow.getString(2,null);
          realZipfilename=resultRow.getString(3,null);
          if (!Const.isEmpty(realZipfilename)) {
            if (!processRowFile(parentJob,result,realZipfilename,realWildcard,realWildcardExclude,realTargetdirectory,realMovetodirectory,createparentfolder)) {
              result.setResult(false);
              return result;
            }
          }
 else {
            log.logError(toString(),"destination zip filename is empty! Ignoring row...");
          }
        }
 else {
          log.logError(toString(),"Target directory is empty! Ignoring row...");
        }
      }
    }
 catch (    Exception e) {
      log.logError(toString(),"Erreur during process!");
    }
  }
 else   if (!isfromprevious) {
    if (!Const.isEmpty(sourcedirectory)) {
      realZipfilename=getFullFilename(environmentSubstitute(zipFilename),adddate,addtime);
      realWildcard=environmentSubstitute(wildcard);
      realWildcardExclude=environmentSubstitute(wildcardexclude);
      realTargetdirectory=environmentSubstitute(sourcedirectory);
      result.setResult(processRowFile(parentJob,result,realZipfilename,realWildcard,realWildcardExclude,realTargetdirectory,realMovetodirectory,createparentfolder));
    }
 else {
      log.logError(toString(),"Source folder/file is empty! Ignoring row...");
    }
  }
  return result;
}
