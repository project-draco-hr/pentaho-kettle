{
  String retval="";
  if (filename != null)   retval=environmentSubstitute(filename);
  SimpleDateFormat daf=new SimpleDateFormat();
  Date now=new Date();
  if (add_date) {
    daf.applyPattern("yyyyMMdd");
    String d=daf.format(now);
    retval+="_" + d;
  }
  if (add_time) {
    daf.applyPattern("HHmmssSSS");
    String t=daf.format(now);
    retval+="_" + t;
  }
  retval+=".zip";
  return retval;
}
