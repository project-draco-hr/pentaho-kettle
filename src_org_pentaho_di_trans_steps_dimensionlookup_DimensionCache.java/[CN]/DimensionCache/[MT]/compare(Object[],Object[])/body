{
  try {
    int cmp=rowMeta.compare(o1,o2,keyIndexes);
    if (cmp != 0)     return cmp;
    ValueMetaInterface fromDateMeta=rowMeta.getValueMeta(fromDateIndex);
    ValueMetaInterface toDateMeta=rowMeta.getValueMeta(toDateIndex);
    Date fromDate=fromDateMeta.getDate(o1[fromDateIndex]);
    Date toDate=toDateMeta.getDate(o1[toDateIndex]);
    Date lookupDate=fromDateMeta.getDate(o2[fromDateIndex]);
    if (toDate != null) {
      int cmpTo=lookupDate.compareTo(toDate);
      if (fromDate == null && cmpTo < 0)       return 0;
      int cmpFrom=lookupDate.compareTo(fromDate);
      if (fromDate != null && cmpFrom >= 0 && cmpTo < 0)       return 0;
    }
    return fromDateMeta.compare(o1[fromDateIndex],o2[fromDateIndex]);
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
