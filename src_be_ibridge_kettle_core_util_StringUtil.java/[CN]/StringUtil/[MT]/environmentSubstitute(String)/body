{
  if (aString == null || aString.length() == 0)   return aString;
  KettleVariables vars=KettleVariables.getInstance();
  Properties systemProperties=new Properties();
  systemProperties.putAll(System.getProperties());
  systemProperties.putAll(vars.getProperties());
  return environmentSubstitute(aString,systemProperties);
}
