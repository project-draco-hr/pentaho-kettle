{
  RepositoriesMeta reps_info=null;
  RepositoryMeta rep_info=null;
  Repository repos=null;
  try {
    reps_info=new RepositoriesMeta();
    reps_info.readData();
    rep_info=reps_info.findRepository(jobMeta.environmentSubstitute(wRepositoryname.getText()));
    if (rep_info == null) {
      displayMsg(BaseMessages.getString(PKG,"JobExportRepository.Error.CanNotFindRep"),BaseMessages.getString(PKG,"JobExportRepository.Error.CanNotFindRepMsg",wRepositoryname.getText()),true);
    }
    repos=RepositoryLoader.createRepository(rep_info);
    try {
      repos.connect(jobMeta.environmentSubstitute(wUserName.getText()),jobMeta.environmentSubstitute(wPassword.getText()));
    }
 catch (    Exception e) {
      displayMsg(BaseMessages.getString(PKG,"JobExportRepository.Error.CanNotConnect"),BaseMessages.getString(PKG,"JobExportRepository.Error.CanNotConnectMsg",wRepositoryname.getText()),true);
    }
    SelectDirectoryDialog sdd=new SelectDirectoryDialog(shell,SWT.NONE,repos);
    RepositoryDirectory rd=sdd.open();
    if (rd != null) {
      wFoldername.setText(rd.getPath());
    }
  }
 catch (  Exception e) {
    displayMsg(BaseMessages.getString(PKG,"System.Dialog.Error.Title"),BaseMessages.getString(PKG,"JobExportRepository.ErrorGettingFolderds.DialogMessage") + Const.CR + ":"+ e.getMessage(),true);
  }
 finally {
    if (repos != null) {
      repos.disconnect();
      repos=null;
    }
    if (rep_info != null)     rep_info=null;
    reps_info.clear();
  }
}
