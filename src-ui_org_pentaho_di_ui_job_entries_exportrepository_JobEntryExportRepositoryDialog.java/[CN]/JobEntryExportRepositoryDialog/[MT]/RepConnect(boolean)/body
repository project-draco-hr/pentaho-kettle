{
  boolean retval=false;
  LogWriter log=LogWriter.getInstance();
  RepositoriesMeta reps_info=null;
  RepositoryMeta rep_info=null;
  UserInfo user_info=null;
  Repository repos=null;
  try {
    reps_info=new RepositoriesMeta(log);
    if (!reps_info.readData()) {
      displayMsg(Messages.getString("JobExportRepository.Error.NoRepsDefined"),Messages.getString("JobExportRepository.Error.NoRepsDefinedMsg"),true);
    }
    rep_info=reps_info.findRepository(jobMeta.environmentSubstitute(wRepositoryname.getText()));
    if (rep_info == null) {
      displayMsg(Messages.getString("JobExportRepository.Error.CanNotFindRep"),Messages.getString("JobExportRepository.Error.CanNotFindRepMsg",wRepositoryname.getText()),true);
      return false;
    }
    repos=new Repository(log,rep_info,user_info);
    if (!repos.connect("Export job entry")) {
      displayMsg(Messages.getString("JobExportRepository.Error.CanNotConnect"),Messages.getString("JobExportRepository.Error.CanNotConnectMsg",wRepositoryname.getText()),true);
      return false;
    }
    user_info=new UserInfo(repos,jobMeta.environmentSubstitute(wUserName.getText()),jobMeta.environmentSubstitute(wPassword.getText()));
    if (user_info.getID() > 0) {
      repos.disconnect();
      repos=null;
      if (displaySuccess)       displayMsg(Messages.getString("JobExportRepository.Connected.Title.Ok"),Messages.getString("JobExportRepository.Connected.OK",wRepositoryname.getText()),false);
    }
 else {
      displayMsg(Messages.getString("JobExportRepository.Connected.Title.Bad"),Messages.getString("JobExportRepository.CanNotVerifyUser",wUserName.getText(),wRepositoryname.getText()),true);
      return false;
    }
    retval=true;
  }
 catch (  Exception e) {
    displayMsg(Messages.getString("System.Dialog.Error.Title"),Messages.getString("JobExportRepository.ErrorConnecting",wRepositoryname.getText()),true);
  }
 finally {
    if (repos != null) {
      repos.disconnect();
      repos=null;
    }
    if (rep_info != null)     rep_info=null;
    if (user_info != null)     user_info=null;
    reps_info.clear();
  }
  return retval;
}
