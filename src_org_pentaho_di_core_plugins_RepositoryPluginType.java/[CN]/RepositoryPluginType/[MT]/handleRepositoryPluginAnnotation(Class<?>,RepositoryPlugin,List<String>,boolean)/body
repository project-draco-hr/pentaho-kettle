{
  String[] ids=new String[]{repositoryPlugin.id()};
  if (ids.length == 1 && Const.isEmpty(ids[0])) {
    throw new KettlePluginException("No ID specified for plugin with class: " + clazz.getName());
  }
  String packageName=repositoryPlugin.i18nPackageName();
  if (Const.isEmpty(packageName))   packageName=Repository.class.getPackage().getName();
  String altPackageName=clazz.getPackage().getName();
  String name=getTranslation(repositoryPlugin.name(),packageName,altPackageName,clazz);
  String description=getTranslation(repositoryPlugin.description(),packageName,altPackageName,clazz);
  String category=null;
  Map<PluginClassType,String> classMap=new HashMap<PluginClassType,String>();
  classMap.put(PluginClassType.MainClassType,clazz.getName());
  classMap.put(PluginClassType.MetaClassType,repositoryPlugin.metaClass());
  classMap.put(PluginClassType.DialogClassType,repositoryPlugin.dialogClass());
  classMap.put(PluginClassType.RepositoryVersionBrowserClassType,repositoryPlugin.versionBrowserClass());
  PluginInterface stepPlugin=new Plugin(ids,this,category,name,description,null,false,nativeRepositoryType,classMap,libraries,null);
  registry.registerPlugin(this,stepPlugin);
}
