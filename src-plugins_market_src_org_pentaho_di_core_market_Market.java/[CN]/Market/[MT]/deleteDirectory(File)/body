{
  File[] files=dir.listFiles();
  for (int i=0; i < files.length; i++) {
    if (files[i].isDirectory()) {
      deleteDirectory(files[i]);
    }
 else     if (!files[i].delete()) {
      throw new KettleException("Failed to delete " + files[i]);
    }
  }
  if (!dir.delete()) {
    throw new KettleException("Failed to delete directory " + dir);
  }
}
