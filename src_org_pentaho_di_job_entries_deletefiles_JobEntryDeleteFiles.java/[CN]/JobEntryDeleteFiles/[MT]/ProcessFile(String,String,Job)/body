{
  LogWriter log=LogWriter.getInstance();
  boolean rcode=false;
  FileObject filefolder=null;
  String realFilefoldername=environmentSubstitute(filename);
  String realwildcard=environmentSubstitute(wildcard);
  try {
    filefolder=KettleVFS.getFileObject(realFilefoldername,this);
    System.gc();
    if (filefolder.exists()) {
      if (filefolder.getType() == FileType.FOLDER) {
        if (log.isDetailed())         logDetailed(BaseMessages.getString(PKG,"JobEntryDeleteFiles.ProcessingFolder",realFilefoldername));
        int Nr=filefolder.delete(new TextFileSelector(filefolder.toString(),realwildcard,parentJob));
        if (log.isDetailed())         logDetailed(BaseMessages.getString(PKG,"JobEntryDeleteFiles.TotalDeleted",String.valueOf(Nr)));
        rcode=true;
      }
 else {
        if (log.isDetailed())         logDetailed(BaseMessages.getString(PKG,"JobEntryDeleteFiles.ProcessingFile",realFilefoldername));
        boolean deleted=filefolder.delete();
        if (!deleted) {
          logError(BaseMessages.getString(PKG,"JobEntryDeleteFiles.CouldNotDeleteFile",realFilefoldername));
        }
 else {
          if (log.isBasic())           logBasic(BaseMessages.getString(PKG,"JobEntryDeleteFiles.FileDeleted",filename));
          rcode=true;
        }
      }
    }
 else {
      if (log.isBasic())       logBasic(BaseMessages.getString(PKG,"JobEntryDeleteFiles.FileAlreadyDeleted",realFilefoldername));
      rcode=true;
    }
  }
 catch (  Exception e) {
    logError(BaseMessages.getString(PKG,"JobEntryDeleteFiles.CouldNotProcess",realFilefoldername,e.getMessage()),e);
  }
 finally {
    if (filefolder != null) {
      try {
        filefolder.close();
      }
 catch (      IOException ex) {
      }
      ;
    }
  }
  return rcode;
}
