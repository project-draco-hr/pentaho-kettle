{
  DatabaseInterface databaseInterface=databaseMeta.getDatabaseInterface();
  boolean supportsAutoGeneratedKeys=!(databaseInterface instanceof DatabaseInterfaceExtended) || ((DatabaseInterfaceExtended)databaseInterface).supportsAutoGeneratedKeys();
  try {
    if (returnKeys && supportsAutoGeneratedKeys) {
      return connection.prepareStatement(databaseMeta.stripCR(sql),Statement.RETURN_GENERATED_KEYS);
    }
 else {
      return connection.prepareStatement(databaseMeta.stripCR(sql));
    }
  }
 catch (  SQLException ex) {
    throw new KettleDatabaseException("Couldn't prepare statement:" + Const.CR + sql,ex);
  }
}
