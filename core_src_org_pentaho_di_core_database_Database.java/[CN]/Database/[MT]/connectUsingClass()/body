{
  try {
    if (log.isDetailed()) {
      log.logDetailed("Attempting to find connection in Named Datasources");
    }
    connectUsingNamedDataSource(environmentSubstitute(databaseMeta.getDatabaseName()));
  }
 catch (  KettleDatabaseException kde) {
    if (log.isDetailed()) {
      log.logDetailed("Unable to find datasource in Named Datasources." + " Finally will try to attempt connecting using class ");
    }
    connectUsingClass(databaseMeta.getDriverClass(),partitionId);
  }
  if (log.isDetailed()) {
    log.logDetailed("Connected to database.");
  }
}
