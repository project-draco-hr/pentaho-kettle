{
  Row row;
  if (r == null)   row=new Row();
 else   row=r;
  for (int i=0; i < formula.length; i++) {
    FormulaMetaFunction fn=formula[i];
    if (!fn.isRemovedFromResult()) {
      if (fn.getFieldName() != null && fn.getFieldName().length() > 0) {
        Value v=new Value(fn.getFieldName(),fn.getValueType());
        v.setLength(fn.getValueLength(),fn.getValuePrecision());
        v.setOrigin(name);
        row.addValue(v);
      }
    }
  }
  return row;
}
