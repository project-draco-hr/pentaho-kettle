{
  String logPath=null;
  boolean doLog=!Boolean.getBoolean(Const.INTERNAL_VARIABLE_PREFIX + ".Kettle.UI.Log.Disabled");
  if (doLog) {
    try {
      if (itemOutputMap.get(item.getText()) == null) {
        String safeName=item.getText().replaceAll("[^a-zA-Z0-9\\._]+","_") + ".log";
        Path parent=Paths.get(System.getProperty("user.dir") + File.separator + "logs");
        Files.createDirectories(parent);
        Path path=Files.createFile(Paths.get(parent.toString(),safeName));
        final File log=path.toFile();
        itemLogFilesMap.put(item.getText(),log);
        log.deleteOnExit();
        final FileOutputStream fos=new FileOutputStream(log,true);
        TeeOutputStream tOut=new TeeOutputStream(originalSystemOut,fos);
        TeeOutputStream tErr=new TeeOutputStream(originalSystemErr,fos);
        itemOutputMap.put(item.getText(),fos);
        itemPrintStreamOutMap.put(item.getText(),new PrintStream(tOut));
        itemPrintStreamErrMap.put(item.getText(),new PrintStream(tErr));
      }
      logPath=itemLogFilesMap.get(item.getText()).getAbsolutePath();
      System.setOut(itemPrintStreamOutMap.get(item.getText()));
      System.setErr(itemPrintStreamErrMap.get(item.getText()));
      KettleLogStore.OriginalSystemOut=System.out;
      KettleLogStore.OriginalSystemErr=System.err;
    }
 catch (    Throwable ignored) {
    }
  }
  return logPath;
}
