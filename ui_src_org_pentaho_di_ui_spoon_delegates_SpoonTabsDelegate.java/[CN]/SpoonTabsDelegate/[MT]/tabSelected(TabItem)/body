{
  ArrayList<TabMapEntry> collection=new ArrayList<TabMapEntry>(tabMap);
  for (  TabMapEntry entry : collection) {
    boolean isTrans=(entry.getObject() instanceof TransGraph);
    if (item.equals(entry.getTabItem())) {
      if (isTrans || entry.getObject() instanceof JobGraph) {
        EngineMetaInterface meta=entry.getObject().getMeta();
        if (meta != null) {
          meta.setInternalKettleVariables();
        }
        if (spoon.getCoreObjectsState() != SpoonInterface.STATE_CORE_OBJECTS_SPOON) {
          spoon.refreshCoreObjects();
        }
      }
      if (entry.getObject() instanceof JobGraph) {
        ((JobGraph)entry.getObject()).setFocus();
      }
 else       if (entry.getObject() instanceof TransGraph) {
        ((TransGraph)entry.getObject()).setFocus();
      }
      break;
    }
  }
  spoon.refreshTree();
  spoon.setShellText();
}
