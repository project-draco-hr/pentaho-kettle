{
  final String virtualFile=createVirtualFile("pdi-14172.txt","1,1,1\n","2,,2\n");
  TextFileInputMeta meta=new TextFileInputMeta();
  BaseFileInputField field2=field("col2");
  field2.setRepeated(true);
  meta.inputFiles.inputFields=new BaseFileInputField[]{field("col1"),field2,field("col3")};
  meta.content.fileCompression="None";
  meta.content.fileType="CSV";
  meta.content.header=false;
  meta.content.nrHeaderLines=-1;
  meta.content.footer=false;
  meta.content.nrFooterLines=-1;
  TextFileInputData data=createDataObject(virtualFile,",","col1","col2","col3");
  TextFileInput input=StepMockUtil.getStep(TextFileInput.class,TextFileInputMeta.class,"test");
  List<Object[]> output=TransTestingUtil.execute(input,meta,data,2,false);
  assertResult(new Object[]{"1","1","1"},output.get(0));
  assertResult(new Object[]{"2","1","2"},output.get(1));
  deleteVfsFile(virtualFile);
}
