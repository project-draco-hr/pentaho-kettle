{
  final String content=new StringBuilder().append("r1c1").append('\n').append(";r1c2\n").append("r2c1").append('\n').append(";r2c2").toString();
  final String virtualFile=createVirtualFile("pdi-2607.txt",content);
  TextFileInputMeta meta=new TextFileInputMeta();
  meta.content.lineWrapped=true;
  meta.content.nrWraps=1;
  meta.inputFiles.inputFields=new BaseFileInputField[]{field("col1"),field("col2")};
  meta.content.fileCompression="None";
  meta.content.fileType="CSV";
  meta.content.header=false;
  meta.content.nrHeaderLines=-1;
  meta.content.footer=false;
  meta.content.nrFooterLines=-1;
  TextFileInputData data=createDataObject(virtualFile,";","col1","col2");
  RowSet output=new BlockingRowSet(5);
  executeStep(meta,data,output,2);
  Object[] row1=output.getRowImmediate();
  assertRow(row1,"r1c1","r1c2");
  Object[] row2=output.getRowImmediate();
  assertRow(row2,"r2c1","r2c2");
  deleteVfsFile(virtualFile);
}
