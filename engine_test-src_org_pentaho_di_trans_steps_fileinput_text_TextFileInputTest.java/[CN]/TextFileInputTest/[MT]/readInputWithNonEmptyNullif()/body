{
  final String virtualFile=createVirtualFile("pdi-14358.txt","-,-\n");
  TextFileInputMeta meta=new TextFileInputMeta();
  BaseFileInputField col2=field("col2");
  col2.setNullString("-");
  meta.inputFiles.inputFields=new BaseFileInputField[]{field("col1"),col2};
  meta.content.fileCompression="None";
  meta.content.fileType="CSV";
  meta.content.header=false;
  meta.content.nrHeaderLines=-1;
  meta.content.footer=false;
  meta.content.nrFooterLines=-1;
  TextFileInputData data=createDataObject(virtualFile,",","col1","col2");
  RowSet output=new BlockingRowSet(5);
  executeStep(meta,data,output,1);
  Object[] row=output.getRowImmediate();
  assertRow(row,"-",null);
  deleteVfsFile(virtualFile);
}
