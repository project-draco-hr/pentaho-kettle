{
  Database d=null;
  try {
    AccessInputMeta meta=new AccessInputMeta();
    getInfo(meta);
    if (!checkInputFilesName(meta))     return;
    FileInputList inputList=meta.getFiles();
    d=Database.open(new File(KettleVFS.getFilename(inputList.getFile(0))));
    if (!inputList.getFile(0).exists()) {
      throw new KettleException(Messages.getString("AccessInputMeta.Exception.FileDoesNotExist",KettleVFS.getFilename(inputList.getFile(0))));
    }
    Set set=d.getTableNames();
    String[] tablenames=(String[])set.toArray(new String[set.size()]);
    EnterSelectionDialog dialog=new EnterSelectionDialog(shell,tablenames,Messages.getString("AccessInputDialog.Dialog.SelectATable.Title"),Messages.getString("AccessInputDialog.Dialog.SelectATable.Message"));
    String tablename=dialog.open();
    if (tablename != null) {
      wTable.setText(tablename);
    }
  }
 catch (  Throwable e) {
    new ErrorDialog(shell,Messages.getString("AccessInputDialog.UnableToGetListOfTables.Title"),Messages.getString("AccessInputDialog.UnableToGetListOfTables.Message"),new Exception(e));
  }
 finally {
    try {
      if (d != null)       d.close();
    }
 catch (    Exception e) {
    }
  }
}
