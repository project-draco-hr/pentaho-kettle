{
  if (first) {
    Object[] parameters;
    RowMetaInterface parametersMeta;
    first=false;
    if (meta.getInfoSteps() != null) {
      if (meta.isExecuteEachInputRow()) {
        if (log.isDetailed())         logDetailed("Reading single row from stream [" + meta.getLookupStepname() + "]");
        data.rowSet=findInputRowSet(meta.getLookupStepname());
        parameters=getRowFrom(data.rowSet);
        parametersMeta=data.rowSet.getRowMeta();
      }
 else {
        if (log.isDetailed())         logDetailed("Reading query parameters from stream [" + meta.getLookupStepname() + "]");
        RowMetaAndData rmad=readStartDate();
        parameters=rmad.getData();
        parametersMeta=rmad.getRowMeta();
      }
      if (parameters != null) {
        if (log.isDetailed())         logDetailed("Query parameters found = " + parameters.toString());
      }
    }
 else {
      parameters=new Object[]{};
      parametersMeta=new RowMeta();
    }
    if (meta.isExecuteEachInputRow() && (parameters == null || parametersMeta.size() == 0)) {
      setOutputDone();
      return false;
    }
    boolean success=doQuery(parametersMeta,parameters);
    if (!success) {
      return false;
    }
  }
 else {
    if (data.thisrow != null) {
      data.nextrow=data.db.getRow(data.rs);
      if (data.nextrow != null)       linesInput++;
    }
  }
  if (data.thisrow == null) {
    boolean done=false;
    if (meta.isExecuteEachInputRow()) {
      Object[] nextRow=getRowFrom(data.rowSet);
      if (nextRow == null) {
        done=true;
      }
 else {
        closePreviousQuery();
        boolean success=doQuery(data.rowSet.getRowMeta(),nextRow);
        if (!success) {
          return false;
        }
      }
    }
 else {
      done=true;
    }
    if (done) {
      setOutputDone();
      return false;
    }
  }
 else {
    putRow(data.rowMeta,data.thisrow);
    data.thisrow=data.nextrow;
    if (checkFeedback(linesInput))     logBasic("linenr " + linesInput);
  }
  return true;
}
