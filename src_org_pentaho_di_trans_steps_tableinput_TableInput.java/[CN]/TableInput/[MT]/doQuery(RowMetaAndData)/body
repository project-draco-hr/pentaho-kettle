{
  boolean success=true;
  String sql=null;
  if (meta.isVariableReplacementActive())   sql=environmentSubstitute(meta.getSQL());
 else   sql=meta.getSQL();
  data.rs=data.db.openQuery(sql,parameters.getRowMeta(),parameters.getData());
  if (data.rs == null) {
    logError("Couldn't open Query [" + sql + "]");
    setErrors(1);
    stopAll();
    success=false;
  }
 else {
    data.rowMeta=data.db.getReturnRowMeta();
    data.thisrow=data.db.getRow(data.rs);
    if (data.thisrow != null) {
      linesInput++;
      data.nextrow=data.db.getRow(data.rs);
      if (data.nextrow != null)       linesInput++;
    }
  }
  return success;
}
