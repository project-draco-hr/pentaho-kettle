{
  SoapBindingStub binding;
  LoginResult loginResult=null;
  try {
    String realURL=transMeta.environmentSubstitute(wURL.getText());
    String realUsername=transMeta.environmentSubstitute(wUserName.getText());
    String realPassword=transMeta.environmentSubstitute(wPassword.getText());
    int realTimeOut=Const.toInt(transMeta.environmentSubstitute(wTimeOut.getText()),0);
    binding=(SoapBindingStub)new SforceServiceLocator().getSoap();
    if (realTimeOut > 0)     binding.setTimeout(realTimeOut);
    if (!Const.isEmpty(realURL))     binding._setProperty(SoapBindingStub.ENDPOINT_ADDRESS_PROPERTY,realURL);
    loginResult=binding.login(realUsername,realPassword);
    binding._setProperty(SoapBindingStub.ENDPOINT_ADDRESS_PROPERTY,loginResult.getServerUrl());
    SessionHeader sh=new SessionHeader();
    sh.setSessionId(loginResult.getSessionId());
    binding.setHeader(new SforceServiceLocator().getServiceName().getNamespaceURI(),"SessionHeader",sh);
  }
 catch (  Exception e) {
    throw new KettleException(e);
  }
  return binding;
}
