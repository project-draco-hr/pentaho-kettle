{
  SalesforceConnection connection=null;
  try {
    SalesforceInputMeta meta=new SalesforceInputMeta();
    getInfo(meta);
    wFields.removeAll();
    String realModule=transMeta.environmentSubstitute(meta.getModule());
    String realURL=transMeta.environmentSubstitute(meta.getTargetURL());
    String realUsername=transMeta.environmentSubstitute(meta.getUserName());
    String realPassword=transMeta.environmentSubstitute(meta.getPassword());
    int realTimeOut=Const.toInt(transMeta.environmentSubstitute(meta.getTimeOut()),0);
    connection=new SalesforceConnection(log,realURL,realUsername,realPassword);
    connection.setTimeOut(realTimeOut);
    if (meta.isSpecifyQuery()) {
      String realQuery=transMeta.environmentSubstitute(meta.getQuery());
      connection.setSQL(realQuery);
      connection.connect();
      MessageElement[] fields=connection.getElements();
      int nrFields=fields.length;
      for (int i=0; i < nrFields; i++) {
        String fieldname=fields[i].getName();
        String firstValue=fields[i].getValue();
        TableItem item=new TableItem(wFields.table,SWT.NONE);
        item.setText(1,fieldname);
        item.setText(2,fieldname);
        if (StringUtil.IsDate(firstValue,"yyyy-MM-dd")) {
          item.setText(3,ValueMeta.getTypeDesc(ValueMeta.TYPE_DATE));
          item.setText(4,"yyyy-MM-dd");
        }
 else         if (StringUtil.IsInteger(firstValue)) {
          item.setText(3,ValueMeta.getTypeDesc(ValueMeta.TYPE_INTEGER));
          item.setText(5,"" + ValueMeta.DEFAULT_INTEGER_LENGTH);
        }
 else         if (StringUtil.IsNumber(firstValue)) {
          item.setText(3,ValueMeta.getTypeDesc(ValueMeta.TYPE_NUMBER));
        }
 else         if (firstValue.equals("true") || firstValue.equals("false")) {
          item.setText(3,ValueMeta.getTypeDesc(ValueMeta.TYPE_BOOLEAN));
        }
 else         item.setText(3,ValueMeta.getTypeDesc(ValueMeta.TYPE_STRING));
      }
    }
 else {
      connection.connect();
      Field[] fields=connection.getModuleFields(realModule);
      for (int i=0; i < fields.length; i++) {
        String FieldLabel=fields[i].getLabel();
        String FieldName=fields[i].getName();
        String FieldType=fields[i].getType().getValue();
        String FieldLengh=fields[i].getLength() + "";
        TableItem item=new TableItem(wFields.table,SWT.NONE);
        item.setText(1,FieldLabel);
        item.setText(2,FieldName);
        if (FieldType.equals("boolean")) {
          item.setText(3,"Boolean");
        }
 else         if (FieldType.equals("datetime") || FieldType.equals("date")) {
          item.setText(3,"Date");
          item.setText(4,DEFAULT_DATE_FORMAT);
        }
 else         if (FieldType.equals("double")) {
          item.setText(3,"Number");
        }
 else         if (FieldType.equals("int")) {
          item.setText(3,"Integer");
        }
 else {
          item.setText(3,"String");
        }
        if (!FieldType.equals("boolean") && !FieldType.equals("datetime") && !FieldType.equals("date")) {
          item.setText(5,FieldLengh);
        }
      }
    }
    wFields.removeEmptyRows();
    wFields.setRowNums();
    wFields.optWidth(true);
  }
 catch (  KettleException e) {
    new ErrorDialog(shell,BaseMessages.getString(PKG,"SalesforceInputMeta.ErrorRetrieveData.DialogTitle"),BaseMessages.getString(PKG,"SalesforceInputMeta.ErrorRetrieveData.DialogMessage"),e);
  }
catch (  Exception e) {
    new ErrorDialog(shell,BaseMessages.getString(PKG,"SalesforceInputMeta.ErrorRetrieveData.DialogTitle"),BaseMessages.getString(PKG,"SalesforceInputMeta.ErrorRetrieveData.DialogMessage"),e);
  }
 finally {
    if (connection != null) {
      try {
        connection.close();
      }
 catch (      Exception e) {
      }
      ;
    }
  }
}
