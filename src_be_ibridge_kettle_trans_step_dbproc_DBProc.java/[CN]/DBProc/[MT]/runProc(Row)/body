{
  int i;
  Row add;
  if (first) {
    first=false;
    data.argnrs=new int[meta.getArgument().length];
    data.addnrs=new ArrayList();
    for (i=0; i < meta.getArgument().length; i++) {
      if (!meta.getArgumentDirection()[i].equalsIgnoreCase("OUT")) {
        data.argnrs[i]=row.searchValueIndex(meta.getArgument()[i]);
        if (data.argnrs[i] < 0) {
          logError(Messages.getString("DBProc.Log.ErrorFindingField") + meta.getArgument()[i] + "]");
          throw new KettleStepException(Messages.getString("DBProc.Exception.CouldnotFindField",meta.getArgument()[i]));
        }
      }
 else {
        data.argnrs[i]=-1;
      }
      if (meta.getArgumentDirection()[i].equalsIgnoreCase("OUT") || meta.getArgumentDirection()[i].equalsIgnoreCase("INOUT")) {
        data.addnrs.add(new Integer(data.argnrs[i]));
      }
    }
    data.db.setProcLookup(meta.getProcedure(),meta.getArgument(),meta.getArgumentDirection(),meta.getArgumentType(),meta.getResultName(),meta.getResultType());
  }
  data.db.setProcValues(row,data.argnrs,meta.getArgumentDirection(),!Const.isEmpty(meta.getResultName()));
  add=data.db.callProcedure(meta.getArgument(),meta.getArgumentDirection(),meta.getArgumentType(),meta.getResultName(),meta.getResultType());
  for (i=0; i < add.size(); i++) {
    int idx=((Integer)data.addnrs.get(i)).intValue();
    if (idx < 0) {
      row.addValue(add.getValue(i));
    }
 else {
      row.setValue(idx,add.getValue(i));
    }
  }
}
