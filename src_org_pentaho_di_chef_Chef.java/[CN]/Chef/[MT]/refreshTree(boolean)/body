{
  log.logDetailed(toString(),"refreshTree() called");
  TreeItem tiJobEntries=null;
  TreeItem tiConnections=null;
  TreeItem ti[]=tMain.getItems();
  for (int i=0; i < ti.length; i++) {
    if (ti[i].getText().equalsIgnoreCase(STRING_JOBENTRIES))     tiJobEntries=ti[i];
    if (ti[i].getText().equalsIgnoreCase(STRING_CONNECTIONS))     tiConnections=ti[i];
  }
  if (tiConnections != null) {
    TreeItem entries[]=tiConnections.getItems();
    for (int i=0; i < entries.length; i++)     entries[i].dispose();
  }
  if (tiJobEntries != null) {
    TreeItem entries[]=tiJobEntries.getItems();
    for (int i=0; i < entries.length; i++)     entries[i].dispose();
  }
  for (int i=0; i < jobMeta.nrDatabases(); i++) {
    DatabaseMeta dbinfo=jobMeta.getDatabase(i);
    TreeItem item=new TreeItem(tiConnections,SWT.NONE);
    item.setText(dbinfo.getName());
    item.setImage(GUIResource.getInstance().getImageConnection());
  }
  for (int i=0; i < jobMeta.nrJobEntries(); i++) {
    JobEntryCopy je=jobMeta.getJobEntry(i);
    TreeItem item=new TreeItem(tiJobEntries,SWT.NONE);
    if (je.isStart()) {
      item.setImage(GUIResource.getInstance().getImageStart());
    }
 else     if (je.isDummy()) {
      item.setImage(GUIResource.getInstance().getImageDummy());
    }
 else {
      Image image=(Image)GUIResource.getInstance().getImagesJobentriesSmall().get(je.getTypeDesc());
      item.setImage(image);
    }
    if (je.getName() != null)     item.setText(je.getName());
  }
  TreeMemory.setExpandedFromMemory(tMain,STRING_CHEF_MAIN_TREE_NAME);
  tMain.setFocus();
  setShellText();
}
