{
  ResultSet keys=null;
  try {
    keys=ps.getGeneratedKeys();
    ResultSetMetaData resultSetMetaData=keys.getMetaData();
    RowMetaInterface rowMeta=getRowInfo(resultSetMetaData);
    return new RowMetaAndData(rowMeta,getRow(keys,resultSetMetaData,rowMeta));
  }
 catch (  Exception ex) {
    throw new KettleDatabaseException("Unable to retrieve key(s) from auto-increment field(s)",ex);
  }
 finally {
    if (keys != null) {
      try {
        keys.close();
      }
 catch (      SQLException e) {
        throw new KettleDatabaseException("Unable to close resultset of auto-generated keys",e);
      }
    }
  }
}
