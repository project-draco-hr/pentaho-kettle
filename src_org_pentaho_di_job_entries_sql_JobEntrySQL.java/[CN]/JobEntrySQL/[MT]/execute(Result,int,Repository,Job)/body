{
  LogWriter log=LogWriter.getInstance();
  Result result=previousResult;
  if (connection != null) {
    Database db=new Database(connection);
    db.shareVariablesWith(this);
    try {
      db.connect();
      String mySQL=null;
      if (useVariableSubstitution)       mySQL=environmentSubstitute(sql);
 else       mySQL=sql;
      db.execStatements(mySQL);
    }
 catch (    KettleDatabaseException je) {
      result.setNrErrors(1);
      log.logError(toString(),"An error occurred executing this job entry : " + je.getMessage());
    }
 finally {
      db.disconnect();
    }
  }
 else {
    result.setNrErrors(1);
    log.logError(toString(),"No database connection is defined.");
  }
  if (result.getNrErrors() == 0) {
    result.setResult(true);
  }
 else {
    result.setResult(false);
  }
  return result;
}
