{
  int nrkeys=wKey.nrNonEmpty();
  int nrfields=wUpIns.nrNonEmpty();
  in.allocate(nrkeys,nrfields);
  log.logDebug(toString(),Messages.getString("DimensionLookupDialog.Log.FoundKeys",String.valueOf(nrkeys)));
  for (int i=0; i < nrkeys; i++) {
    TableItem item=wKey.getNonEmpty(i);
    in.getKeyLookup()[i]=item.getText(1);
    in.getKeyStream()[i]=item.getText(2);
  }
  log.logDebug(toString(),Messages.getString("DimensionLookupDialog.Log.FoundFields",String.valueOf(nrfields)));
  for (int i=0; i < nrfields; i++) {
    TableItem item=wUpIns.getNonEmpty(i);
    in.getFieldLookup()[i]=item.getText(1);
    in.getFieldStream()[i]=item.getText(2);
    in.getFieldUpdate()[i]=DimensionLookupMeta.getUpdateType(in.isUpdate(),item.getText(3));
  }
  in.setTableName(wTable.getText());
  in.setKeyField(wTk.getText());
  in.setKeyRename(wTkRename.getText());
  in.setAutoIncrement(wAutoinc.getSelection());
  if (in.getKeyRename() != null && in.getKeyRename().equalsIgnoreCase(in.getKeyField()))   in.setKeyRename(null);
  in.setVersionField(wVersion.getText());
  in.setSequenceName(wSeq.getText());
  in.setDatabaseMeta(transMeta.findDatabase(wConnection.getText()));
  in.setDateField(wDatefield.getText());
  in.setDateFrom(wFromdate.getText());
  in.setDateTo(wTodate.getText());
  in.setUpdate(wUpdate.getSelection());
  in.setCommitSize(Const.toInt(wCommit.getText(),0));
  in.setMinYear(Const.toInt(wMinyear.getText(),Const.MIN_YEAR));
  in.setMaxYear(Const.toInt(wMaxyear.getText(),Const.MAX_YEAR));
}
