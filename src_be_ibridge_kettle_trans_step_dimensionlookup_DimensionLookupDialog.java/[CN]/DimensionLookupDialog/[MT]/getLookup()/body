{
  DatabaseMeta ci=transMeta.findDatabase(wConnection.getText());
  if (ci != null) {
    Database db=new Database(ci);
    try {
      db.connect();
      Row r=db.getTableFields(wTable.getText());
      if (r != null) {
        Table table=wUpIns.table;
        for (int i=0; i < r.size(); i++) {
          Value v=r.getValue(i);
          int idx=wKey.indexOfString(v.getName(),2);
          if (idx < 0 && !v.getName().equalsIgnoreCase(wTk.getText()) && !v.getName().equalsIgnoreCase(wVersion.getText()) && !v.getName().equalsIgnoreCase(wFromdate.getText()) && !v.getName().equalsIgnoreCase(wTodate.getText())) {
            TableItem ti=new TableItem(table,SWT.NONE);
            ti.setText(1,v.getName());
            ti.setText(2,v.getName());
            ti.setText(3,v.getTypeDesc());
          }
        }
        wUpIns.removeEmptyRows();
        wUpIns.setRowNums();
        wUpIns.optWidth(true);
      }
    }
 catch (    KettleException e) {
      MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
      mb.setText("ERROR!");
      mb.setMessage("An error occurred: " + Const.CR + e.getMessage());
      mb.open();
    }
 finally {
      db.disconnect();
    }
  }
}
