{
  if (bytes == null) {
    throw new NullPointerException();
  }
 else   if ((offset < 0) || (offset > bytes.length) || (len < 0)|| ((offset + len) > bytes.length)|| ((offset + len) < 0)) {
    throw new IndexOutOfBoundsException();
  }
 else   if (len == 0) {
    return 0;
  }
  if (readPtr >= length) {
    return -1;
  }
  if (raFile != null) {
    len=Math.min(length - readPtr,len);
    if (len >= PAGE_SIZE) {
      if (bufferDirty) {
        writePage(currentPage);
      }
      currentPage=INVALID_PAGE;
      raFile.seek(readPtr);
      raFile.readFully(bytes,offset,len);
    }
 else {
      int count=len;
      while (count > 0) {
        if (currentPage != (readPtr & PAGE_MASK)) {
          readPage(readPtr);
        }
        int inBuffer=Math.min(PAGE_SIZE - (readPtr & BYTE_MASK),count);
        System.arraycopy(buffer,readPtr & BYTE_MASK,bytes,offset,inBuffer);
        offset+=inBuffer;
        readPtr+=inBuffer;
        count-=inBuffer;
      }
    }
  }
 else {
    len=Math.min(length - readPtr,len);
    System.arraycopy(buffer,readPtr,bytes,offset,len);
  }
  return len;
}
