{
  meta=(MappingInputMeta)smi;
  data=(MappingInputData)sdi;
  if (!data.linked) {
    int totalsleep=0;
    while (!isStopped() && data.sourceSteps == null) {
      try {
        totalsleep+=10;
        Thread.sleep(10);
      }
 catch (      InterruptedException e) {
        stopAll();
      }
      if (totalsleep > 60000) {
        throw new KettleException(Messages.getString("MappingInput.Exception.UnableToConnectWithParentMapping","" + (totalsleep / 1000)));
      }
    }
    data.linked=true;
  }
  Object[] row=getRow();
  if (row == null) {
    setOutputDone();
    return false;
  }
  if (first) {
    first=false;
    data.outputRowMeta=(RowMetaInterface)getInputRowMeta().clone();
    for (    MappingValueRename valueRename : data.valueRenames) {
      ValueMetaInterface valueMeta=data.outputRowMeta.searchValueMeta(valueRename.getSourceValueName());
      if (valueMeta == null) {
        throw new KettleStepException(Messages.getString("MappingInput.Exception.UnableToFindMappedValue",valueRename.getSourceValueName()));
      }
      valueMeta.setName(valueRename.getTargetValueName());
    }
  }
  putRow(data.outputRowMeta,row);
  return true;
}
