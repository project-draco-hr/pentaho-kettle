{
  if (metaA.isDate() && metaB.isDate()) {
    if (dataA != null && dataB != null) {
      long diff=metaA.getDate(dataA).getTime() - metaB.getDate(dataB).getTime();
      return new Long(diff / (1000 * 60 * 60* 24));
    }
 else     return null;
  }
  throw new KettleValueException("The 'DateDiff' function only works with dates");
}
