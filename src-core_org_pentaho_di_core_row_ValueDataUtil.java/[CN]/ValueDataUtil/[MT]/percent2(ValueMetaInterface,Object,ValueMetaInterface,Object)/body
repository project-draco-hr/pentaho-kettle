{
  if (dataA == null || dataB == null)   return null;
switch (metaA.getType()) {
case ValueMetaInterface.TYPE_NUMBER:
    return new Double(metaA.getNumber(dataA).doubleValue() - (metaA.getNumber(dataA).doubleValue() * metaB.getNumber(dataB).doubleValue() / 100.0));
case ValueMetaInterface.TYPE_INTEGER:
  return new Long(metaA.getInteger(dataA).longValue() - (metaA.getInteger(dataA).longValue() * metaB.getInteger(dataB).longValue() * 100));
case ValueMetaInterface.TYPE_BIGNUMBER:
return metaA.getBigNumber(dataA).subtract(metaA.getBigNumber(dataA).multiply(metaB.getBigNumber(dataB)).divide(new BigDecimal(100),BigDecimal.ROUND_HALF_UP));
default :
throw new KettleValueException("The 'A-B%' function only works on numeric data");
}
}
