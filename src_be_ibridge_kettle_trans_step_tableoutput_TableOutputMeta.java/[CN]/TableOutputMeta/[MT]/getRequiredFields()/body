{
  if (database != null) {
    Database db=new Database(database);
    try {
      db.connect();
      if (tablename != null && tablename.length() != 0) {
        if (db.checkTableExists(tablename)) {
          return db.getTableFields(tablename);
        }
 else {
          throw new KettleException(Messages.getString("TableOutputMeta.Exception.TableNotFound"));
        }
      }
 else {
        throw new KettleException(Messages.getString("TableOutputMeta.Exception.TableNotSpecified"));
      }
    }
 catch (    Exception e) {
      throw new KettleException(Messages.getString("TableOutputMeta.Exception.ErrorGettingFields"),e);
    }
 finally {
      db.disconnect();
    }
  }
 else {
    throw new KettleException(Messages.getString("TableOutputMeta.Exception.ConnectionNotDefined"));
  }
}
