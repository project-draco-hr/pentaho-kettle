{
  SQLStatement retval=new SQLStatement(stepMeta.getName(),database,null);
  if (database != null) {
    if (prev != null && prev.size() > 0) {
      if (tablename != null && tablename.length() > 0) {
        Database db=new Database(database);
        try {
          db.connect();
          String cr_table=db.getDDL(tablename,prev);
          if (cr_table == null || cr_table.length() == 0)           cr_table=null;
          retval.setSQL(cr_table);
        }
 catch (        KettleDatabaseException dbe) {
          retval.setError("I was unable to connect to the database to verify the status of the table: " + dbe.getMessage());
        }
 finally {
          db.disconnect();
        }
      }
 else {
        retval.setError("No table is defined on this connection.");
      }
    }
 else {
      retval.setError("Not receiving any fields from previous steps. Check the previous steps for errors & the connecting hops.");
    }
  }
 else {
    retval.setError("There is no connection defined in this step.");
  }
  return retval;
}
