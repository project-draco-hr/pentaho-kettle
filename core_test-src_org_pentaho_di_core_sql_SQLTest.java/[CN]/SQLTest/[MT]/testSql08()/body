{
  RowMetaInterface rowMeta=generateZipsRowMeta();
  String sqlString="SELECT            BT_MONGODB_MONGODB.state AS COL0          ,SUM(BT_MONGODB_MONGODB.rows) AS COL1 FROM            MongoDB BT_MONGODB_MONGODB GROUP BY            BT_MONGODB_MONGODB.state ORDER BY            COL1 DESC";
  SQL sql=new SQL(ThinUtil.stripNewlines(sqlString));
  assertEquals("MongoDB",sql.getServiceName());
  sql.parse(rowMeta);
  assertFalse(sql.getSelectFields().isDistinct());
  List<SQLField> selectFields=sql.getSelectFields().getFields();
  assertEquals(2,selectFields.size());
  assertEquals("state",selectFields.get(0).getField());
  assertEquals("COL0",selectFields.get(0).getAlias());
  assertEquals("rows",selectFields.get(1).getField());
  assertEquals("COL1",selectFields.get(1).getAlias());
  List<SQLField> orderFields=sql.getOrderFields().getFields();
  assertEquals(1,orderFields.size());
}
