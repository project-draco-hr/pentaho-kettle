{
  tfoi.fileName=wFilename.getText();
  tfoi.fileFormat=wFormat.getText();
  tfoi.separator=wSeparator.getText();
  tfoi.enclosure=wEnclosure.getText();
  tfoi.extension=wExtension.getText();
  tfoi.splitEvery=Const.toInt(wSplitEvery.getText(),0);
  tfoi.header=wHeader.getSelection();
  tfoi.footer=wFooter.getSelection();
  tfoi.fileAppended=wAppend.getSelection();
  tfoi.stepNrInFilename=wAddStepnr.getSelection();
  tfoi.dateInFilename=wAddDate.getSelection();
  tfoi.timeInFilename=wAddTime.getSelection();
  tfoi.zipped=wZipped.getSelection();
  tfoi.padded=wPad.getSelection();
  int i;
  int nrfields=wFields.nrNonEmpty();
  tfoi.allocate(nrfields);
  for (i=0; i < nrfields; i++) {
    TextFileField field=new TextFileField();
    TableItem item=wFields.getNonEmpty(i);
    field.setName(item.getText(1));
    field.setType(item.getText(2));
    field.setFormat(item.getText(3));
    field.setLength(Const.toInt(item.getText(4),-1));
    field.setPrecision(Const.toInt(item.getText(5),-1));
    field.setCurrencySymbol(item.getText(6));
    field.setDecimalSymbol(item.getText(7));
    field.setGroupingSymbol(item.getText(8));
    field.setNullString(item.getText(9));
    tfoi.getOutputFields()[i]=field;
  }
}
