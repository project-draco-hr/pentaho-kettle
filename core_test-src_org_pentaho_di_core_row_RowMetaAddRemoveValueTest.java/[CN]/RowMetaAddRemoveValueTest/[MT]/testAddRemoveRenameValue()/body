{
  RowMetaInterface rowMeta=new RowMeta();
  ValueMetaInterface a=ValueMetaFactory.createValueMeta("a",ValueMetaInterface.TYPE_STRING);
  rowMeta.addValueMeta(a);
  assertEquals(1,rowMeta.size());
  ValueMetaInterface b=ValueMetaFactory.createValueMeta("a",ValueMetaInterface.TYPE_INTEGER);
  rowMeta.addValueMeta(b);
  assertEquals(2,rowMeta.size());
  ValueMetaInterface c=ValueMetaFactory.createValueMeta("a",ValueMetaInterface.TYPE_DATE);
  rowMeta.addValueMeta(c);
  assertEquals(3,rowMeta.size());
  assertEquals(0,rowMeta.indexOfValue("a"));
  assertEquals(1,rowMeta.indexOfValue("a_1"));
  assertEquals(2,rowMeta.indexOfValue("a_2"));
  ValueMetaInterface d=ValueMetaFactory.createValueMeta("a",ValueMetaInterface.TYPE_NUMBER);
  rowMeta.addValueMeta(0,d);
  assertEquals(4,rowMeta.size());
  assertEquals(0,rowMeta.indexOfValue("a_3"));
  assertEquals(1,rowMeta.indexOfValue("a"));
  assertEquals(2,rowMeta.indexOfValue("a_1"));
  assertEquals(3,rowMeta.indexOfValue("a_2"));
  ValueMetaInterface e=ValueMetaFactory.createValueMeta("a",ValueMetaInterface.TYPE_BIGNUMBER);
  rowMeta.addValueMeta(2,e);
  assertEquals(5,rowMeta.size());
  assertEquals(0,rowMeta.indexOfValue("a_3"));
  assertEquals(1,rowMeta.indexOfValue("a"));
  assertEquals(2,rowMeta.indexOfValue("a_4"));
  assertEquals(3,rowMeta.indexOfValue("a_1"));
  assertEquals(4,rowMeta.indexOfValue("a_2"));
  rowMeta.removeValueMeta("a_4");
  assertEquals(4,rowMeta.size());
  assertEquals(0,rowMeta.indexOfValue("a_3"));
  assertEquals(1,rowMeta.indexOfValue("a"));
  assertEquals(2,rowMeta.indexOfValue("a_1"));
  assertEquals(3,rowMeta.indexOfValue("a_2"));
  rowMeta.removeValueMeta("a_3");
  assertEquals(3,rowMeta.size());
  assertEquals(0,rowMeta.indexOfValue("a"));
  assertEquals(1,rowMeta.indexOfValue("a_1"));
  assertEquals(2,rowMeta.indexOfValue("a_2"));
  rowMeta.removeValueMeta("a_2");
  assertEquals(2,rowMeta.size());
  assertEquals(0,rowMeta.indexOfValue("a"));
  assertEquals(1,rowMeta.indexOfValue("a_1"));
  rowMeta.removeValueMeta("a_1");
  assertEquals(1,rowMeta.size());
  assertEquals(0,rowMeta.indexOfValue("a"));
  rowMeta.removeValueMeta("a");
  assertEquals(0,rowMeta.size());
}
