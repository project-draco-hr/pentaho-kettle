{
  DatabaseMeta databaseMeta=transMeta.findDatabase(wConnection.getText());
  if (databaseMeta != null) {
    Database db=new Database(this,databaseMeta);
    db.shareVariablesWith(transMeta);
    try {
      db.connect();
      String schemaTable=databaseMeta.getQuotedSchemaTableCombination(wSchema.getText(),wTable.getText());
      RowMetaInterface r=db.getTableFields(schemaTable);
      if (r != null && !r.isEmpty()) {
        BaseStepDialog.getFieldsFromPrevious(r,wUpIns,2,new int[]{1,2},new int[]{3},-1,-1,new TableItemInsertListener(){
          public boolean tableItemInserted(          TableItem tableItem,          ValueMetaInterface v){
            int idx=wKey.indexOfString(v.getName(),2);
            if (idx < 0 && !v.getName().equalsIgnoreCase(wTk.getText()) && !v.getName().equalsIgnoreCase(wVersion.getText()) && !v.getName().equalsIgnoreCase(wFromdate.getText()) && !v.getName().equalsIgnoreCase(wTodate.getText())) {
              return true;
            }
            return false;
          }
        }
);
      }
    }
 catch (    KettleException e) {
      MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
      mb.setText(BaseMessages.getString(PKG,"DimensionLookupDialog.ErrorOccurred.DialogTitle"));
      mb.setMessage(BaseMessages.getString(PKG,"DimensionLookupDialog.ErrorOccurred.DialogMessage") + Const.CR + e.getMessage());
      mb.open();
    }
 finally {
      db.disconnect();
    }
  }
}
