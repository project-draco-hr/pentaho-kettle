{
  try {
    if (data.fc != null) {
      data.fc.close();
    }
    if (data.fis != null) {
      data.fis.close();
    }
    if (data.filenr >= data.filenames.length) {
      return false;
    }
    FileObject fileObject=KettleVFS.getFileObject(data.filenames[data.filenr]);
    if (!(fileObject instanceof LocalFile)) {
      throw new KettleException(Messages.getString("CsvInput.Log.OnlyLocalFilesAreSupported"));
    }
    if (meta.isLazyConversionActive()) {
      data.binaryFilename=data.filenames[data.filenr].getBytes();
    }
    data.fis=(FileInputStream)((LocalFile)fileObject).getInputStream();
    data.fc=data.fis.getChannel();
    data.bb=ByteBuffer.allocateDirect(data.preferredBufferSize);
    data.filenr++;
    data.rowNumber=1L;
    if (meta.isHeaderPresent()) {
      readOneRow(false);
    }
    return true;
  }
 catch (  Exception e) {
    throw new KettleException(e);
  }
}
