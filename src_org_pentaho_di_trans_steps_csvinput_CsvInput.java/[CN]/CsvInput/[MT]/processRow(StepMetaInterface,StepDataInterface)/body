{
  meta=(CsvInputMeta)smi;
  data=(CsvInputData)sdi;
  if (first) {
    first=false;
    data.convertRowMeta=new RowMeta();
    meta.getFields(data.convertRowMeta,getStepname(),null,null,this);
    data.outputRowMeta=data.convertRowMeta.clone();
    if (!meta.isLazyConversionActive()) {
      for (      ValueMetaInterface valueMeta : data.outputRowMeta.getValueMetaList()) {
        valueMeta.setStorageMetadata(null);
      }
    }
    if (meta.isHeaderPresent()) {
      readOneRow(false);
    }
  }
  Object[] outputRowData=readOneRow(true);
  if (outputRowData == null) {
    setOutputDone();
    return false;
  }
  putRow(data.outputRowMeta,outputRowData);
  if (checkFeedback(linesInput))   logBasic(Messages.getString("CsvInput.Log.LineNumber",Long.toString(linesInput)));
  return true;
}
