{
  meta=(CsvInputMeta)smi;
  data=(CsvInputData)sdi;
  if (super.init(smi,sdi)) {
    try {
      data.preferredBufferSize=Integer.parseInt(environmentSubstitute(meta.getBufferSize()));
      data.filename=environmentSubstitute(meta.getFilename());
      FileObject fileObject=KettleVFS.getFileObject(data.filename);
      if (!(fileObject instanceof LocalFile)) {
        logError(Messages.getString("CsvInput.Log.OnlyLocalFilesAreSupported"));
        return false;
      }
      FileInputStream fis=(FileInputStream)((LocalFile)fileObject).getInputStream();
      data.fc=fis.getChannel();
      data.bb=ByteBuffer.allocateDirect(data.preferredBufferSize);
      data.delimiter=environmentSubstitute(meta.getDelimiter()).getBytes();
      data.enclosure=environmentSubstitute(meta.getEnclosure()).getBytes();
      return true;
    }
 catch (    IOException e) {
      logError("Error opening file '" + meta.getFilename() + "' : "+ e.toString());
      logError(Const.getStackTracker(e));
    }
  }
  return false;
}
