{
  int i;
  Row agg=new Row();
  for (i=0; i < data.fieldnrs.length; i++) {
    Value val;
switch (meta.getAggregateType()[i]) {
case AggregateRowsMeta.TYPE_AGGREGATE_SUM:
case AggregateRowsMeta.TYPE_AGGREGATE_MIN:
case AggregateRowsMeta.TYPE_AGGREGATE_MAX:
case AggregateRowsMeta.TYPE_AGGREGATE_FIRST:
case AggregateRowsMeta.TYPE_AGGREGATE_LAST:
case AggregateRowsMeta.TYPE_AGGREGATE_NONE:
      val=data.values[i];
    break;
case AggregateRowsMeta.TYPE_AGGREGATE_COUNT:
  val=new Value(meta.getFieldName()[i],(double)data.counts[i]);
break;
case AggregateRowsMeta.TYPE_AGGREGATE_AVERAGE:
val=data.values[i];
val.setValue(val.getNumber() / data.counts[i]);
break;
default :
val=new Value(meta.getFieldName()[i],Value.VALUE_TYPE_NONE);
break;
}
if (meta.getFieldNewName() != null && val != null) val.setName(meta.getFieldNewName()[i]);
if (val != null) agg.addValue(val);
}
return agg;
}
