{
  if (prev != null) {
    if (!update) {
      for (int i=0; i < keyLookup.length; i++) {
        Value v=prev.searchValue(keyStream[i]);
        DatabaseImpact ii=new DatabaseImpact(DatabaseImpact.TYPE_IMPACT_READ,transMeta.getName(),stepMeta.getName(),database.getDatabaseName(),tableName,keyLookup[i],keyStream[i],v != null ? v.getOrigin() : "?","","Type = " + v.toStringMeta());
        impact.add(ii);
      }
      for (int i=0; i < fieldLookup.length; i++) {
        Value v=prev.searchValue(fieldStream[i]);
        DatabaseImpact ii=new DatabaseImpact(DatabaseImpact.TYPE_IMPACT_READ,transMeta.getName(),stepMeta.getName(),database.getDatabaseName(),tableName,fieldLookup[i],fieldLookup[i],v != null ? v.getOrigin() : "?","","Type = " + v.toStringMeta());
        impact.add(ii);
      }
    }
 else {
      for (int i=0; i < keyLookup.length; i++) {
        Value v=prev.searchValue(keyStream[i]);
        DatabaseImpact ii=new DatabaseImpact(DatabaseImpact.TYPE_IMPACT_READ_WRITE,transMeta.getName(),stepMeta.getName(),database.getDatabaseName(),tableName,keyLookup[i],keyStream[i],v.getOrigin(),"","Type = " + v.toStringMeta());
        impact.add(ii);
      }
      for (int i=0; i < fieldLookup.length; i++) {
        Value v=prev.searchValue(fieldStream[i]);
        DatabaseImpact ii=new DatabaseImpact(DatabaseImpact.TYPE_IMPACT_READ_WRITE,transMeta.getName(),stepMeta.getName(),database.getDatabaseName(),tableName,fieldLookup[i],fieldLookup[i],v.getOrigin(),"","Type = " + v.toStringMeta());
        impact.add(ii);
      }
    }
  }
}
