{
  String prSteps[]=props.getLastPreview();
  int prSizes[]=props.getLastPreviewSize();
  boolean sizesSet=false;
  int selectedSteps=0;
  for (int i=0; i < executedSteps.size(); i++) {
    StepMeta stepMeta=(StepMeta)executedSteps.get(i);
    if (stepMeta.isSelected())     selectedSteps++;
  }
  if (selectedSteps == 0) {
    for (int i=0; i < executedSteps.size(); i++) {
      StepMeta stepMeta=(StepMeta)executedSteps.get(i);
      TableItem item=wPreviewSteps.table.getItem(i);
      String name=stepMeta.getName();
      item.setText(1,name);
      item.setText(2,"0");
      for (int x=0; x < prSteps.length; x++) {
        if (prSteps[x].equalsIgnoreCase(name)) {
          item.setText(2,Integer.toString(prSizes[x]));
          sizesSet=true;
        }
      }
    }
  }
 else {
    for (int i=0; i < executedSteps.size(); i++) {
      StepMeta stepMeta=(StepMeta)executedSteps.get(i);
      TableItem item=wPreviewSteps.table.getItem(i);
      String name=stepMeta.getName();
      item.setText(1,name);
      item.setText(2,"");
      if (stepMeta.isSelected()) {
        item.setText(2,Integer.toString(props.getDefaultPreviewSize()));
        sizesSet=true;
      }
    }
  }
  if (sizesSet) {
    wPreviewSteps.sortTable(2,true);
  }
  wPreviewSteps.setRowNums();
  wPreviewSteps.optWidth(true);
}
