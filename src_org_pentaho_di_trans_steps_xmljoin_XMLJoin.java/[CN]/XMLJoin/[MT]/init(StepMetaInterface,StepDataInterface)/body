{
  meta=(XMLJoinMeta)smi;
  data=(XMLJoinData)sdi;
  if (!super.init(smi,sdi))   return false;
  try {
    if (meta.isOmitNullValues()) {
      setSerializer(TransformerFactory.newInstance().newTransformer(new StreamSource(XMLJoin.class.getClassLoader().getResourceAsStream("org/pentaho/di/trans/steps/xmljoin/RemoveNulls.xsl"))));
    }
 else {
      setSerializer(TransformerFactory.newInstance().newTransformer());
    }
    if (meta.getEncoding() != null) {
      getSerializer().setOutputProperty(OutputKeys.ENCODING,meta.getEncoding());
    }
    if (meta.isOmitXMLHeader()) {
      getSerializer().setOutputProperty(OutputKeys.OMIT_XML_DECLARATION,"yes");
    }
    for (int i=0; i < getInputRowSets().size(); i++) {
      BlockingRowSet rs=(BlockingRowSet)getInputRowSets().get(i);
      if (rs.getOriginStepName().equalsIgnoreCase(meta.getTargetXMLstep())) {
        BlockingRowSet zero=(BlockingRowSet)getInputRowSets().get(0);
        getInputRowSets().set(0,rs);
        getInputRowSets().set(i,zero);
      }
    }
  }
 catch (  Exception e) {
    return false;
  }
  return true;
}
