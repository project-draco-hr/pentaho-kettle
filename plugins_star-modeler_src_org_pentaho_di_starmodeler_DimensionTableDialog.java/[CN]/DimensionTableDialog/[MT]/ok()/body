{
  if (Utils.isEmpty(wTableName.getText())) {
    MessageBox box=new MessageBox(shell,SWT.ICON_ERROR | SWT.OK);
    box.setText(BaseMessages.getString(PKG,"DimensionTableDialog.ErrorDimensionHasNoName.Title"));
    box.setMessage(BaseMessages.getString(PKG,"DimensionTableDialog.ErrorDimensionHasNoName.Message"));
    box.open();
    return;
  }
  logicalTable.setName(new LocalizedString(locale,wTableName.getText()));
  logicalTable.setDescription(new LocalizedString(locale,wTableDescription.getText()));
  logicalTable.setProperty(DefaultPropertyID.TABLE_TYPE.getId(),TableType.DIMENSION);
  logicalTable.setProperty(DefaultIDs.LOGICAL_TABLE_PHYSICAL_TABLE_NAME,wPhysicalName.getText());
  logicalTable.setProperty(DefaultIDs.LOGICAL_TABLE_DIMENSION_TYPE,wDimensionType.getText());
  logicalTable.getLogicalColumns().clear();
  int nr=wAttributes.nrNonEmpty();
  for (int i=0; i < nr; i++) {
    TableItem item=wAttributes.getNonEmpty(i);
    LogicalColumn logicalColumn=new LogicalColumn();
    logicalColumn.setId(UUID.randomUUID().toString());
    int col=1;
    logicalColumn.setName(new LocalizedString(locale,item.getText(col++)));
    logicalColumn.setDescription(new LocalizedString(locale,item.getText(col++)));
    String fieldTypeString=item.getText(col++);
    logicalColumn.setProperty(DefaultIDs.LOGICAL_COLUMN_ATTRIBUTE_TYPE,AttributeType.getAttributeType(fieldTypeString).name());
    logicalColumn.setProperty(DefaultIDs.LOGICAL_COLUMN_PHYSICAL_COLUMN_NAME,item.getText(col++));
    String dataTypeString=item.getText(col++);
    logicalColumn.setDataType(Utils.isEmpty(dataTypeString) ? null : DataType.valueOf(dataTypeString));
    logicalColumn.setProperty(DefaultIDs.LOGICAL_COLUMN_LENGTH,item.getText(col++));
    logicalColumn.setProperty(DefaultIDs.LOGICAL_COLUMN_PRECISION,item.getText(col++));
    logicalColumn.setProperty(DefaultIDs.LOGICAL_COLUMN_SOURCE_DB,item.getText(col++));
    logicalColumn.setProperty(DefaultIDs.LOGICAL_COLUMN_SOURCE_TABLE,item.getText(col++));
    logicalColumn.setProperty(DefaultIDs.LOGICAL_COLUMN_SOURCE_COLUMN,item.getText(col++));
    logicalColumn.setProperty(DefaultIDs.LOGICAL_COLUMN_CONVERSION_REMARKS,item.getText(col++));
    logicalColumn.setLogicalTable(logicalTable);
    logicalTable.getLogicalColumns().add(logicalColumn);
  }
  dispose();
}
