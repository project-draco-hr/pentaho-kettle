{
  try {
    for (int i=0; i < data.keynrs.length; i++) {
      if (i > 0) {
        data.fifoStream.write(data.separator);
      }
      int index=data.keynrs[i];
      ValueMetaInterface valueMeta=rowMeta.getValueMeta(index);
      Object valueData=r[index];
      if (valueData == null) {
      }
 else {
        if (valueMeta.isStorageBinaryString()) {
          byte[] value=valueMeta.getBinaryString(valueData);
          data.fifoStream.write(value);
        }
 else {
          String string=valueMeta.getString(valueData);
          if (string != null) {
            byte[] value=data.getBytes(string);
            data.fifoStream.write(value);
          }
        }
      }
    }
    data.fifoStream.write(data.newline);
  }
 catch (  Exception e) {
    try {
      data.sqlRunner.checkExcn();
    }
 catch (    Exception loadEx) {
      throw new KettleException("Error serializing rows of data to the fifo file",loadEx);
    }
    throw new KettleException("Error serializing rows of data to the fifo file",e);
  }
}
