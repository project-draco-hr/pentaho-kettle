{
  String exactFilename=StringUtil.environmentSubstitute(entry.getFilename());
  String exactJobname=StringUtil.environmentSubstitute(entry.getJobName());
  if (Const.isEmpty(exactFilename) && !Const.isEmpty(exactJobname)) {
    try {
      JobMeta newJobMeta=new JobMeta(log,spoon.rep,exactJobname,entry.getDirectory());
      newJobMeta.clearChanged();
      spoon.addChefGraph(newJobMeta);
    }
 catch (    Throwable e) {
      new ErrorDialog(shell,Messages.getString("ChefGraph.Dialog.ErrorLaunchingChefCanNotLoadJob.Title"),Messages.getString("ChefGraph.Dialog.ErrorLaunchingChefCanNotLoadJob.Message"),new Exception(e));
    }
  }
 else {
    try {
      if (Const.isEmpty(exactFilename)) {
        throw new Exception(Messages.getString("ChefGraph.Exception.NoFilenameSpecified"));
      }
      JobMeta newJobMeta;
      if (KettleVFS.fileExists(exactFilename)) {
        newJobMeta=new JobMeta(log,exactFilename,spoon.rep);
      }
 else {
        newJobMeta=new JobMeta(log);
      }
      newJobMeta.setFilename(exactFilename);
      newJobMeta.clearChanged();
      spoon.addChefGraph(newJobMeta);
    }
 catch (    Throwable e) {
      new ErrorDialog(shell,Messages.getString("ChefGraph.Dialog.ErrorLaunchingChefCanNotLoadJobFromXML.Title"),Messages.getString("ChefGraph.Dialog.ErrorLaunchingChefCanNotLoadJobFromXML.Message"),new Exception(e));
    }
  }
}
