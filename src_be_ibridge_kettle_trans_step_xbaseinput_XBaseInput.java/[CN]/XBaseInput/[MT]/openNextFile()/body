{
  if (data.xbi != null) {
    logBasic(Messages.getString("XBaseInput.Log.FinishedReadingRecords"));
    data.xbi.close();
  }
  data.file_dbf=data.files.getFile(data.fileNr);
  data.fileNr++;
  data.xbi=new XBase(data.file_dbf.getPath());
  try {
    data.xbi.open();
    logBasic(Messages.getString("XBaseInput.Log.OpenedXBaseFile") + " : [" + data.file_dbf.getPath()+ "]");
    data.fields=data.xbi.getFields();
    ResultFile resultFile=new ResultFile(ResultFile.FILE_TYPE_GENERAL,new File(data.file_dbf.getPath()),getTransMeta().getName(),getStepname());
    resultFile.setComment(Messages.getString("XBaseInput.ResultFile.Comment"));
    addResultFile(resultFile);
  }
 catch (  KettleException e) {
    logError(Messages.getString("XBaseInput.Log.Error.CouldNotOpenXBaseFile1") + data.file_dbf + Messages.getString("XBaseInput.Log.Error.CouldNotOpenXBaseFile2")+ e.getMessage());
    throw e;
  }
}
