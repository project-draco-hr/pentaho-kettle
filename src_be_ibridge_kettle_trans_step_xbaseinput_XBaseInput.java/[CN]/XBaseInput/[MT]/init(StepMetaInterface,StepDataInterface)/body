{
  meta=(XBaseInputMeta)smi;
  data=(XBaseInputData)sdi;
  if (super.init(smi,sdi)) {
    String file_dbf=StringUtil.environmentSubstitute(meta.getDbfFileName());
    data.xbi=new XBase(file_dbf);
    try {
      data.xbi.open();
      logBasic(Messages.getString("XBaseInput.Log.OpenedXBaseFile"));
      data.fields=data.xbi.getFields();
      ResultFile resultFile=new ResultFile(ResultFile.FILE_TYPE_GENERAL,new File(meta.getDbfFileName()),getTransMeta().getName(),getStepname());
      resultFile.setComment("File was read by an XBase input step");
      addResultFile(resultFile);
      return true;
    }
 catch (    KettleException e) {
      logError(Messages.getString("XBaseInput.Log.Error.CouldNotOpenXBaseFile1") + file_dbf + Messages.getString("XBaseInput.Log.Error.CouldNotOpenXBaseFile2")+ e.getMessage());
    }
  }
  return false;
}
