{
  if (fileName != null && fileName.length() > 0) {
    try {
      mappingTransMeta=new TransMeta(fileName);
    }
 catch (    Exception e) {
      LogWriter.getInstance().logError("Loading Mapping from XML","Unable to load transformation [" + transName + "] : "+ e.toString());
      LogWriter.getInstance().logError("Loading Mapping from XML",Const.getStackTracker(e));
    }
  }
 else {
    if (transName != null && directoryPath != null && rep != null) {
      RepositoryDirectory repdir=rep.getDirectoryTree().findDirectory(directoryPath);
      if (repdir != null) {
        try {
          mappingTransMeta=new TransMeta(rep,transName,repdir);
        }
 catch (        Exception e) {
          LogWriter.getInstance().logError("Loading Mapping from repository","Unable to load transformation [" + transName + "] : "+ e.toString());
          LogWriter.getInstance().logError("Loading Mapping from repository",Const.getStackTracker(e));
        }
      }
 else {
        throw new KettleException(Messages.getString("MappingMeta.Exception.UnableToLoadTransformation",transName) + directoryPath);
      }
    }
  }
}
