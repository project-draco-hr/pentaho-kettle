{
  RowSet set=new RowSet(3);
  Row r1=new Row();
  r1.addValue(new Value("ROWNR",1L));
  Row r2=new Row();
  r2.addValue(new Value("ROWNR",2L));
  Row r3=new Row();
  r3.addValue(new Value("ROWNR",3L));
  Row r4=new Row();
  r4.addValue(new Value("ROWNR",4L));
  Row r5=new Row();
  r5.addValue(new Value("ROWNR",5L));
  assertTrue(set.isEmpty());
  assertEquals(0,set.size());
  set.putRow(r1);
  assertTrue(!set.isEmpty());
  assertTrue(!set.isFull());
  assertEquals(1,set.size());
  set.putRow(r2);
  assertTrue(!set.isEmpty());
  assertTrue(!set.isFull());
  assertEquals(2,set.size());
  Row r=set.getRow();
  Value v=r.searchValue("ROWNR");
  assertEquals(1L,v.getInteger());
  assertTrue(!set.isEmpty());
  assertTrue(!set.isFull());
  assertEquals(1,set.size());
  set.putRow(r3);
  assertTrue(!set.isEmpty());
  assertTrue(!set.isFull());
  assertEquals(2,set.size());
  set.putRow(r4);
  assertTrue(!set.isEmpty());
  assertTrue(set.isFull());
  assertEquals(3,set.size());
  r=set.getRow();
  v=r.searchValue("ROWNR");
  assertEquals(2L,v.getInteger());
  assertTrue(!set.isEmpty());
  assertTrue(!set.isFull());
  assertEquals(2,set.size());
  set.putRow(r5);
  assertTrue(!set.isEmpty());
  assertTrue(set.isFull());
  assertEquals(3,set.size());
  r=set.getRow();
  v=r.searchValue("ROWNR");
  assertEquals(3L,v.getInteger());
  assertTrue(!set.isEmpty());
  assertTrue(!set.isFull());
  assertEquals(2,set.size());
  r=set.getRow();
  v=r.searchValue("ROWNR");
  assertEquals(4L,v.getInteger());
  assertTrue(!set.isEmpty());
  assertTrue(!set.isFull());
  assertEquals(1,set.size());
  r=set.getRow();
  v=r.searchValue("ROWNR");
  assertEquals(5L,v.getInteger());
  assertTrue(set.isEmpty());
  assertTrue(!set.isFull());
  assertEquals(0,set.size());
}
