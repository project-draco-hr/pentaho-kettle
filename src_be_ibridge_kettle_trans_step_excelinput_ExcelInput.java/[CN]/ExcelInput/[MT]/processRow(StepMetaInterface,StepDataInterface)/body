{
  meta=(ExcelInputMeta)smi;
  data=(ExcelInputData)sdi;
  if (data.filenr >= data.files.length) {
    logDetailed("No more files to be processes! (" + data.filenr + " files done)");
    setOutputDone();
    return false;
  }
  if (meta.getRowLimit() > 0 && data.rownr > meta.getRowLimit()) {
    logDetailed("Row limit of [" + meta.getRowLimit() + "] reached: stop processing.");
    setOutputDone();
    return false;
  }
  try {
    Row r=getRowFromWorkbooks();
    if (r != null) {
      if (!r.isIgnored()) {
        if (data.previousRow != null) {
          for (int i=0; i < meta.getFieldRepeat().length; i++) {
            Value field=r.getValue(i);
            if (field.isNull() && meta.getFieldRepeat()[i]) {
              Value repeat=data.previousRow.getValue(i);
              field.setValue(repeat);
            }
          }
        }
        data.previousRow=r;
        putRow(r);
      }
      return true;
    }
 else {
      return false;
    }
  }
 catch (  ExcelInputRowValueException excelInputRowValueException) {
    data.dataErrorHandler.handleLineError(excelInputRowValueException.excelInputRow.rownr,excelInputRowValueException.excelInputRow.sheetName);
    return true;
  }
}
