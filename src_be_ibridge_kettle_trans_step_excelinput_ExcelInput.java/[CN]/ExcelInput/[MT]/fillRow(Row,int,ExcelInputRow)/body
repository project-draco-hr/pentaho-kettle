{
  debug="fillRow start";
  Row r=new Row(baserow);
  for (int i=startcolumn; i < excelInputRow.cells.length && i - startcolumn < r.size(); i++) {
    debug="get cell #" + i;
    Cell cell=excelInputRow.cells[i];
    int rowcolumn=i - startcolumn;
    debug="Rowcolumn = " + rowcolumn;
    Value v=r.getValue(rowcolumn);
    debug="Value v = " + v;
    try {
      checkType(cell,v);
    }
 catch (    KettleException ex) {
      if (!meta.isErrorIgnored())       throw ex;
      logRowlevel("Warning processing [" + debug + "] from Excel file ["+ data.filename+ "] : "+ ex.toString());
      data.errorHandler.handleLineError(excelInputRow.rownr,excelInputRow.sheetName);
      if (meta.isErrorLineSkipped()) {
        r.setIgnore();
        return r;
      }
    }
    if (cell.getType().equals(CellType.BOOLEAN)) {
      v.setValue(((BooleanCell)cell).getValue());
    }
 else     if (cell.getType().equals(CellType.DATE)) {
      v.setValue(((DateCell)cell).getDate());
    }
 else     if (cell.getType().equals(CellType.LABEL)) {
      v.setValue(((LabelCell)cell).getString());
switch (meta.getFieldTrimType()[rowcolumn]) {
case ExcelInputMeta.TYPE_TRIM_LEFT:
        v.ltrim();
      break;
case ExcelInputMeta.TYPE_TRIM_RIGHT:
    v.rtrim();
  break;
case ExcelInputMeta.TYPE_TRIM_BOTH:
v.trim();
break;
default :
break;
}
}
 else if (cell.getType().equals(CellType.NUMBER)) {
v.setValue(((NumberCell)cell).getValue());
}
 else {
logDetailed("Unknown type : " + cell.getType().toString() + " : ["+ cell.getContents()+ "]");
v.setNull();
}
v.setType(meta.getFieldType()[rowcolumn]);
v.setLength(meta.getFieldLength()[rowcolumn],meta.getFieldPrecision()[rowcolumn]);
}
debug="filename";
if (meta.getFileField() != null && meta.getFileField().length() > 0) {
Value value=new Value(meta.getFileField(),data.filename);
value.setLength(data.maxfilelength);
r.addValue(value);
}
debug="sheetname";
if (meta.getSheetField() != null && meta.getSheetField().length() > 0) {
Value value=new Value(meta.getSheetField(),excelInputRow.sheetName);
value.setLength(data.maxsheetlength);
r.addValue(value);
}
debug="rownumber";
if (meta.getRowNumberField() != null && meta.getRowNumberField().length() > 0) {
Value value=new Value(meta.getRowNumberField(),linesWritten + 1);
r.addValue(value);
}
debug="end of fillRow";
return r;
}
