{
  Database accessDatabase=null;
  try {
    AccessInputMeta meta=new AccessInputMeta();
    getInfo(meta);
    FileInputList fileInputList=meta.getFiles(transMeta);
    if (fileInputList.nrOfFiles() > 0) {
      if (fileInputList.getFile(0).exists()) {
        accessDatabase=Database.open(new File(KettleVFS.getFilename(fileInputList.getFile(0))));
        Set<String> settables=accessDatabase.getTableNames();
        String[] tablenames=(String[])settables.toArray(new String[settables.size()]);
        EnterSelectionDialog dialog=new EnterSelectionDialog(shell,tablenames,Messages.getString("AccessInputDialog.Dialog.SelectATable.Title"),Messages.getString("AccessInputDialog.Dialog.SelectATable.Message"));
        String tablename=dialog.open();
        if (tablename != null) {
          wTable.setText(tablename);
        }
      }
 else {
        throw new KettleException(Messages.getString("AccessInputMeta.Exception.FileDoesNotExist",KettleVFS.getFilename(fileInputList.getFile(0))));
      }
    }
 else {
      MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
      mb.setMessage(Messages.getString("AccessInputDialog.FilesMissing.DialogMessage"));
      mb.setText(Messages.getString("System.Dialog.Error.Title"));
      mb.open();
    }
  }
 catch (  Throwable e) {
    new ErrorDialog(shell,Messages.getString("AccessInputDialog.UnableToGetListOfTables.Title"),Messages.getString("AccessInputDialog.UnableToGetListOfTables.Message"),e);
  }
 finally {
    try {
      if (accessDatabase != null)       accessDatabase.close();
    }
 catch (    Exception e) {
    }
  }
}
