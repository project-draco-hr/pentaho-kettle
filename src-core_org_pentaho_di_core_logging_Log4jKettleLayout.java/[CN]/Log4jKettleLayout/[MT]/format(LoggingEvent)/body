{
  StringBuffer line=new StringBuffer();
  String dateTimeString="";
  if (timeAdded) {
    dateTimeString=((SimpleDateFormat)LOCAL_SIMPLE_DATE_PARSER.get()).format(new Date(event.timeStamp)) + " - ";
  }
  Object object=event.getMessage();
  if (object instanceof Log4jMessage) {
    Log4jMessage message=(Log4jMessage)object;
    String parts[]=message.getMessage().split(Const.CR);
    for (int i=0; i < parts.length; i++) {
      line.append(dateTimeString);
      if (message.getSubject() != null) {
        line.append(message.getSubject()).append(" - ");
      }
      if (message.isError()) {
        BuildVersion buildVersion=BuildVersion.getInstance();
        line.append(ERROR_STRING);
        line.append(" (version ");
        line.append(Const.VERSION);
        line.append(", build ");
        line.append(buildVersion.getVersion());
        line.append(" from ");
        line.append(((SimpleDateFormat)LOCAL_SIMPLE_DATE_PARSER.get()).format(buildVersion.getBuildDate()));
        if (!Const.isEmpty(buildVersion.getHostname())) {
          line.append(" @ ");
          line.append(buildVersion.getHostname());
        }
        line.append(") : ");
      }
      line.append(parts[i]);
      if (i < parts.length - 1)       line.append(Const.CR);
    }
  }
 else {
    line.append(dateTimeString);
    line.append((object != null ? object.toString() : "<null>"));
  }
  return line.toString();
}
