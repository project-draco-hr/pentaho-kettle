{
  if (rep == null || importfile) {
    FileDialog dialog=new FileDialog(shell,SWT.OPEN);
    dialog.setFilterExtensions(Const.STRING_TRANS_FILTER_EXT);
    dialog.setFilterNames(Const.STRING_TRANS_FILTER_NAMES);
    String fname=dialog.open();
    if (fname != null) {
      try {
        TransMeta transMeta=new TransMeta(fname,rep);
        props.addLastFile(Props.TYPE_PROPERTIES_SPOON,fname,null,false,null);
        addMenuLast();
        if (!importfile)         transMeta.clearChanged();
        transMeta.setFilename(fname);
        addSpoonGraph(transMeta);
      }
 catch (      KettleException e) {
        MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
        mb.setMessage(Messages.getString("Spoon.Dialog.ErrorOpening.Message") + fname + Const.CR+ e.getMessage());
        mb.setText(Messages.getString("Spoon.Dialog.ErrorOpening.Title"));
        mb.open();
      }
      refreshGraph();
      refreshTree();
      refreshHistory();
    }
  }
 else {
    SelectObjectDialog sod=new SelectObjectDialog(shell,props,rep,true,false,false);
    String transname=sod.open();
    RepositoryDirectory repdir=sod.getDirectory();
    if (transname != null && repdir != null) {
      TransLoadProgressDialog tlpd=new TransLoadProgressDialog(shell,rep,transname,repdir);
      TransMeta transMeta=tlpd.open();
      if (transMeta != null) {
        log.logDetailed(toString(),Messages.getString("Spoon.Log.LoadToTransformation",transname,repdir.getDirectoryName()));
        props.addLastFile(Props.TYPE_PROPERTIES_SPOON,transname,repdir.getPath(),true,rep.getName());
        addMenuLast();
        transMeta.clearChanged();
        transMeta.setFilename(transname);
        addSpoonGraph(transMeta);
      }
      refreshGraph();
      refreshTree();
      refreshHistory();
    }
  }
}
