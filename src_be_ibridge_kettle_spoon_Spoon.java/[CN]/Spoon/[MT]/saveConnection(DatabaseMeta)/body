{
  if (rep != null) {
    if (!rep.userinfo.isReadonly()) {
      try {
        db.saveRep(rep);
        log.logDetailed(toString(),Messages.getString("Spoon.Log.SavedDatabaseConnection",db.getDatabaseName()));
        rep.commit();
      }
 catch (      KettleException ke) {
        rep.rollback();
        new ErrorDialog(shell,Messages.getString("Spoon.Dialog.ErrorSavingConnection.Title"),Messages.getString("Spoon.Dialog.ErrorSavingConnection.Message",db.getDatabaseName()),ke);
      }
    }
 else {
      new ErrorDialog(shell,Messages.getString("Spoon.Dialog.UnableSave.Title"),Messages.getString("Spoon.Dialog.ErrorSavingConnection.Message",db.getDatabaseName()),new KettleException(Messages.getString("Spoon.Dialog.Exception.ReadOnlyRepositoryUser")));
    }
  }
}
