{
  String xml=XMLHandler.getXMLHeader() + transMeta.getXML();
  try {
    DataOutputStream dos=new DataOutputStream(new FileOutputStream(new File(fname)));
    dos.write(xml.getBytes(Const.XML_ENCODING));
    dos.close();
    props.addLastFile(Props.TYPE_PROPERTIES_SPOON,fname,Const.FILE_SEPARATOR,false,"");
    saveSettings();
    addMenuLast();
    transMeta.clearChanged();
    setShellText();
    log.logDebug(toString(),Messages.getString("Spoon.Log.FileWritten") + " [" + fname+ "]");
  }
 catch (  Exception e) {
    log.logDebug(toString(),Messages.getString("Spoon.Log.ErrorOpeningFileForWriting") + e.toString());
    MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
    mb.setMessage(Messages.getString("Spoon.Dialog.ErrorSavingFile.Message") + Const.CR + e.toString());
    mb.setText(Messages.getString("Spoon.Dialog.ErrorSavingFile.Title"));
    mb.open();
  }
}
