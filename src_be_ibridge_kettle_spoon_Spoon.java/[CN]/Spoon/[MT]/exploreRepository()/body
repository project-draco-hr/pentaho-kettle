{
  if (rep != null) {
    RepositoryExplorerDialog erd=new RepositoryExplorerDialog(shell,SWT.NONE,rep,rep.getUserInfo());
    String objname=erd.open();
    if (objname != null) {
      String object_type=erd.getObjectType();
      RepositoryDirectory repdir=erd.getObjectDirectory();
      if (object_type.equals(RepositoryExplorerDialog.STRING_TRANSFORMATIONS)) {
        try {
          TransMeta transMeta=new TransMeta(rep,objname,repdir);
          transMeta.clearChanged();
          transMeta.setFilename(objname);
          addSpoonGraph(transMeta);
          refreshTree();
          refreshGraph();
        }
 catch (        KettleException e) {
          MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
          mb.setMessage(Messages.getString("Spoon.Dialog.ErrorOpening.Message") + objname + Const.CR+ e.getMessage());
          mb.setText(Messages.getString("Spoon.Dialog.ErrorOpening.Title"));
          mb.open();
        }
      }
 else       if (object_type.equals(RepositoryExplorerDialog.STRING_JOBS)) {
        try {
          JobMeta jobMeta=new JobMeta(log,rep,objname,repdir);
          jobMeta.clearChanged();
          jobMeta.setFilename(objname);
          addChefGraph(jobMeta);
          refreshTree();
          refreshGraph();
        }
 catch (        KettleException e) {
          MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
          mb.setMessage(Messages.getString("Spoon.Dialog.ErrorOpening.Message") + objname + Const.CR+ e.getMessage());
          mb.setText(Messages.getString("Spoon.Dialog.ErrorOpening.Title"));
          mb.open();
        }
      }
    }
  }
}
