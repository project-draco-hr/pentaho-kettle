{
  if (transMeta == null)   return false;
  boolean saved=false;
  log.logDetailed(toString(),Messages.getString("Spoon.Log.SaveToFileOrRepository"));
  if (rep != null) {
    saved=saveRepository(transMeta);
  }
 else {
    if (transMeta.getFilename() != null) {
      saved=save(transMeta,transMeta.getFilename());
    }
 else {
      saved=saveFileAs(transMeta);
    }
  }
  if (saved) {
    saved=saveSharedObjects(transMeta);
  }
  try {
    if (props.useDBCache())     transMeta.getDbCache().saveCache(log);
  }
 catch (  KettleException e) {
    new ErrorDialog(shell,Messages.getString("Spoon.Dialog.ErrorSavingDatabaseCache.Title"),Messages.getString("Spoon.Dialog.ErrorSavingDatabaseCache.Message"),e);
  }
  renameTabs();
  return saved;
}
