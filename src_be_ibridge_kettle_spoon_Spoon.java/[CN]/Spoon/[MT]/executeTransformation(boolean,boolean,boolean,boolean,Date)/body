{
  executionConfiguration.setExecutingLocally(local);
  executionConfiguration.setExecutingRemotely(remote);
  executionConfiguration.setExecutingClustered(cluster);
  executionConfiguration.getUsedVariables(transMeta);
  executionConfiguration.getUsedArguments(transMeta,arguments);
  executionConfiguration.setReplayDate(replayDate);
  executionConfiguration.setLocalPreviewing(preview);
  executionConfiguration.setLogLevel(log.getLogLevel());
  executionConfiguration.setSafeModeEnabled(spoonlog.isSafeModeChecked());
  TransExecutionConfigurationDialog dialog=new TransExecutionConfigurationDialog(shell,executionConfiguration,transMeta);
  if (dialog.open()) {
    System.out.println(executionConfiguration.getXML());
    if (executionConfiguration.isExecutingLocally()) {
      if (executionConfiguration.isLocalPreviewing()) {
        tabfolder.setSelection(1);
        spoonlog.preview(executionConfiguration);
      }
 else {
        tabfolder.setSelection(1);
        spoonlog.start(executionConfiguration);
      }
    }
 else     if (executionConfiguration.isExecutingRemotely()) {
      sendXMLToSlaveServer(executionConfiguration);
    }
 else     if (executionConfiguration.isExecutingClustered()) {
      splitTrans(executionConfiguration.isClusterShowingTransformation(),executionConfiguration.isClusterPosting(),executionConfiguration.isClusterPreparing(),executionConfiguration.isClusterStarting());
    }
  }
}
