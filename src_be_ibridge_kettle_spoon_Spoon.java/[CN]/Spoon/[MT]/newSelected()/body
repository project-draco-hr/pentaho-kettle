{
  log.logDebug(toString(),Messages.getString("Log.NewSelected"));
  TreeItem ti[]=selectionTree.getSelection();
  if (ti.length >= 1) {
    String name=ti[0].getText();
    TreeItem parent=ti[0].getParentItem();
    if (parent == null) {
      log.logDebug(toString(),Messages.getString("Log.ElementHasNoParent"));
      if (name.equalsIgnoreCase(STRING_CONNECTIONS))       newConnection();
      if (name.equalsIgnoreCase(STRING_HOPS))       newHop();
      if (name.equalsIgnoreCase(STRING_STEPS)) {
        MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_INFORMATION);
        mb.setMessage(Messages.getString("Message.MessageBox.WarningCreateNewSteps"));
        mb.setText(Messages.getString("Message.MessageBox.Tip"));
        mb.open();
      }
    }
 else {
      String strparent=parent.getText();
      log.logDebug(toString(),Messages.getString("Log.ElementHasParent") + strparent);
      if (strparent.equalsIgnoreCase(STRING_CONNECTIONS))       newConnection();
      if (strparent.equalsIgnoreCase(STRING_STEPS)) {
        log.logDebug(toString(),Messages.getString("Log.NewHop"));
        StepMeta from=transMeta.findStep(ti[0].getText());
        StepMeta to=transMeta.findStep(ti[1].getText());
        if (from != null && to != null)         newHop(from,to);
      }
      TreeItem grandparent=parent.getParentItem();
      if (grandparent != null) {
        String strgrandparent=grandparent.getText();
        if (strgrandparent.equalsIgnoreCase(STRING_BASE) || strgrandparent.equalsIgnoreCase(STRING_PLUGIN)) {
          newStep();
        }
      }
    }
  }
}
