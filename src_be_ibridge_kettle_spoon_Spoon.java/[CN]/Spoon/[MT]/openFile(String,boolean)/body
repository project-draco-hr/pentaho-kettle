{
  try {
    Document document=XMLHandler.loadXMLFile(fname);
    boolean loaded=false;
    Node transNode=XMLHandler.getSubNode(document,TransMeta.XML_TAG);
    if (transNode != null) {
      TransMeta transMeta=new TransMeta();
      transMeta.loadXML(transNode,rep,true);
      props.addLastFile(LastUsedFile.FILE_TYPE_TRANSFORMATION,fname,null,false,null);
      addMenuLast();
      if (!importfile)       transMeta.clearChanged();
      transMeta.setFilename(fname);
      addSpoonGraph(transMeta);
      refreshTree();
      refreshHistory();
      loaded=true;
    }
    Node jobNode=XMLHandler.getSubNode(document,JobMeta.XML_TAG);
    if (jobNode != null) {
      JobMeta jobMeta=new JobMeta(log);
      jobMeta.loadXML(jobNode,rep);
      props.addLastFile(LastUsedFile.FILE_TYPE_JOB,fname,null,false,null);
      addMenuLast();
      if (!importfile)       jobMeta.clearChanged();
      jobMeta.setFilename(fname);
      addChefGraph(jobMeta);
      refreshTree();
      refreshHistory();
      loaded=true;
    }
    if (!loaded) {
      MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
      mb.setMessage(Messages.getString("Spoon.UnknownFileType.Message",fname));
      mb.setText(Messages.getString("Spoon.UnknownFileType.Title"));
      mb.open();
    }
  }
 catch (  KettleException e) {
    new ErrorDialog(shell,Messages.getString("Spoon.Dialog.ErrorOpening.Title"),Messages.getString("Spoon.Dialog.ErrorOpening.Message") + fname,e);
  }
}
