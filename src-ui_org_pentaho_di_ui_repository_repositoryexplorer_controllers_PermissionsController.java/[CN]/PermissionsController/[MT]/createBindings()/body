{
  folderTree=(XulTree)document.getElementById("folder-tree");
  fileFolderLabel=(XulLabel)document.getElementById("file-folder-name");
  messageDialog=(XulDialog)document.getElementById("message-dialog");
  messageLabel=(XulLabel)document.getElementById("message-to-display");
  aclDeck=(XulDeck)document.getElementById("acl-deck");
  fileTable=(XulTree)document.getElementById("file-table");
  userRoleList=(XulListbox)document.getElementById("user-role-list");
  createCheckbox=(XulCheckbox)document.getElementById("create-checkbox");
  updateCheckbox=(XulCheckbox)document.getElementById("update-checkbox");
  readCheckbox=(XulCheckbox)document.getElementById("read-checkbox");
  deleteCheckbox=(XulCheckbox)document.getElementById("delete-checkbox");
  inheritParentPermissionCheckbox=(XulCheckbox)document.getElementById("inherit-from-parent-permission-checkbox");
  modifyCheckbox=(XulCheckbox)document.getElementById("modify-checkbox");
  manageAclsDialog=(XulDialog)document.getElementById("manage-acls-dialog");
  addAclButton=(XulButton)document.getElementById("add-acl-button");
  removeAclButton=(XulButton)document.getElementById("remove-acl-button");
  availableUserList=(XulListbox)document.getElementById("available-user-list");
  selectedUserList=(XulListbox)document.getElementById("selected-user-list");
  availableRoleList=(XulListbox)document.getElementById("available-role-list");
  selectedRoleList=(XulListbox)document.getElementById("selected-role-list");
  assignRoleButton=(XulButton)document.getElementById("assign-role");
  unassignRoleButton=(XulButton)document.getElementById("unassign-role");
  assignUserButton=(XulButton)document.getElementById("assign-user");
  unassignUserButton=(XulButton)document.getElementById("unassign-user");
  applyAclConfirmationDialog=(XulDialog)document.getElementById("apply-acl-confirmation-dialog");
  applyOnlyRadioButton=(XulRadio)document.getElementById("apply-only-radio-button");
  applyRecursiveRadioButton=(XulRadio)document.getElementById("apply-recursive-radio-button");
  removeAclConfirmationDialog=(XulDialog)document.getElementById("remove-acl-confirmation-dialog");
  bf.setBindingType(Binding.Type.ONE_WAY);
  bf.createBinding(aclModel,"availableUserList",availableUserList,"elements");
  bf.createBinding(aclModel,"selectedUserList",selectedUserList,"elements");
  bf.createBinding(aclModel,"availableRoleList",availableRoleList,"elements");
  bf.createBinding(aclModel,"selectedRoleList",selectedRoleList,"elements");
  BindingConvertor<Object[],List<UIRepositoryObjectAcl>> arrayToListConverter=new BindingConvertor<Object[],List<UIRepositoryObjectAcl>>(){
    @Override public Object[] targetToSource(    List<UIRepositoryObjectAcl> roles){
      if (roles != null) {
        Object[] retVal=new Object[roles.size()];
        int i=0;
        for (        Object role : roles) {
          retVal[i++]=role;
        }
        return retVal;
      }
      return null;
    }
    @Override public List<UIRepositoryObjectAcl> sourceToTarget(    Object[] roles){
      if (roles != null) {
        List<UIRepositoryObjectAcl> retVal=new ArrayList<UIRepositoryObjectAcl>();
        for (int i=0; i < roles.length; i++) {
          retVal.add((UIRepositoryObjectAcl)roles[i]);
        }
        return retVal;
      }
      return null;
    }
  }
;
  BindingConvertor<int[],List<UIRepositoryUser>> indexToAvalableUserConverter=new BindingConvertor<int[],List<UIRepositoryUser>>(){
    @Override public List<UIRepositoryUser> sourceToTarget(    int[] indices){
      List<UIRepositoryUser> userList=new ArrayList<UIRepositoryUser>();
      for (int i=0; i < indices.length; i++) {
        userList.add(aclModel.getAvailableUser(indices[i]));
      }
      return userList;
    }
    @Override public int[] targetToSource(    List<UIRepositoryUser> userList){
      int[] indices=new int[userList.size()];
      int i=0;
      for (      UIRepositoryUser user : userList) {
        indices[i++]=aclModel.getAvailableUserIndex(user);
      }
      return indices;
    }
  }
;
  BindingConvertor<int[],List<UIRepositoryRole>> indexToAvalableRoleConverter=new BindingConvertor<int[],List<UIRepositoryRole>>(){
    @Override public List<UIRepositoryRole> sourceToTarget(    int[] indices){
      List<UIRepositoryRole> roleList=new ArrayList<UIRepositoryRole>();
      for (int i=0; i < indices.length; i++) {
        roleList.add(aclModel.getAvailableRole(indices[i]));
      }
      return roleList;
    }
    @Override public int[] targetToSource(    List<UIRepositoryRole> roleList){
      int[] indices=new int[roleList.size()];
      int i=0;
      for (      UIRepositoryRole role : roleList) {
        indices[i++]=aclModel.getAvailableRoleIndex(role);
      }
      return indices;
    }
  }
;
  BindingConvertor<int[],List<UIRepositoryObjectAcl>> indexToSelectedUserConverter=new BindingConvertor<int[],List<UIRepositoryObjectAcl>>(){
    @Override public List<UIRepositoryObjectAcl> sourceToTarget(    int[] indices){
      List<UIRepositoryObjectAcl> userList=new ArrayList<UIRepositoryObjectAcl>();
      for (int i=0; i < indices.length; i++) {
        userList.add(aclModel.getSelectedUser(indices[i]));
      }
      return userList;
    }
    @Override public int[] targetToSource(    List<UIRepositoryObjectAcl> userList){
      int[] indices=new int[userList.size()];
      int i=0;
      for (      UIRepositoryObjectAcl user : userList) {
        indices[i++]=aclModel.getSelectedUserIndex(user);
      }
      return indices;
    }
  }
;
  BindingConvertor<int[],List<UIRepositoryObjectAcl>> indexToSelctedRoleConverter=new BindingConvertor<int[],List<UIRepositoryObjectAcl>>(){
    @Override public List<UIRepositoryObjectAcl> sourceToTarget(    int[] indices){
      List<UIRepositoryObjectAcl> roleList=new ArrayList<UIRepositoryObjectAcl>();
      for (int i=0; i < indices.length; i++) {
        roleList.add(aclModel.getSelectedRole(indices[i]));
      }
      return roleList;
    }
    @Override public int[] targetToSource(    List<UIRepositoryObjectAcl> roleList){
      int[] indices=new int[roleList.size()];
      int i=0;
      for (      UIRepositoryObjectAcl role : roleList) {
        indices[i++]=aclModel.getSelectedRoleIndex(role);
      }
      return indices;
    }
  }
;
  bf.setBindingType(Binding.Type.BI_DIRECTIONAL);
  bf.createBinding(availableUserList,"selectedIndices",aclModel,"selectedAvailableUsers",indexToAvalableUserConverter);
  bf.createBinding(selectedUserList,"selectedIndices",aclModel,"selectedAssignedUsers",indexToSelectedUserConverter);
  bf.createBinding(availableRoleList,"selectedIndices",aclModel,"selectedAvailableRoles",indexToAvalableRoleConverter);
  bf.createBinding(selectedRoleList,"selectedIndices",aclModel,"selectedAssignedRoles",indexToSelctedRoleConverter);
  BindingConvertor<Integer,Boolean> accumulatorButtonConverter=new BindingConvertor<Integer,Boolean>(){
    @Override public Boolean sourceToTarget(    Integer value){
      if (value != null && value >= 0) {
        return true;
      }
      return false;
    }
    @Override public Integer targetToSource(    Boolean value){
      return null;
    }
  }
;
  bf.setBindingType(Binding.Type.ONE_WAY);
  bf.createBinding(selectedUserList,"selectedIndex",aclModel,"userUnassignmentPossible",accumulatorButtonConverter);
  bf.createBinding(availableUserList,"selectedIndex",aclModel,"userAssignmentPossible",accumulatorButtonConverter);
  bf.createBinding(aclModel,"userUnassignmentPossible",unassignUserButton,"!disabled");
  bf.createBinding(aclModel,"userAssignmentPossible",assignUserButton,"!disabled");
  bf.createBinding(selectedRoleList,"selectedIndex",aclModel,"roleUnassignmentPossible",accumulatorButtonConverter);
  bf.createBinding(availableRoleList,"selectedIndex",aclModel,"roleAssignmentPossible",accumulatorButtonConverter);
  bf.createBinding(aclModel,"roleUnassignmentPossible",unassignRoleButton,"!disabled");
  bf.createBinding(aclModel,"roleAssignmentPossible",assignRoleButton,"!disabled");
  bf.setBindingType(Binding.Type.ONE_WAY);
  securityBinding=bf.createBinding(fileTable,"selectedItems",userRoleList,"elements",new BindingConvertor<List<UIRepositoryObject>,List<UIRepositoryObjectAcl>>(){
    @Override public List<UIRepositoryObjectAcl> sourceToTarget(    List<UIRepositoryObject> ro){
      if (ro == null) {
        return null;
      }
      if (ro.size() <= 0) {
        return null;
      }
      setSelectedRepositoryObject(ro);
      aclModel.getSelectedAcls().setRemoveEnabled(false);
      uncheckAllPermissionBox();
      if (ro.get(0) instanceof UIRepositoryDirectory) {
        UIRepositoryDirectory rd=(UIRepositoryDirectory)ro.get(0);
        try {
          rd.readAcls(aclModel.getSelectedAcls());
          fileFolderLabel.setValue(rd.getName());
          bf.setBindingType(Binding.Type.ONE_WAY);
          bf.createBinding(aclModel.getSelectedAcls(),"acls",userRoleList,"elements");
        }
 catch (        AccessDeniedException ade) {
        }
catch (        Exception e) {
        }
      }
 else       if (ro.get(0) instanceof UIRepositoryContent) {
        try {
          UIRepositoryContent rc=(UIRepositoryContent)ro.get(0);
          fileFolderLabel.setValue(rc.getName());
          rc.readAcls(aclModel.getSelectedAcls());
          bf.setBindingType(Binding.Type.ONE_WAY);
          bf.createBinding(aclModel.getSelectedAcls(),"acls",userRoleList,"elements");
        }
 catch (        AccessDeniedException ade) {
        }
catch (        Exception e) {
        }
      }
      aclDeck.setSelectedIndex(ACL);
      return aclModel.getSelectedAcls().getAcls();
    }
    @Override public List<UIRepositoryObject> targetToSource(    List<UIRepositoryObjectAcl> elements){
      return null;
    }
  }
);
  bf.setBindingType(Binding.Type.BI_DIRECTIONAL);
  bf.createBinding(aclModel.getSelectedAcls(),"entriesInheriting",inheritParentPermissionCheckbox,"checked");
  bf.createBinding(userRoleList,"selectedItems",aclModel.getSelectedAcls(),"selectedAclList",arrayToListConverter);
  bf.setBindingType(Binding.Type.ONE_WAY);
  bf.createBinding(aclModel.getSelectedAcls(),"entriesInheriting",addAclButton,"disabled");
  bf.createBinding(aclModel.getSelectedAcls(),"removeEnabled",removeAclButton,"!disabled");
  bf.createBinding(aclModel.getSelectedAcls(),"removeEnabled",createCheckbox,"!disabled");
  bf.createBinding(aclModel.getSelectedAcls(),"removeEnabled",updateCheckbox,"!disabled");
  bf.createBinding(aclModel.getSelectedAcls(),"removeEnabled",readCheckbox,"!disabled");
  bf.createBinding(aclModel.getSelectedAcls(),"removeEnabled",deleteCheckbox,"!disabled");
  bf.createBinding(aclModel.getSelectedAcls(),"removeEnabled",modifyCheckbox,"!disabled");
  bf.setBindingType(Binding.Type.ONE_WAY);
  bf.createBinding(userRoleList,"selectedItem",this,"recipientChanged");
  bf.createBinding(folderTree,"selectedItems",this,"switchAclDeck");
  aclDeck.setSelectedIndex(NO_ACL);
  try {
    if (securityBinding != null) {
      securityBinding.fireSourceChanged();
    }
  }
 catch (  Exception e) {
    System.out.println(e.getMessage());
    e.printStackTrace();
  }
}
