{
  IRunnableWithProgress op=new IRunnableWithProgress(){
    public void run(    IProgressMonitor monitor) throws InvocationTargetException, InterruptedException {
      LocalVariables.getInstance().createKettleVariables(Thread.currentThread().toString(),parentThread.toString(),true);
      try {
        impact.clear();
        transMeta.analyseImpact(impact,monitor);
        impactHasRun=true;
      }
 catch (      Exception e) {
        impact.clear();
        impactHasRun=false;
        throw new InvocationTargetException(e,Messages.getString("AnalyseImpactProgressDialog.RuntimeError.UnableToAnalyzeImpact.Exception",e.toString()));
      }
    }
  }
;
  try {
    ProgressMonitorDialog pmd=new ProgressMonitorDialog(shell);
    pmd.run(true,true,op);
  }
 catch (  InvocationTargetException e) {
    new ErrorDialog(shell,props,Messages.getString("AnalyseImpactProgressDialog.Dialog.UnableToAnalyzeImpact.Title"),Messages.getString("AnalyseImpactProgressDialog.Dialog.UnableToAnalyzeImpact.Messages"),e);
  }
catch (  InterruptedException e) {
    new ErrorDialog(shell,props,Messages.getString("AnalyseImpactProgressDialog.Dialog.UnableToAnalyzeImpact.Title"),Messages.getString("AnalyseImpactProgressDialog.Dialog.UnableToAnalyzeImpact.Messages"),e);
  }
  return impactHasRun;
}
