{
  try {
    LDAPInputMeta meta=new LDAPInputMeta();
    getInfo(meta);
    DirContext ctx=connectServerLdap(transMeta.environmentSubstitute(meta.getHost()),transMeta.environmentSubstitute(meta.getUserName()),transMeta.environmentSubstitute(meta.getPassword()),transMeta.environmentSubstitute(meta.getPort()));
    if (Const.isEmpty(wSearchBase.getText())) {
      Attributes attrs=ctx.getAttributes("",new String[]{"namingContexts"});
      Attribute attr=attrs.get("namingContexts");
      wSearchBase.setText(attr.get().toString());
    }
    if (ctx != null) {
      MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_INFORMATION);
      mb.setMessage(BaseMessages.getString(PKG,"LDAPInputDialog.Connected.OK") + Const.CR);
      mb.setText(BaseMessages.getString(PKG,"LDAPInputDialog.Connected.Title.Ok"));
      mb.open();
    }
 else {
      MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
      mb.setMessage(BaseMessages.getString(PKG,"LDAPInputDialog.Connected.NOK.DirecttoryContextNull"));
      mb.setText(BaseMessages.getString(PKG,"LDAPInputDialog.Connected.Title.Error"));
      mb.open();
    }
  }
 catch (  Exception e) {
    MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
    mb.setMessage(BaseMessages.getString(PKG,"LDAPInputDialog.Connected.NOK",e.getMessage()));
    mb.setText(BaseMessages.getString(PKG,"LDAPInputDialog.Connected.Title.Error"));
    mb.open();
  }
}
