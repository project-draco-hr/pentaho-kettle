{
  try {
    LDAPInputMeta meta=new LDAPInputMeta();
    getInfo(meta);
    wFields.removeAll();
    String port=transMeta.environmentSubstitute(meta.getPort());
    String hostname=transMeta.environmentSubstitute(meta.getHost());
    String username=transMeta.environmentSubstitute(meta.getUserName());
    String password=transMeta.environmentSubstitute(meta.getPassword());
    String filter=transMeta.environmentSubstitute(meta.getFilterString());
    String searchbase=transMeta.environmentSubstitute(meta.getSearchBase());
    NamingEnumeration<SearchResult> results=null;
    DirContext ctx=connectServerLdap(hostname,username,password,port);
    log.logBasic("Connection","Connected to server [{0}]",hostname);
    log.logBasic("Class","Class name [{0}]",ctx.getClass().getName());
    DirContext schema=ctx.getSchema("");
    if (log.isDetailed())     log.logDetailed("Schema tree root","" + schema.list(""));
    SearchControls controls=new SearchControls();
    controls.setSearchScope(SearchControls.SUBTREE_SCOPE);
    results=ctx.search(searchbase,filter,controls);
    SearchResult searchAttr=(SearchResult)results.next();
    Attributes listattributes=searchAttr.getAttributes();
    NamingEnumeration ne=listattributes.getAll();
    BasicAttribute Attr=null;
    while (ne.hasMore()) {
      Attr=(BasicAttribute)ne.next();
      String fieldName=Attr.getID();
      TableItem item=new TableItem(wFields.table,SWT.NONE);
      item.setText(1,fieldName);
      item.setText(2,fieldName);
      String attributeValue=Attr.getID();
      if (IsDate(attributeValue)) {
        item.setText(3,"Date");
      }
 else       if (IsInteger(attributeValue)) {
        item.setText(3,"Integer");
      }
 else       if (IsNumber(attributeValue)) {
        item.setText(3,"Number");
      }
 else {
        item.setText(3,"String");
      }
    }
    wFields.removeEmptyRows();
    wFields.setRowNums();
    wFields.optWidth(true);
  }
 catch (  KettleException e) {
    new ErrorDialog(shell,Messages.getString("LDAPInputDialog.ErrorGettingColums.DialogTitle"),Messages.getString("LDAPInputDialog.ErrorGettingColums.DialogMessage"),e);
  }
catch (  Exception e) {
    new ErrorDialog(shell,Messages.getString("LDAPInputDialog.ErrorGettingColums.DialogTitle"),Messages.getString("LDAPInputDialog.ErrorGettingColums.DialogMessage"),e);
  }
}
