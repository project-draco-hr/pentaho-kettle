{
  boolean successConnection=true;
  String msgError=null;
  SalesforceConnection connection=null;
  try {
    SalesforceUpdateMeta meta=new SalesforceUpdateMeta();
    getInfo(meta);
    if (!checkUser()) {
      return;
    }
    connection=new SalesforceConnection(log,transMeta.environmentSubstitute(meta.getTargetURL()),transMeta.environmentSubstitute(meta.getUserName()),transMeta.environmentSubstitute(meta.getPassword()));
    connection.connect();
    successConnection=true;
  }
 catch (  Exception e) {
    successConnection=false;
    msgError=e.getMessage();
  }
 finally {
    if (connection != null) {
      try {
        connection.close();
      }
 catch (      Exception e) {
      }
    }
  }
  if (successConnection) {
    MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_INFORMATION);
    mb.setMessage(BaseMessages.getString(PKG,"SalesforceUpdateDialog.Connected.OK",wUserName.getText()) + Const.CR);
    mb.setText(BaseMessages.getString(PKG,"SalesforceUpdateDialog.Connected.Title.Ok"));
    mb.open();
  }
 else {
    new ErrorDialog(shell,BaseMessages.getString(PKG,"SalesforceUpdateDialog.Connected.Title.Error"),BaseMessages.getString(PKG,"SalesforceUpdateDialog.Connected.NOK",wUserName.getText()),new Exception(msgError));
  }
}
