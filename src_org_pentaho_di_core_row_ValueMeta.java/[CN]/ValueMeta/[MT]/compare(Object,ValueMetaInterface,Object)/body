{
  if (getType() == meta2.getType()) {
    if (getStorageType() == meta2.getStorageType())     return compare(data1,data2);
switch (getStorageType()) {
case STORAGE_TYPE_NORMAL:
      return compare(data1,meta2.convertToNormalStorageType(data2));
case STORAGE_TYPE_BINARY_STRING:
    return compare(data1,meta2.convertToBinaryStringStorageType(data2));
case STORAGE_TYPE_INDEXED:
switch (meta2.getStorageType()) {
case STORAGE_TYPE_INDEXED:
    return compare(data1,data2);
case STORAGE_TYPE_NORMAL:
  return -meta2.compare(data2,convertToNormalStorageType(data1));
case STORAGE_TYPE_BINARY_STRING:
return -meta2.compare(data2,convertToBinaryStringStorageType(data1));
default :
throw new KettleValueException(meta2.toStringMeta() + " : Unknown storage type : " + meta2.getStorageType());
}
default :
throw new KettleValueException(toStringMeta() + " : Unknown storage type : " + getStorageType());
}
}
return compare(data1,convertData(meta2,data2));
}
