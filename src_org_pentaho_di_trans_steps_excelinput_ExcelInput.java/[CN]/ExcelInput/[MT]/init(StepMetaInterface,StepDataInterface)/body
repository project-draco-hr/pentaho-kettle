{
  meta=(ExcelInputMeta)smi;
  data=(ExcelInputData)sdi;
  if (super.init(smi,sdi)) {
    initErrorHandling();
    initReplayFactory();
    data.files=meta.getFileList(this);
    if (data.files.nrOfFiles() == 0 && data.files.nrOfMissingFiles() == 0 && !meta.isAcceptingFilenames()) {
      logError("No file(s) specified! Stop processing.");
      return false;
    }
    if (meta.getEmptyFields().size() > 0) {
      data.maxfilelength=-1;
      for (Iterator iter=data.files.getFiles().iterator(); iter.hasNext(); ) {
        FileObject file=(FileObject)iter.next();
        String name=KettleVFS.getFilename(file);
        if (name.length() > data.maxfilelength)         data.maxfilelength=name.length();
      }
      data.maxsheetlength=-1;
      for (int i=0; i < meta.getSheetName().length; i++)       if (meta.getSheetName()[i].length() > data.maxsheetlength)       data.maxsheetlength=meta.getSheetName()[i].length();
      return true;
    }
 else {
      logError("No input fields defined!");
    }
  }
  return false;
}
