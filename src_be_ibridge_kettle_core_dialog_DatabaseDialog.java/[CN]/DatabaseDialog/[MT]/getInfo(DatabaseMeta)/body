{
  databaseMeta.getAttributes().clear();
  databaseMeta.setName(wConn.getText());
  String contype[]=wConnType.getSelection();
  if (contype.length > 0) {
    databaseMeta.setDatabaseType(contype[0]);
  }
  String acctype[]=wConnAcc.getSelection();
  if (acctype.length > 0) {
    databaseMeta.setAccessType(DatabaseMeta.getAccessType(acctype[0]));
  }
  databaseMeta.setHostname(wHostName.getText());
  databaseMeta.setDBName(wDBName.getText());
  databaseMeta.setDBPort(wPort.getText());
  databaseMeta.setUsername(wUsername.getText());
  databaseMeta.setPassword(wPassword.getText());
  databaseMeta.setServername(wServername.getText());
  databaseMeta.setDataTablespace(wData.getText());
  databaseMeta.setIndexTablespace(wIndex.getText());
  databaseMeta.getAttributes().put(SAPR3DatabaseMeta.ATTRIBUTE_SAP_LANGUAGE,wSAPLanguage.getText());
  databaseMeta.getAttributes().put(SAPR3DatabaseMeta.ATTRIBUTE_SAP_SYSTEM_NUMBER,wSAPSystemNumber.getText());
  databaseMeta.getAttributes().put(SAPR3DatabaseMeta.ATTRIBUTE_SAP_CLIENT,wSAPClient.getText());
  databaseMeta.getAttributes().put(GenericDatabaseMeta.ATRRIBUTE_CUSTOM_URL,wURL.getText());
  databaseMeta.getAttributes().put(GenericDatabaseMeta.ATRRIBUTE_CUSTOM_DRIVER_CLASS,wDriverClass.getText());
  String[] remarks=databaseMeta.checkParameters();
  if (remarks.length != 0) {
    String message="";
    for (int i=0; i < remarks.length; i++)     message+="    * " + remarks[i] + Const.CR;
    throw new KettleException("Incorrect database parameter(s)!  Check these settings :" + Const.CR + message);
  }
  for (int i=0; i < wOptions.nrNonEmpty(); i++) {
    TableItem item=wOptions.getNonEmpty(i);
    String dbTypeStr=item.getText(1);
    String parameter=item.getText(2);
    String value=item.getText(3);
    int dbType=DatabaseMeta.getDatabaseType(dbTypeStr);
    if (!Const.isEmpty(parameter) && dbType != DatabaseMeta.TYPE_DATABASE_NONE) {
      if (Const.isEmpty(value))       value=DatabaseMeta.EMPTY_OPTIONS_STRING;
      String typedParameter=BaseDatabaseMeta.ATTRIBUTE_PREFIX_EXTRA_OPTION + DatabaseMeta.getDatabaseTypeCode(dbType) + "."+ parameter;
      databaseMeta.getAttributes().put(typedParameter,value);
    }
  }
  databaseMeta.setConnectSQL(wSQL.getText());
  databaseMeta.setUsingConnectionPool(wUsePool.getSelection());
  databaseMeta.setInitialPoolSize(Const.toInt(wInitPool.getText(),ConnectionPoolUtil.defaultInitialNrOfConnections));
  databaseMeta.setMaximumPoolSize(Const.toInt(wMaxPool.getText(),ConnectionPoolUtil.defaultMaximumNrOfConnections));
}
