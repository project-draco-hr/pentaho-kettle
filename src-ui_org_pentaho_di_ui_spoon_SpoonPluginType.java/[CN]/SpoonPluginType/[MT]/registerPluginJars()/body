{
  List<JarFileAnnotationPlugin> jarFilePlugins=findAnnotatedClassFiles(SpoonPlugin.class.getName());
  for (  JarFileAnnotationPlugin jarFilePlugin : jarFilePlugins) {
    System.out.println("found spoonPlugin in :" + jarFilePlugin.getPluginFolder());
    URLClassLoader urlClassLoader=new URLClassLoader(new URL[]{jarFilePlugin.getJarFile()},getClass().getClassLoader());
    try {
      Class<?> clazz=urlClassLoader.loadClass(jarFilePlugin.getClassFile().getName());
      SpoonPlugin partitioner=clazz.getAnnotation(SpoonPlugin.class);
      List<String> libraries=new ArrayList<String>();
      File f=new File(jarFilePlugin.getJarFile().getFile());
      File parent=f.getParentFile();
      for (      File fil : parent.listFiles()) {
        try {
          libraries.add(fil.toURI().toURL().getFile());
        }
 catch (        MalformedURLException e) {
          e.printStackTrace();
        }
      }
      File libDir=new File(parent.toString() + File.separator + "lib");
      ;
      if (libDir.exists()) {
        for (        File fil : libDir.listFiles()) {
          if (fil.getName().indexOf(".jar") > 0) {
            try {
              libraries.add(fil.toURI().toURL().getFile());
            }
 catch (            MalformedURLException e) {
              e.printStackTrace();
            }
          }
        }
      }
      handleAnnotation(clazz,partitioner,libraries,false,jarFilePlugin.getPluginFolder());
    }
 catch (    ClassNotFoundException e) {
    }
  }
}
