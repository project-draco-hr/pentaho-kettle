{
  server=new Server();
  server.addUserRealm(userRealm);
  Constraint constraint=new Constraint();
  constraint.setName(Constraint.__BASIC_AUTH);
  ;
  constraint.setRoles(new String[]{Constraint.ANY_ROLE});
  constraint.setAuthenticate(true);
  ConstraintMapping constraintMapping=new ConstraintMapping();
  constraintMapping.setConstraint(constraint);
  constraintMapping.setPathSpec("/*");
  SecurityHandler securityHandler=new SecurityHandler();
  securityHandler.setUserRealm(userRealm);
  securityHandler.setConstraintMappings(new ConstraintMapping[]{constraintMapping});
  HandlerCollection handlers=new HandlerCollection();
  ServletHandler addTrans=new ServletHandler();
  addTrans.addServletWithMapping(new ServletHolder(new AddTransServlet(transformationMap)),AddTransServlet.CONTEXT_PATH);
  ContextHandler rootHandler=new ContextHandler(GetRootHandler.CONTEXT_PATH);
  rootHandler.setHandler(new GetRootHandler());
  ContextHandler getStatus=new ContextHandler(GetStatusHandler.CONTEXT_PATH);
  getStatus.addHandler(new GetStatusHandler(transformationMap));
  ContextHandler getTransStatus=new ContextHandler(GetTransStatusHandler.CONTEXT_PATH);
  getTransStatus.addHandler(new GetTransStatusHandler(transformationMap));
  ContextHandler startTrans=new ContextHandler(StartTransHandler.CONTEXT_PATH);
  startTrans.addHandler(new StartTransHandler(transformationMap));
  ContextHandler stopTrans=new ContextHandler(StopTransHandler.CONTEXT_PATH);
  stopTrans.addHandler(new StopTransHandler(transformationMap));
  ContextHandler prepareExecution=new ContextHandler(PrepareExecutionTransHandler.CONTEXT_PATH);
  prepareExecution.addHandler(new PrepareExecutionTransHandler(transformationMap));
  ContextHandler startExecution=new ContextHandler(StartExecutionTransHandler.CONTEXT_PATH);
  startExecution.addHandler(new StartExecutionTransHandler(transformationMap));
  handlers.setHandlers(new Handler[]{securityHandler,rootHandler,getStatus,getTransStatus,startTrans,stopTrans,prepareExecution,startExecution});
  HandlerCollection servlets=new HandlerCollection();
  servlets.setHandlers(new Handler[]{securityHandler,addTrans});
  HandlerCollection allHandlers=new HandlerCollection();
  allHandlers.setHandlers(new Handler[]{handlers,servlets});
  server.setHandler(allHandlers);
  createListeners();
  server.start();
  server.join();
}
