{
  this.filename=filename;
  this.encoding=encoding;
  try {
    FileObject fileObject=KettleVFS.getFileObject(filename);
    if (fileObject instanceof LocalFile) {
      String localFilename=KettleVFS.getFilename(fileObject);
      workbook=org.apache.poi.ss.usermodel.WorkbookFactory.create(new File(localFilename));
    }
 else {
      workbook=org.apache.poi.ss.usermodel.WorkbookFactory.create(KettleVFS.getInputStream(filename));
    }
  }
 catch (  Exception e) {
    throw new KettleException(e);
  }
}
