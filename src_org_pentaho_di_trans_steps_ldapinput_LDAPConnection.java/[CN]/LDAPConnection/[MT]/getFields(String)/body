{
  try {
    search(searchBase,null,0,null);
    Attributes attributes=getAttributes();
    NamingEnumeration<? extends Attribute> ne=attributes.getAll();
    RowMeta fields=new RowMeta();
    Attribute attr=null;
    while (ne.hasMore()) {
      attr=ne.next();
      ValueMetaInterface value=new ValueMeta(attr.getID());
      String attributeValue=attr.getID();
      if (IsDate(attributeValue)) {
        value.setType(ValueMeta.TYPE_DATE);
      }
 else       if (IsInteger(attributeValue)) {
        value.setType(ValueMeta.TYPE_INTEGER);
      }
 else       if (IsNumber(attributeValue)) {
        value.setType(ValueMeta.TYPE_NUMBER);
      }
 else {
        value.setType(ValueMeta.TYPE_STRING);
      }
      fields.addValueMeta(value);
    }
    return fields;
  }
 catch (  Exception e) {
    throw new KettleException(BaseMessages.getString(PKG,"LDAPConnection.Error.RetrievingFields"));
  }
}
