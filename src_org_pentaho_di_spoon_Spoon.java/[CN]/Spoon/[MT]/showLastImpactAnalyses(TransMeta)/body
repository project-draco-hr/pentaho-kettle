{
  if (transMeta == null)   return;
  TransGraph spoonGraph=findSpoonGraphOfTransformation(transMeta);
  if (spoonGraph == null)   return;
  ArrayList rows=new ArrayList();
  RowMetaInterface rowMeta=null;
  for (int i=0; i < spoonGraph.getImpact().size(); i++) {
    DatabaseImpact ii=(DatabaseImpact)spoonGraph.getImpact().get(i);
    RowMetaAndData row=ii.getRow();
    rowMeta=row.getRowMeta();
    rows.add(row.getData());
  }
  if (rows.size() > 0) {
    PreviewRowsDialog prd=new PreviewRowsDialog(shell,SWT.NONE,"-",rowMeta,rows);
    prd.setTitleMessage(Messages.getString("Spoon.Dialog.ImpactAnalyses.Title"),Messages.getString("Spoon.Dialog.ImpactAnalyses.Message"));
    prd.open();
  }
 else {
    MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_INFORMATION);
    if (spoonGraph.isImpactFinished()) {
      mb.setMessage(Messages.getString("Spoon.Dialog.TransformationNoImpactOnDatabase.Message"));
    }
 else {
      mb.setMessage(Messages.getString("Spoon.Dialog.RunImpactAnalysesFirst.Message"));
    }
    mb.setText(Messages.getString("Spoon.Dialog.ImpactAnalyses.Title"));
    mb.open();
  }
}
