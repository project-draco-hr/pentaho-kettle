{
  String key=addTransformation(transMeta);
  if (key != null) {
    String tabName=makeTransGraphTabName(transMeta);
    TabItem tabItem=findTabItem(tabName,TabMapEntry.OBJECT_TYPE_TRANSFORMATION_GRAPH);
    if (tabItem == null) {
      TransGraph transGraph=new TransGraph(tabfolder.getSwtTabset(),this,transMeta);
      tabItem=new TabItem(tabfolder,tabName,tabName);
      tabItem.setToolTipText(Messages.getString("Spoon.TabTrans.Tooltip",makeTransGraphTabName(transMeta)));
      tabItem.setImage(GUIResource.getInstance().getImageTransGraph());
      tabItem.setControl(transGraph);
      tabMap.put(tabName,new TabMapEntry(tabItem,tabName,transGraph,TabMapEntry.OBJECT_TYPE_TRANSFORMATION_GRAPH));
    }
    int idx=tabfolder.indexOf(tabItem);
    if (transMeta.getLogConnection() != null && !Const.isEmpty(transMeta.getLogTable())) {
      addTransHistory(transMeta,false);
    }
    tabfolder.setSelected(idx);
    setUndoMenu(transMeta);
    enableMenus();
  }
}
