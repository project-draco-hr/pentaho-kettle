{
  if (dataA == null || dataB == null)   return null;
switch (metaA.getType()) {
case ValueMetaInterface.TYPE_NUMBER:
    return new Double(100.0 * metaA.getNumber(dataA).doubleValue() / metaB.getNumber(dataB).doubleValue());
case ValueMetaInterface.TYPE_INTEGER:
  return new Long(100 * metaA.getInteger(dataA).longValue() / metaB.getInteger(dataB).longValue());
case ValueMetaInterface.TYPE_BIGNUMBER:
return metaA.getBigNumber(dataA).multiply(new BigDecimal(100)).divide(metaB.getBigNumber(dataB),BigDecimal.ROUND_HALF_UP);
default :
throw new KettleValueException("The 'percent1' function only works on numeric data");
}
}
