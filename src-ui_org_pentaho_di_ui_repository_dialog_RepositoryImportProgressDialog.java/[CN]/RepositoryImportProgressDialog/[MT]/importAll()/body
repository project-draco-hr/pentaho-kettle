{
  wLabel.setText(BaseMessages.getString(PKG,"RepositoryImportDialog.ImportXML.Label"));
  try {
    loadSharedObjects();
    RepositoryImportLocation.setRepositoryImportLocation(baseDirectory);
    for (int ii=0; ii < filenames.length; ++ii) {
      final String filename=((fileDirectory != null) && (fileDirectory.length() > 0)) ? fileDirectory + Const.FILE_SEPARATOR + filenames[ii] : filenames[ii];
      if (log.isBasic())       log.logBasic("Import objects from XML file [" + filename + "]");
      addLog(BaseMessages.getString(PKG,"RepositoryImportDialog.WhichFile.Log",filename));
      wLabel.setText(BaseMessages.getString(PKG,"RepositoryImportDialog.WhichDir.Label"));
      askDirectory=false;
      try {
        RepositoryExportSaxParser parser=new RepositoryExportSaxParser(filename);
        parser.parse(this);
      }
 catch (      Exception e) {
        new ErrorDialog(shell,BaseMessages.getString(PKG,"RepositoryImportDialog.ErrorGeneral.Title"),BaseMessages.getString(PKG,"RepositoryImportDialog.ErrorGeneral.Message"),e);
      }
    }
    addLog(BaseMessages.getString(PKG,"RepositoryImportDialog.ImportFinished.Log"));
  }
 catch (  KettleException e) {
    new ErrorDialog(shell,BaseMessages.getString(PKG,"RepositoryImportDialog.ErrorGeneral.Title"),BaseMessages.getString(PKG,"RepositoryImportDialog.ErrorGeneral.Message"),e);
  }
 finally {
    RepositoryImportLocation.setRepositoryImportLocation(null);
  }
}
