{
  String sql="SELECT " + quote(FIELD_KEY_VALUE_KEY) + ", "+ quote(FIELD_KEY_VALUE_VALUE)+ " FROM "+ quoteTable(TABLE_R_KEY_VALUE)+ " WHERE "+ quote(FIELD_KEY_VALUE_NAMESPACE)+ " = ? ";
  RowMetaAndData values=new RowMetaAndData();
  values.addValue(quote(FIELD_KEY_VALUE_NAMESPACE),ValueMetaInterface.TYPE_STRING,namespace);
  List<RepositoryValueInterface> list=new ArrayList<RepositoryValueInterface>();
  ResultSet resultSet=null;
  Database db=connectionDelegate.getDatabase();
  try {
    resultSet=db.openQuery(sql,values.getRowMeta(),values.getData());
    Object[] row=db.getRow(resultSet);
    while (row != null) {
      final String key=db.getReturnRowMeta().getString(row,0);
      final String value=db.getReturnRowMeta().getString(row,1);
      list.add(new RepositoryValueInterface(){
        public String getNamespace(){
          return namespace;
        }
        public String getKey(){
          return key;
        }
        public String getValue(){
          return value;
        }
      }
);
      row=db.getRow(resultSet);
    }
  }
 catch (  Exception e) {
    throw new KettleException("Unable to read key/value entries",e);
  }
 finally {
    if (resultSet != null) {
      connectionDelegate.getDatabase().closeQuery(resultSet);
    }
  }
  return list;
}
