{
  try {
    if (data.file.getType() == FileType.FILE) {
      data.fr=KettleVFS.getInputStream(data.file);
      data.isr=new InputStreamReader(new BufferedInputStream(data.fr,BUFFER_SIZE_INPUT_STREAM));
      int c=0;
      data.lineStringBuffer.setLength(0);
      while (c >= 0) {
        c=data.isr.read();
        if (c == data.separator) {
          data.rownr++;
        }
      }
    }
    if (log.isDetailed())     log.logDetailed(toString(),Messages.getString("GetFilesRowsCount.Log.RowsInFile",data.file.toString(),"" + data.rownr));
  }
 catch (  Exception e) {
    throw new KettleException(e);
  }
}
