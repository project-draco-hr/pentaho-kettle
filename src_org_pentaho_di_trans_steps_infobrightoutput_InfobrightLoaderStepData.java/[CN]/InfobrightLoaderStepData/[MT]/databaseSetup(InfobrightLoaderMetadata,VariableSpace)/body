{
  db=new Database(meta.getDatabaseMeta());
  db.connect();
  requiredRowMeta=meta.getRequiredFields(space);
  requiredFields=requiredRowMeta.getFieldNames();
  try {
    if (meta.getInfobrightProductType() == null) {
      meta.setDataFormat(DataFormat.TXT_VARIABLE);
    }
    DataFormat dataFormat=DataFormat.valueForDisplayName(meta.getInfobrightProductType());
    Connection conn=db.getConnection();
    String tableName=meta.getTablename();
    EtlLogger logger=meta.getLogger();
    loader=new InfobrightNamedPipeLoader(tableName,conn,logger,dataFormat);
    record=loader.createRecord(false);
    loader.start();
  }
 catch (  Exception e) {
    db.disconnect();
    db=null;
    throw new KettleDatabaseException(e);
  }
}
