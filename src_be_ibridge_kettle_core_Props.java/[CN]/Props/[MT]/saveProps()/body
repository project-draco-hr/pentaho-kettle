{
  storeScreens();
  setLastFiles();
  File spoonRc=new File(filename);
  try {
    SortedFileOutputStream fos=new SortedFileOutputStream(spoonRc);
    fos.setLogger(log);
    properties.store(fos,"Kettle Properties file");
    fos.close();
    log.logBasic(toString(),Messages.getString("Spoon.Log.SaveProperties"));
  }
 catch (  IOException e) {
    if (spoonRc.isHidden() && filename.indexOf('\\') != -1) {
      log.logError(toString(),Messages.getString("Spoon.Log.SavePropertiesFailedWindowsBugAttr",filename));
    }
 else {
      log.logError(toString(),Messages.getString("Spoon.Log.SavePropertiesFailed") + e.getMessage());
    }
  }
}
