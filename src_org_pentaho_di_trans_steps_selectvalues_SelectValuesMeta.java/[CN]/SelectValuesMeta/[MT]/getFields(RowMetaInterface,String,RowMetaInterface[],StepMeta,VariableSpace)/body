{
  RowMetaInterface row=null;
  if (selectName != null && selectName.length > 0) {
    row=new RowMeta();
    for (int i=0; i < selectName.length; i++) {
      ValueMetaInterface v=inputRowMeta.searchValueMeta(selectName[i]);
      if (v != null) {
        v=(ValueMetaInterface)v.clone();
        if (!v.getName().equals(selectRename[i]) && selectRename[i] != null && selectRename[i].length() > 0) {
          v.setName(selectRename[i]);
          v.setOrigin(name);
        }
        if (selectLength[i] != -2) {
          v.setLength(selectLength[i]);
          v.setOrigin(name);
        }
        if (selectPrecision[i] != -2) {
          v.setPrecision(selectPrecision[i]);
          v.setOrigin(name);
        }
        row.addValueMeta(v);
      }
    }
    if (selectingAndSortingUnspecifiedFields) {
      List<String> extra=new ArrayList<String>();
      for (int i=0; i < inputRowMeta.size(); i++) {
        String fieldName=inputRowMeta.getValueMeta(i).getName();
        if (row.indexOfValue(fieldName) < 0) {
          extra.add(fieldName);
        }
      }
      Collections.sort(extra);
      for (      String fieldName : extra) {
        ValueMetaInterface extraValue=inputRowMeta.searchValueMeta(fieldName);
        row.addValueMeta(extraValue);
      }
    }
    inputRowMeta.clear();
    inputRowMeta.addRowMeta(row);
  }
  if (deleteName != null && deleteName.length > 0) {
    for (int i=0; i < deleteName.length; i++) {
      try {
        inputRowMeta.removeValueMeta(deleteName[i]);
      }
 catch (      KettleValueException e) {
        throw new KettleStepException(e);
      }
    }
  }
  if (metaName != null && metaName.length > 0) {
    for (int i=0; i < metaName.length; i++) {
      int idx=inputRowMeta.indexOfValue(metaName[i]);
      if (idx >= 0) {
        ValueMetaInterface v=inputRowMeta.getValueMeta(idx);
        if (!v.getName().equals(metaRename[i]) && metaRename[i] != null && metaRename[i].length() > 0) {
          v.setName(metaRename[i]);
          v.setOrigin(name);
        }
        if (metaType[i] != ValueMetaInterface.TYPE_NONE) {
          v.setType(metaType[i]);
        }
        if (metaLength[i] != -2) {
          v.setLength(metaLength[i]);
          v.setOrigin(name);
        }
        if (metaPrecision[i] != -2) {
          v.setPrecision(metaPrecision[i]);
          v.setOrigin(name);
        }
      }
    }
  }
}
