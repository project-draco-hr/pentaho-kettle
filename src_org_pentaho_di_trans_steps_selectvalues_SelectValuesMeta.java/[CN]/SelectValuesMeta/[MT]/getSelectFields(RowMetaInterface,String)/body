{
  RowMetaInterface row;
  if (selectName != null && selectName.length > 0) {
    row=new RowMeta();
    for (int i=0; i < selectName.length; i++) {
      ValueMetaInterface v=inputRowMeta.searchValueMeta(selectName[i]);
      if (v != null) {
        v=v.clone();
        if (!v.getName().equals(selectRename[i]) && selectRename[i] != null && selectRename[i].length() > 0) {
          v.setName(selectRename[i]);
          v.setOrigin(name);
        }
        if (selectLength[i] != -2) {
          v.setLength(selectLength[i]);
          v.setOrigin(name);
        }
        if (selectPrecision[i] != -2) {
          v.setPrecision(selectPrecision[i]);
          v.setOrigin(name);
        }
        row.addValueMeta(v);
      }
    }
    if (selectingAndSortingUnspecifiedFields) {
      List<String> extra=new ArrayList<String>();
      for (int i=0; i < inputRowMeta.size(); i++) {
        String fieldName=inputRowMeta.getValueMeta(i).getName();
        if (Const.indexOfString(fieldName,selectName) < 0) {
          extra.add(fieldName);
        }
      }
      Collections.sort(extra);
      for (      String fieldName : extra) {
        ValueMetaInterface extraValue=inputRowMeta.searchValueMeta(fieldName);
        row.addValueMeta(extraValue);
      }
    }
    inputRowMeta.clear();
    inputRowMeta.addRowMeta(row);
  }
}
