{
  AccessOutputMeta meta=new AccessOutputMeta();
  getInfo(meta);
  Database database=null;
  try {
    String realFilename=StringUtil.environmentSubstitute(meta.getFilename());
    File file=new File(realFilename);
    if (!file.exists() || !file.isFile()) {
      throw new KettleException(Messages.getString("AccessOutputMeta.Exception.FileDoesNotExist",realFilename));
    }
    database=Database.open(file);
    Set set=database.getTableNames();
    String[] tablenames=(String[])set.toArray(new String[set.size()]);
    EnterSelectionDialog dialog=new EnterSelectionDialog(shell,tablenames,Messages.getString("AccessOutputDialog.Dialog.SelectATable.Title"),Messages.getString("AccessOutputDialog.Dialog.SelectATable.Message"));
    String tablename=dialog.open();
    if (tablename != null) {
      wTablename.setText(tablename);
    }
  }
 catch (  Throwable e) {
    new ErrorDialog(shell,Messages.getString("AccessOutputDialog.UnableToGetListOfTables.Title"),Messages.getString("AccessOutputDialog.UnableToGetListOfTables.Message"),new Exception(e));
  }
 finally {
    try {
      if (database != null)       database.close();
    }
 catch (    Exception e) {
    }
  }
}
