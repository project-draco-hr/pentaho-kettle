{
  if (StringUtils.isEmpty(webAppName)) {
    client.getState().setCredentials(new AuthScope(environmentSubstitute(hostname),Const.toInt(environmentSubstitute(port),80),"Kettle"),new UsernamePasswordCredentials(environmentSubstitute(username),Encr.decryptPasswordOptionallyEncrypted(environmentSubstitute(password))));
  }
 else {
    Credentials creds=new UsernamePasswordCredentials(environmentSubstitute(username),Encr.decryptPasswordOptionallyEncrypted(environmentSubstitute(password)));
    client.getState().setCredentials(AuthScope.ANY,creds);
    client.getParams().setAuthenticationPreemptive(true);
  }
}
