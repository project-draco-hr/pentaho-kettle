{
  Row row;
  if (data.document == null) {
    data.filename=null;
  }
 else   if (!data.document.hasNext()) {
    data.filename=null;
  }
  if (data.filename == null) {
    if (!openNextFile()) {
      return null;
    }
  }
  row=data.document.getNext();
  if (meta.includeFilename() && meta.getFilenameField() != null && meta.getFilenameField().length() > 0) {
    Value fn=new Value(meta.getFilenameField(),data.filename);
    row.addValue(fn);
  }
  if (meta.includeRowNumber() && meta.getRowNumberField() != null && meta.getRowNumberField().length() > 0) {
    Value fn=new Value(meta.getRowNumberField(),data.rownr);
    row.addValue(fn);
  }
  data.previousRow=new Row(row);
  data.rownr++;
  return row;
}
