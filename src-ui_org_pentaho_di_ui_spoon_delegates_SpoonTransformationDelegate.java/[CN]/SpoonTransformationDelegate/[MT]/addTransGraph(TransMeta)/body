{
  String key=addTransformation(transMeta);
  if (key != null) {
    String tabName=spoon.delegates.tabs.makeTransGraphTabName(transMeta);
    TabItem tabItem=spoon.delegates.tabs.findTabItem(tabName,ObjectType.TRANSFORMATION_GRAPH);
    if (tabItem == null) {
      TransGraph transGraph=new TransGraph(spoon.tabfolder.getSwtTabset(),spoon,transMeta);
      tabItem=new TabItem(spoon.tabfolder,tabName,tabName);
      String toolTipText=BaseMessages.getString(PKG,"Spoon.TabTrans.Tooltip",spoon.delegates.tabs.makeTransGraphTabName(transMeta));
      if (!Const.isEmpty(transMeta.getFilename()))       toolTipText+=Const.CR + Const.CR + transMeta.getFilename();
      tabItem.setToolTipText(toolTipText);
      tabItem.setImage(GUIResource.getInstance().getImageTransGraph());
      tabItem.setControl(transGraph);
      if (transMeta.getLogConnection() != null && !Const.isEmpty(transMeta.getLogTable()) && !transMeta.isSlaveTransformation()) {
        transGraph.addAllTabs();
        transGraph.extraViewTabFolder.setSelection(transGraph.transHistoryDelegate.getTransHistoryTab());
      }
      String versionLabel=transMeta.getObjectVersion() == null ? null : transMeta.getObjectVersion().getName();
      spoon.delegates.tabs.addTab(new TabMapEntry(tabItem,transMeta.getFilename(),transMeta.getName(),transMeta.getRepositoryDirectory(),versionLabel,transGraph,ObjectType.TRANSFORMATION_GRAPH));
    }
    int idx=spoon.tabfolder.indexOf(tabItem);
    spoon.tabfolder.setSelected(idx);
    spoon.setUndoMenu(transMeta);
    spoon.enableMenus();
  }
}
