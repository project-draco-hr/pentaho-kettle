{
  try {
    final TransSplitter transSplitter=new TransSplitter(transMeta);
    transSplitter.splitOriginalTransformation();
    TransMeta master=transSplitter.getMaster();
    SlaveServer masterServer=null;
    List<StepMeta> masterSteps=master.getTransHopSteps(false);
    SlaveServer slaves[]=transSplitter.getSlaveTargets();
    if (executionConfiguration.isClusterShowingTransformation()) {
      if (masterSteps.size() > 0) {
        masterServer=transSplitter.getMasterServer();
        addTransGraph(master);
      }
      for (int i=0; i < slaves.length; i++) {
        TransMeta slaveTrans=(TransMeta)transSplitter.getSlaveTransMap().get(slaves[i]);
        addTransGraph(slaveTrans);
      }
    }
    Trans.executeClustered(transSplitter,executionConfiguration);
    if (executionConfiguration.isClusterPosting()) {
      if (masterServer != null) {
        spoon.addSpoonSlave(masterServer);
        for (int i=0; i < slaves.length; i++) {
          spoon.addSpoonSlave(slaves[i]);
        }
      }
    }
    new Thread(new Runnable(){
      public void run(){
        Trans.monitorClusteredTransformation(transMeta.toString(),transSplitter,null);
        Result result=Trans.getClusteredTransformationResult(transMeta.toString(),transSplitter,null);
        LogWriter log=LogWriter.getInstance();
        log.logBasic(transMeta.toString(),"-----------------------------------------------------");
        log.logBasic(transMeta.toString(),"Got result back from clustered transformation:");
        log.logBasic(transMeta.toString(),"-----------------------------------------------------");
        log.logBasic(transMeta.toString(),"Errors : " + result.getNrErrors());
        log.logBasic(transMeta.toString(),"Input : " + result.getNrLinesInput());
        log.logBasic(transMeta.toString(),"Output : " + result.getNrLinesOutput());
        log.logBasic(transMeta.toString(),"Updated : " + result.getNrLinesUpdated());
        log.logBasic(transMeta.toString(),"Read : " + result.getNrLinesRead());
        log.logBasic(transMeta.toString(),"Written : " + result.getNrLinesWritten());
        log.logBasic(transMeta.toString(),"Rejected : " + result.getNrLinesRejected());
        log.logBasic(transMeta.toString(),"-----------------------------------------------------");
      }
    }
).start();
  }
 catch (  Exception e) {
    throw new KettleException(e);
  }
}
