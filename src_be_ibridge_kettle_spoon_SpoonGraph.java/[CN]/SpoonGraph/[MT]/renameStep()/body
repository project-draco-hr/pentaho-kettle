{
  StepMeta[] selection=spoon.getTransMeta().getSelectedSteps();
  if (selection != null && selection.length == 1) {
    final StepMeta stepMeta=selection[0];
    String name=stepMeta.getName();
    Point stepLocation=stepMeta.getLocation();
    Point realStepLocation=real2screen(stepLocation.x,stepLocation.y);
    GC gc=new GC(shell.getDisplay());
    gc.setFont(GUIResource.getInstance().getFontGraph());
    Point namePosition=TransPainter.getNamePosition(gc,name,realStepLocation,iconsize);
    int width=gc.textExtent(name).x + 30;
    gc.dispose();
    final Text text=new Text(this,SWT.SINGLE | SWT.BORDER);
    text.setText(name);
    FormData fdText=new FormData();
    fdText.left=new FormAttachment(0,namePosition.x);
    fdText.right=new FormAttachment(0,namePosition.x + width);
    fdText.top=new FormAttachment(0,namePosition.y);
    text.setLayoutData(fdText);
    KeyListener lsKeyText=new KeyAdapter(){
      public void keyPressed(      KeyEvent e){
        if (e.character == SWT.CR) {
          String newName=text.getText();
          text.dispose();
          renameStep(stepMeta,newName);
        }
        if (e.keyCode == SWT.ESC) {
          text.dispose();
        }
      }
    }
;
    text.addKeyListener(lsKeyText);
    text.addFocusListener(new FocusAdapter(){
      public void focusLost(      FocusEvent e){
        String newName=text.getText();
        text.dispose();
        renameStep(stepMeta,newName);
      }
    }
);
    this.layout(true,true);
    text.setFocus();
    text.setSelection(0,name.length());
  }
}
