{
  Row row;
  int i;
  int fieldnrs[];
  Value values[];
  if (r == null)   row=new Row();
 else   row=r;
  fieldnrs=new int[fieldName.length];
  values=new Value[fieldName.length];
  for (i=0; i < fieldName.length; i++) {
    fieldnrs[i]=row.searchValueIndex(fieldName[i]);
    Value v=row.getValue(fieldnrs[i]);
    values[i]=new Value(v);
switch (aggregateType[i]) {
case TYPE_AGGREGATE_AVERAGE:
case TYPE_AGGREGATE_COUNT:
case TYPE_AGGREGATE_SUM:
      values[i].setType(Value.VALUE_TYPE_NUMBER);
    values[i].setLength(-1,-1);
  break;
}
}
row.clear();
for (i=0; i < fieldName.length; i++) {
Value v=values[i];
v.setName(fieldNewName[i]);
v.setOrigin(name);
row.addValue(v);
}
return row;
}
