{
  data.bufferList.add(row);
  if (data.bufferList.size() > 5000) {
    if (data.rowsOnFile == 0) {
      try {
        data.tempFile=File.createTempFile(meta.getPrefix(),".tmp",new File(environmentSubstitute(meta.getDirectory())));
        data.fos=new FileOutputStream(data.tempFile);
        data.dos=new DataOutputStream(data.fos);
        data.firstRead=true;
      }
 catch (      IOException e) {
        throw new KettleFileException(Messages.getString("GroupBy.Exception.UnableToCreateTemporaryFile"),e);
      }
    }
    Object[] oldest=(Object[])data.bufferList.get(0);
    data.previousMeta.writeData(data.dos,oldest);
    data.bufferList.remove(0);
    data.rowsOnFile++;
  }
}
