{
  String resourceName=null;
  try {
    FileObject fileObject=KettleVFS.getFileObject(getFilename());
    resourceName=namingInterface.nameResource(fileObject.getName().getBaseName(),fileObject.getParent().getName().getPath(),"kjb");
    ResourceDefinition definition=definitions.get(resourceName);
    if (definition == null) {
      JobMeta jobMeta=(JobMeta)this.realClone(false);
      for (      JobEntryCopy jobEntry : jobMeta.jobcopies) {
        jobEntry.getEntry().exportResources(jobMeta,definitions,namingInterface);
      }
      String jobMetaContent=jobMeta.getXML();
      definition=new ResourceDefinition(resourceName,jobMetaContent);
      definitions.put(fileObject.getName().getPath(),definition);
    }
  }
 catch (  FileSystemException e) {
    throw new KettleException(Messages.getString("JobMeta.Exception.AnErrorOccuredReadingJob",getFilename()),e);
  }
catch (  IOException e) {
    throw new KettleException(Messages.getString("JobMeta.Exception.AnErrorOccuredReadingJob",getFilename()),e);
  }
  return resourceName;
}
