{
  if (rowsWritten >= rowLimit) {
    AgileMartUtil util=new AgileMartUtil();
    util.updateMetadata(getMeta(),rowsWritten);
    throw new MonetDBRowLimitException("Row limit exceeded");
  }
  MonetDBBulkLoaderData data=getData();
  if (bufferLimit == data.bufferIndex || log.isDebug()) {
    writeBufferToMonetDB();
    if ((rowLimit - rowsWritten) < bufferLimit) {
      bufferLimit=rowLimit - rowsWritten;
    }
    if (rowsWritten >= rowLimit) {
      throw new MonetDBRowLimitException("Row limit exceeded");
    }
  }
  addRowToBuffer(rowMeta,r);
  rowsWritten++;
}
