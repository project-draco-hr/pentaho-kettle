{
  return new SelectionAdapter(){
    public void widgetSelected(    SelectionEvent e){
      Properties sp=new Properties();
      sp.putAll(kettleVariables.getProperties());
      sp.putAll(System.getProperties());
      ArrayList keys=new ArrayList(sp.keySet());
      Collections.sort(keys);
      int size=keys.size();
      String key[]=new String[size];
      String val[]=new String[size];
      String str[]=new String[size];
      for (int i=0; i < keys.size(); i++) {
        key[i]=(String)keys.get(i);
        val[i]=sp.getProperty(key[i]);
        str[i]=key[i] + "  [" + val[i]+ "]";
      }
      EnterSelectionDialog esd=new EnterSelectionDialog(composite.getShell(),str,Messages.getString("System.Dialog.SelectEnvironmentVar.Title"),Messages.getString("System.Dialog.SelectEnvironmentVar.Message"));
      if (esd.open() != null) {
        int nr=esd.getSelectionNr();
        destination.insert("${" + key[nr] + "}");
        destination.setToolTipText(StringUtil.environmentSubstitute(destination.getText()));
      }
    }
  }
;
}
