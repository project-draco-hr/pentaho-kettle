{
  try {
    Object[] params=new Object[]{new JIString(this.hostName),new JIString("ROOT\\CIMV2"),JIVariant.OPTIONAL_PARAM(),JIVariant.OPTIONAL_PARAM(),JIVariant.OPTIONAL_PARAM(),JIVariant.OPTIONAL_PARAM(),new Integer(0),JIVariant.OPTIONAL_PARAM()};
    JIVariant results[]=wbemLocator.callMethodA("ConnectServer",params);
    wbemServices=(IJIDispatch)narrowObject(results[0].getObjectAsComObject());
    results=wbemServices.callMethodA("ExecQuery",new Object[]{new JIString(queryString),JIVariant.OPTIONAL_PARAM(),JIVariant.OPTIONAL_PARAM(),JIVariant.OPTIONAL_PARAM()});
    IJIDispatch wbemObjectSet_dispatch=(IJIDispatch)narrowObject((results[0]).getObjectAsComObject());
    JIVariant variant=wbemObjectSet_dispatch.get("_NewEnum");
    IJIComObject object2=variant.getObjectAsComObject();
    enumVARIANT=(IJIEnumVariant)narrowObject(object2.queryInterface(IJIEnumVariant.IID));
    if (!onlyMeta) {
      JIVariant Count=wbemObjectSet_dispatch.get("Count");
      this.rowsCount=Count.getObjectAsInt();
      if (this.rowLimit > 0 && this.rowsCount > this.rowLimit) {
        this.rowsCount=this.rowLimit;
      }
      if (log.isDetailed()) {
        log.logDetailed(BaseMessages.getString(PKG,"WMIQuery.RowsCount",String.valueOf(this.rowsCount)));
      }
    }
    return this.rowsCount;
  }
 catch (  Exception e) {
    throw new KettleException(e);
  }
}
