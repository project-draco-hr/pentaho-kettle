{
  try {
    JISystem.getLogger().setLevel(Level.OFF);
    JISystem.setAutoRegisteration(true);
    if (Const.isEmpty(getHost())) {
      this.session=JISession.createSession();
    }
 else {
      this.session=JISession.createSession(getDomain(),getUserName(),this.password);
    }
    this.session.useSessionSecurity(true);
    if (log.isDebug()) {
      log.logDebug(BaseMessages.getString(PKG,"WMIQuery.SessionCreated",this.session.getSessionIdentifier()));
    }
    this.comServer=new JIComServer(valueOf("WbemScripting.SWbemLocator"),this.hostName,this.session);
    this.wbemLocator=(IJIDispatch)narrowObject(this.comServer.createInstance().queryInterface(IID));
  }
 catch (  Exception e) {
    throw new KettleException(e);
  }
}
