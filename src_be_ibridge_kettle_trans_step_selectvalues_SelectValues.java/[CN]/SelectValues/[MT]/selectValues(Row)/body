{
  debug=Messages.getString("SelectValues.Debug.StartOfSelectValues");
  if (data.firstselect) {
    debug=Messages.getString("SelectValues.Debug.InitFirst");
    data.firstselect=false;
    data.fieldnrs=new int[meta.getSelectName().length];
    data.values=new Value[meta.getSelectName().length];
    for (int i=0; i < data.fieldnrs.length; i++) {
      data.fieldnrs[i]=row.searchValueIndex(meta.getSelectName()[i]);
      if (data.fieldnrs[i] < 0) {
        logError(Messages.getString("SelectValues.Log.CouldNotFindField",meta.getSelectName()[i]));
        setErrors(1);
        stopAll();
        return false;
      }
    }
    int cnt[]=new int[meta.getSelectName().length];
    for (int i=0; i < meta.getSelectName().length; i++) {
      cnt[i]=0;
      for (int j=0; j < meta.getSelectName().length; j++) {
        String one=Const.NVL(meta.getSelectRename()[i],meta.getSelectName()[i]);
        String two=Const.NVL(meta.getSelectRename()[j],meta.getSelectName()[j]);
        if (one.equals(two))         cnt[i]++;
        if (cnt[i] > 1) {
          logError(Messages.getString("SelectValues.Log.FieldCouldNotSpecifiedMoreThanTwice",one));
          setErrors(1);
          stopAll();
          return false;
        }
      }
    }
  }
  debug=Messages.getString("SelectValues.Debug.GetFieldsValues");
  for (int i=0; i < meta.getSelectName().length; i++) {
    debug=Messages.getString("SelectValues.Debug.GetStartLoop") + i + "]="+ data.fieldnrs[i]+ ")";
    if (data.fieldnrs[i] < row.size()) {
      data.values[i]=row.getValue(data.fieldnrs[i]).Clone();
      if (meta.getSelectRename()[i] != null && meta.getSelectRename()[i].length() > 0) {
        data.values[i].setName(meta.getSelectRename()[i]);
      }
 else {
        data.values[i].setName(meta.getSelectName()[i]);
      }
      if (meta.getSelectLength()[i] != -2)       data.values[i].setLength(meta.getSelectLength()[i]);
      if (meta.getSelectPrecision()[i] != -2)       data.values[i].setPrecision(meta.getSelectPrecision()[i]);
    }
 else {
      if (log.isDetailed())       logDetailed(Messages.getString("SelectValues.Log.MixingStreamWithDifferentFields"));
    }
  }
  debug=Messages.getString("SelectValues.Debug.AddValuesToRow");
  for (int i=0; i < meta.getSelectName().length; i++) {
    if (i >= row.size()) {
      row.addValue(data.values[i]);
    }
 else {
      debug=Messages.getString("SelectValues.Debug.AddValuesToRow2") + i + "] : "+ data.values[i].toStringMeta();
      row.setValue(i,data.values[i]);
    }
  }
  debug=Messages.getString("SelectValues.Debug.RemoveUnusedFields");
  for (int i=row.size() - 1; i >= meta.getSelectName().length; i--) {
    row.removeValue(i);
  }
  debug=Messages.getString("SelectValues.Debug.EndOfSelectedValues");
  return true;
}
