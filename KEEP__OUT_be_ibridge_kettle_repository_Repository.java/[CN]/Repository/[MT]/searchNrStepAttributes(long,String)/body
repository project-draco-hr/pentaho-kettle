{
  int idx=searchStepAttributeIndexInBuffer(id_step,code,0L);
  if (idx < 0)   return 0;
  int nr=1;
  int offset=1;
  if (idx + offset >= stepAttributesBuffer.size()) {
    return 1;
  }
  Row look=(Row)stepAttributesBuffer.get(idx + offset);
  long lookID=look.getValue(0).getInteger();
  String lookCode=look.getValue(1).getString();
  while (lookID == id_step && code.equalsIgnoreCase(lookCode)) {
    nr=(int)look.getValue(2).getInteger() + 1;
    offset++;
    if (idx + offset < stepAttributesBuffer.size()) {
      look=(Row)stepAttributesBuffer.get(idx + offset);
      lookID=look.getValue(0).getInteger();
      lookCode=look.getValue(1).getString();
    }
 else {
      return nr;
    }
  }
  return nr;
}
