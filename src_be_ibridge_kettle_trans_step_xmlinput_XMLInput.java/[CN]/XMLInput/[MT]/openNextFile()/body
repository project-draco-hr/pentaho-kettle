{
  try {
    if (data.filenr >= data.files.length) {
      if (log.isDetailed())       logDetailed(Messages.getString("XMLInput.Log.FinishedProcessing"));
      return false;
    }
    data.last_file=(data.filenr == data.files.length - 1);
    data.filename=data.files[data.filenr];
    logBasic(Messages.getString("XMLInput.Log.OpeningFile",data.filename));
    data.filenr++;
    data.document=XMLHandler.loadXMLFile(data.filename);
    ResultFile resultFile=new ResultFile(ResultFile.FILE_TYPE_GENERAL,KettleVFS.getFileObject(data.filename),getTransMeta().getName(),getStepname());
    resultFile.setComment("File was read by an XML input step");
    addResultFile(resultFile);
    if (log.isDetailed())     logDetailed(Messages.getString("XMLInput.Log.FileOpened",data.filename));
    data.section=data.document;
    for (int i=0; i < meta.getInputPosition().length - 1; i++) {
      data.section=XMLHandler.getSubNode(data.section,meta.getInputPosition()[i]);
    }
    data.itemElement=meta.getInputPosition()[meta.getInputPosition().length - 1];
    data.itemCount=XMLHandler.countNodes(data.section,data.itemElement);
    data.itemPosition=(int)meta.getNrRowsToSkip();
  }
 catch (  Exception e) {
    logError(Messages.getString("XMLInput.Log.UnableToOpenFile","" + data.filenr,data.filename,e.toString()));
    stopAll();
    setErrors(1);
    return false;
  }
  return true;
}
