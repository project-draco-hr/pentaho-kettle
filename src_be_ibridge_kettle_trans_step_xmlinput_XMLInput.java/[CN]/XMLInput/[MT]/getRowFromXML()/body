{
  if (data.filename == null) {
    openNextFile();
    positionInFile();
  }
  Row row=buildEmptyRow();
  Node node=XMLHandler.getSubNodeByNr(data.section,data.itemElement,data.itemPosition);
  data.itemPosition++;
  for (int i=0; i < meta.getInputFields().length; i++) {
    XMLInputField xmlInputField=meta.getInputFields()[i];
    String value=null;
    for (int p=0; (value == null) && p < xmlInputField.getXmlInputFieldPositions().length; p++) {
      XMLInputFieldPosition pos=xmlInputField.getXmlInputFieldPositions()[i];
      if (pos.getType() == XMLInputFieldPosition.XML_ELEMENT) {
        node=XMLHandler.getSubNode(node,pos.getName());
        if (p == xmlInputField.getXmlInputFieldPositions().length - 1) {
          value=XMLHandler.getNodeValue(node);
        }
      }
 else {
        value=XMLHandler.getTagAttribute(node,pos.getName());
      }
    }
    Value v=row.getValue(i);
    v.setValue(value);
  }
  return row;
}
