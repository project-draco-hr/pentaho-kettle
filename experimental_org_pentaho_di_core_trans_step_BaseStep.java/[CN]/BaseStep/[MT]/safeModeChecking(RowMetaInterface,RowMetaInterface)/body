{
  if (referenceRow.size() != row.size()) {
    throw new KettleRowException(Messages.getString("BaseStep.SafeMode.Exception.VaryingSize","" + referenceRow.size(),"" + row.size(),row.toString()));
  }
 else {
    for (int i=0; i < referenceRow.size(); i++) {
      ValueMetaInterface referenceValue=referenceRow.getValueMeta(i);
      ValueMetaInterface compareValue=row.getValueMeta(i);
      if (!referenceValue.getName().equalsIgnoreCase(compareValue.getName())) {
        throw new KettleRowException(Messages.getString("BaseStep.SafeMode.Exception.MixingLayout","" + (i + 1),referenceValue.getName() + " " + referenceValue.toStringMeta(),compareValue.getName() + " " + compareValue.toStringMeta()));
      }
      if (referenceValue.getType() != compareValue.getType()) {
        throw new KettleRowException(Messages.getString("BaseStep.SafeMode.Exception.MixingTypes","" + (i + 1),referenceValue.getName() + " " + referenceValue.toStringMeta(),compareValue.getName() + " " + compareValue.toStringMeta()));
      }
    }
  }
}
