{
  if (previewSize > 0 && previewBuffer.size() < previewSize) {
    try {
      previewBuffer.add(rowMeta.cloneRow(row));
    }
 catch (    KettleValueException e) {
      throw new KettleStepException("Unable to clone row while adding rows to the preview buffer",e);
    }
  }
  for (int i=0; i < rowListeners.size(); i++) {
    RowListener rowListener=(RowListener)rowListeners.get(i);
    rowListener.rowWrittenEvent(rowMeta,row);
  }
  if (terminator && terminator_rows != null) {
    try {
      terminator_rows.add(rowMeta.cloneRow(row));
    }
 catch (    KettleValueException e) {
      throw new KettleStepException("Unable to clone row while adding rows to the terminator buffer",e);
    }
  }
  if (outputRowSets.isEmpty())   return;
  RowSet rs=outputRowSets.get(output_rowset_nr);
  if (stopped.get()) {
    if (log.isDebug())     logDebug(Messages.getString("BaseStep.Log.StopPuttingARow"));
    stopAll();
    return;
  }
  while (!rs.putRow(rowMeta,row) && !isStopped())   nrPutSleeps++;
  linesWritten++;
}
