{
  StepErrorMeta stepErrorMeta=stepMeta.getStepErrorMeta();
  if (stepErrorMeta == null)   return;
  if (stepErrorMeta.getMaxErrors() > 0 && getLinesRejected() > stepErrorMeta.getMaxErrors()) {
    logError(BaseMessages.getString(PKG,"BaseStep.Log.TooManyRejectedRows",Long.toString(stepErrorMeta.getMaxErrors()),Long.toString(getLinesRejected())));
    setErrors(1L);
    stopAll();
  }
  if (stepErrorMeta.getMaxPercentErrors() > 0 && getLinesRejected() > 0 && (stepErrorMeta.getMinPercentRows() <= 0 || getLinesRead() >= stepErrorMeta.getMinPercentRows())) {
    int pct=(int)(100 * getLinesRejected() / getLinesRead());
    if (pct > stepErrorMeta.getMaxPercentErrors()) {
      logError(BaseMessages.getString(PKG,"BaseStep.Log.MaxPercentageRejectedReached",Integer.toString(pct),Long.toString(getLinesRejected()),Long.toString(getLinesRead())));
      setErrors(1L);
      stopAll();
    }
  }
}
