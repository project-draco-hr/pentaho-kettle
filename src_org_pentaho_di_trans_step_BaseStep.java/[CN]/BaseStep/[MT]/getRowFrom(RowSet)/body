{
  Object[] row=rowSet.getRow();
  while (row == null && !rowSet.isDone() && !stopped.get()) {
    row=rowSet.getRow();
  }
  if (stopped.get()) {
    logError(Messages.getString("BaseStep.Log.SleepInterupted3",rowSet.getOriginStepName()));
    stopAll();
    return null;
  }
  if (row == null && rowSet.isDone()) {
    inputRowSets.remove(rowSet);
    return null;
  }
  Object[] rowData=rowSet.getRow();
  RowMetaInterface rowMeta=rowSet.getRowMeta();
  linesRead++;
  for (int i=0; i < rowListeners.size(); i++) {
    RowListener rowListener=(RowListener)rowListeners.get(i);
    rowListener.rowWrittenEvent(rowMeta,rowData);
  }
  return new RowMetaAndData(rowMeta,rowData);
}
