{
  String filename=meta.getControlFile();
  if (Const.isEmpty(filename)) {
    throw new KettleException(BaseMessages.getString(PKG,""));
  }
 else {
    filename=environmentSubstitute(filename).trim();
    if (Const.isEmpty(filename)) {
      throw new KettleException(BaseMessages.getString(PKG,""));
    }
  }
  File controlFile=new File(filename);
  FileWriter fw=null;
  try {
    controlFile.createNewFile();
    fw=new FileWriter(controlFile);
    fw.write(getControlFileContents(meta,getInputRowMeta(),row));
  }
 catch (  IOException ex) {
    throw new KettleException(ex.getMessage(),ex);
  }
 finally {
    try {
      if (fw != null)       fw.close();
    }
 catch (    Exception ex) {
    }
  }
}
