{
  StringBuffer sb=new StringBuffer(300);
  if (meta.getGploadPath() != null) {
    try {
      FileObject fileObject=KettleVFS.getFileObject(environmentSubstitute(meta.getGploadPath()),getTransMeta());
      String psqlexec=KettleVFS.getFilename(fileObject);
      sb.append(psqlexec);
    }
 catch (    Exception ex) {
      throw new KettleException("Error retrieving sqlldr string",ex);
    }
  }
 else {
    throw new KettleException("No psql application specified");
  }
  if (meta.getControlFile() != null) {
    try {
      FileObject fileObject=KettleVFS.getFileObject(environmentSubstitute(meta.getControlFile()),getTransMeta());
      sb.append(" -f ");
      sb.append(KettleVFS.getFilename(fileObject));
    }
 catch (    Exception ex) {
      throw new KettleException("Error retrieving controlfile string",ex);
    }
  }
 else {
    throw new KettleException("No control file specified");
  }
  if (meta.getLogFile() != null) {
    try {
      FileObject fileObject=KettleVFS.getFileObject(environmentSubstitute(meta.getLogFile()),getTransMeta());
      sb.append(" -l ");
      sb.append('\'').append(KettleVFS.getFilename(fileObject)).append('\'');
    }
 catch (    Exception ex) {
      throw new KettleException("Error retrieving logfile string",ex);
    }
  }
  return sb.toString();
}
