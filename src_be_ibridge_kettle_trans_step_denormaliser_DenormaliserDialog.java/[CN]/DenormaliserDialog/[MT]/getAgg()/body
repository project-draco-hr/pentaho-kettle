{
  wGroup.removeEmptyRows();
  final String[] groupingFields=wGroup.getItems(0);
  try {
    Row r=transMeta.getPrevStepFields(stepname);
    if (r != null) {
      BaseStepDialog.getFieldsFromPrevious(r,wTarget,2,new int[]{},new int[]{},-1,-1,new TableItemInsertListener(){
        public boolean tableItemInserted(        TableItem tableItem,        Value v){
          if (Const.indexOfString(v.getName(),groupingFields) < 0) {
            if (!wKeyField.getText().equalsIgnoreCase(v.getName())) {
              int nr=tableItem.getParent().indexOf(tableItem) + 1;
              tableItem.setText(1,Messages.getString("DenormaliserDialog.TargetFieldname.Label") + nr);
              tableItem.setText(2,v.getName());
              tableItem.setText(4,v.getTypeDesc());
              if (v.getLength() >= 0)               tableItem.setText(6,"" + v.getLength());
              if (v.getPrecision() >= 0)               tableItem.setText(7,"" + v.getPrecision());
            }
          }
          return true;
        }
      }
);
    }
  }
 catch (  KettleException ke) {
    new ErrorDialog(shell,Messages.getString("DenormaliserDialog.FailedToGetFields.DialogTitle"),Messages.getString("DenormaliserDialog.FailedToGetFields.DialogMessage"),ke);
  }
}
