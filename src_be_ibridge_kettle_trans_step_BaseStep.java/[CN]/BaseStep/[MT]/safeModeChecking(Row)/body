{
  if (referenceRow == null) {
    referenceRow=new Row(row);
  }
 else {
    if (referenceRow.size() != row.size()) {
      throw new RuntimeException("We detected rows with varying number of fields, this is not allowed in a transformation.  " + "Check your settings. (first row contained " + referenceRow.size() + " elements, this one contains "+ row.size()+ " : "+ row);
    }
 else {
      for (int i=0; i < referenceRow.size(); i++) {
        String referenceName=referenceRow.getValue(i).getName();
        String compareName=row.getValue(i).getName();
        if (!referenceName.equalsIgnoreCase(compareName)) {
          throw new RuntimeException("Field #" + i + " is not the same as the first row received: you're mixing rows with different layout! ("+ referenceName+ "!="+ compareName+ ")");
        }
      }
    }
  }
}
