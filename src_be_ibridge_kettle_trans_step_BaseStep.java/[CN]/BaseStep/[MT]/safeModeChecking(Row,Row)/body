{
  if (referenceRow.size() != row.size()) {
    throw new KettleRowException(Messages.getString("BaseStep.SafeMode.Exception.Varying",Const.CR,"" + referenceRow.size(),"" + row.size(),row.toString()));
  }
 else {
    for (int i=0; i < referenceRow.size(); i++) {
      Value referenceValue=referenceRow.getValue(i);
      Value compareValue=row.getValue(i);
      if (!referenceValue.getName().equalsIgnoreCase(compareValue.getName())) {
        throw new KettleRowException(Messages.getString("BaseStep.SafeMode.Exception.MixingLayout","" + (i + 1),Const.CR,referenceValue.getName() + " " + referenceValue.toStringMeta(),compareValue.getName() + " " + compareValue.toStringMeta()));
      }
      if (referenceValue.getType() != compareValue.getType()) {
        throw new KettleRowException(Messages.getString("BaseStep.SafeMode.Exception.MixingTypes","" + (i + 1),Const.CR,referenceValue.getName() + " " + referenceValue.toStringMeta(),compareValue.getName() + " " + compareValue.toStringMeta()));
      }
    }
  }
}
