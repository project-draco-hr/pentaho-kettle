{
  if (referenceRow.size() != row.size()) {
    throw new KettleRowException("We detected rows with varying number of fields, this is not allowed in a transformation.  " + "Check your settings." + Const.CR + "The first row contained "+ referenceRow.size()+ " fields, this one contains "+ row.size()+ " : "+ row);
  }
 else {
    for (int i=0; i < referenceRow.size(); i++) {
      Value referenceValue=referenceRow.getValue(i);
      Value compareValue=row.getValue(i);
      if (!referenceValue.getName().equalsIgnoreCase(compareValue.getName())) {
        throw new KettleRowException("The name of field #" + (i + 1) + " is not the same as in the first row received: you're mixing rows with different layout!"+ Const.CR+ "Field '"+ referenceValue.getName()+ " "+ referenceValue.toStringMeta()+ "' does not have the same name as field '"+ compareValue.getName()+ " "+ compareValue.toStringMeta()+ "'");
      }
      if (referenceValue.getType() != compareValue.getType()) {
        throw new KettleRowException("The data type of field #" + (i + 1) + " is not the same as the first row received: you're mixing rows with different layout!"+ Const.CR+ "Field '"+ referenceValue.getName()+ " "+ referenceValue.toStringMeta()+ "' does not have the same data type as field '"+ compareValue.getName()+ " "+ compareValue.toStringMeta()+ "'");
      }
    }
  }
}
