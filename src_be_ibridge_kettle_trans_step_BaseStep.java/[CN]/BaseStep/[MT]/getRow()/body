{
  int sleeptime;
  int switches;
  RowSet in=currentInputStream();
  switches=0;
  sleeptime=transMeta.getSleepTimeEmpty();
  while (in.isEmpty() && !stopped) {
    if (in.isDone()) {
      inputRowSets.remove(in_handling);
      if (inputRowSets.size() == 0) {
        return null;
      }
    }
    nextInputStream();
    in=currentInputStream();
    switches++;
    if (switches >= inputRowSets.size()) {
      switches=0;
      try {
        sleep(0,sleeptime);
      }
 catch (      Exception e) {
        logError(Messages.getString("BaseStep.Log.SleepInterupted") + e.toString());
        setErrors(1);
        stopAll();
        return null;
      }
      if (sleeptime < 5000)       sleeptime*=1.2;
 else       sleeptime=5000;
      get_sleeps+=sleeptime;
    }
  }
  if (stopped) {
    logDebug(Messages.getString("BaseStep.Log.StopLookingForMoreRows"));
    stopAll();
    return null;
  }
  in.setPriorityTo(calcGetPriority(in));
  Row row=in.getRow();
  linesRead++;
  for (int i=0; i < rowListeners.size(); i++) {
    RowListener rowListener=(RowListener)rowListeners.get(i);
    rowListener.rowReadEvent(row);
  }
  nextInputStream();
  return row;
}
