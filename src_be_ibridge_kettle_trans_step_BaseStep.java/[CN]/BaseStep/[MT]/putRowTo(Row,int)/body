{
  int sleeptime;
  if (previewSize > 0 && previewBuffer.size() < previewSize) {
    previewBuffer.add(new Row(row));
  }
  for (int i=0; i < rowListeners.size(); i++) {
    RowListener rowListener=(RowListener)rowListeners.get(i);
    rowListener.rowWrittenEvent(row);
  }
  if (terminator && terminator_rows != null) {
    terminator_rows.add(new Row(row));
  }
  if (outputRowSets.size() == 0)   return;
  RowSet rs=(RowSet)outputRowSets.get(output_rowset_nr);
  sleeptime=transMeta.getSleepTimeFull();
  while (rs.isFull() && !stopped) {
    try {
      sleep(sleeptime);
    }
 catch (    Exception e) {
      logError(Messages.getString("BaseStep.Log.ErrorInThreadSleeping") + e.toString());
      setErrors(1);
      stopAll();
      return;
    }
    put_sleeps+=sleeptime;
    if (sleeptime < 500)     sleeptime*=1.2;
 else     sleeptime=500;
  }
  if (stopped) {
    logDebug(Messages.getString("BaseStep.Log.StopPuttingARow"));
    stopAll();
    return;
  }
  rs.putRow(row);
  linesWritten++;
}
