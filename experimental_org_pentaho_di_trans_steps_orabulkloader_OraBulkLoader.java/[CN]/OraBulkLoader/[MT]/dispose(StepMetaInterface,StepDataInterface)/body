{
  meta=(OraBulkLoaderMeta)smi;
  data=(OraBulkLoaderData)sdi;
  super.dispose(smi,sdi);
  if (!preview && meta.isEraseFiles()) {
    FileObject fileObject=null;
    String method=meta.getLoadMethod();
    if (OraBulkLoaderMeta.METHOD_AUTO_END.equals(method)) {
      if (meta.getControlFile() != null) {
        try {
          fileObject=KettleVFS.getFileObject(StringUtil.environmentSubstitute(meta.getControlFile()));
          fileObject.delete();
          fileObject.close();
        }
 catch (        IOException ex) {
          logError("Error deleting control file \'" + KettleVFS.getFilename(fileObject) + "\': "+ ex.getMessage());
        }
      }
    }
    if (OraBulkLoaderMeta.METHOD_AUTO_END.equals(method)) {
      if (meta.getDataFile() != null) {
        try {
          fileObject=KettleVFS.getFileObject(StringUtil.environmentSubstitute(meta.getDataFile()));
          fileObject.delete();
          fileObject.close();
        }
 catch (        IOException ex) {
          logError("Error deleting data file \'" + KettleVFS.getFilename(fileObject) + "\': "+ ex.getMessage());
        }
      }
    }
    if (OraBulkLoaderMeta.METHOD_MANUAL.equals(method)) {
      logBasic("Deletion of files is not compatible with \'manual load method\'");
    }
  }
}
