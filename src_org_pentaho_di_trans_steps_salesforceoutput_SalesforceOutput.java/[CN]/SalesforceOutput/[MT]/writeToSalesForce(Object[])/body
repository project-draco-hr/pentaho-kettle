{
  try {
    if (log.isDetailed())     logDetailed("Called writeToSalesForce with " + data.iBufferPos + " out of "+ meta.getBatchSizeInt());
    if (data.iBufferPos < meta.getBatchSizeInt()) {
      MessageElement[] arNode=new MessageElement[data.nrfields];
      int index=0;
      for (int i=0; i < data.nrfields; i++) {
        arNode[index++]=newMessageElement(meta.getUpdateLookup()[i],rowData[data.fieldnrs[i]]);
      }
      SObject sobjPass=new SObject();
      sobjPass.set_any(arNode);
      sobjPass.setType(data.Module);
      data.sfBuffer[data.iBufferPos]=sobjPass;
      data.outputBuffer[data.iBufferPos]=rowData;
      data.iBufferPos++;
    }
    if (data.iBufferPos >= meta.getBatchSizeInt()) {
      if (log.isDetailed())       logDetailed("Calling flush buffer from writeToSalesForce");
      flushBuffers();
    }
  }
 catch (  Exception e) {
    throw new KettleException("\nFailed in writeToSalesForce: " + e.getMessage());
  }
}
