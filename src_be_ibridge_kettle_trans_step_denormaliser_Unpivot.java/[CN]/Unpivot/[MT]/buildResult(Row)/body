{
  for (int i=data.removeNrs.length - 1; i >= 0; i--) {
    inputRow.removeValue(data.removeNrs[i]);
  }
  for (int i=0; i < data.targetResult.size(); i++) {
    Value resultValue=data.targetResult.getValue(i);
    UnpivotTargetField field=meta.getPivotTargetField()[i];
switch (field.getTargetAggregationType()) {
case UnpivotTargetField.TYPE_AGGR_AVERAGE:
      long count=data.counters[i];
    Value sum=data.sum[i];
  if (count > 0) {
    sum.divide(count);
    resultValue.setValue(sum);
  }
break;
default :
break;
}
inputRow.addValue(resultValue);
}
}
