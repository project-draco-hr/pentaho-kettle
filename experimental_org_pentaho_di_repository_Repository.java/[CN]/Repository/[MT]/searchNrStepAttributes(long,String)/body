{
  int idx=searchStepAttributeIndexInBuffer(id_step,code,0L);
  if (idx < 0)   return 0;
  int nr=1;
  int offset=1;
  if (idx + offset >= stepAttributesBuffer.size()) {
    return 1;
  }
  RowMetaAndData look=(RowMetaAndData)stepAttributesBuffer.get(idx + offset);
  long lookID=look.getInteger(0,-1);
  String lookCode=look.getString(1,null);
  while (lookID == id_step && code.equalsIgnoreCase(lookCode)) {
    nr=(int)look.getInteger(2,0) + 1;
    offset++;
    if (idx + offset < stepAttributesBuffer.size()) {
      look=(RowMetaAndData)stepAttributesBuffer.get(idx + offset);
      lookID=look.getInteger(0,-1);
      lookCode=look.getString(1,null);
    }
 else {
      return nr;
    }
  }
  return nr;
}
