{
  BlockingBatchingRowSet set=new BlockingBatchingRowSet(10);
  RowMetaInterface rm=createRowMetaInterface();
  Object[] r1=new Object[]{new Long(1L)};
  Object[] r2=new Object[]{new Long(2L)};
  Object[] r3=new Object[]{new Long(3L)};
  assertEquals(0,set.size());
  set.putRow(rm,r1);
  assertEquals(1,set.size());
  set.putRow(rm,r2);
  assertEquals(2,set.size());
  Object[] r=set.getRow();
  assertNull(r);
  set.putRow(rm,r3);
  assertEquals(3,set.size());
  set.setDone();
  assertTrue(set.isDone());
  r=set.getRow();
  assertNotNull(r);
  assertEquals(2,set.size());
  assertEquals(r[0],r1[0]);
  r=set.getRow();
  assertNotNull(r);
  assertEquals(1,set.size());
  assertEquals(r[0],r2[0]);
  r=set.getRow();
  assertNotNull(r);
  assertEquals(0,set.size());
  assertEquals(r[0],r3[0]);
}
