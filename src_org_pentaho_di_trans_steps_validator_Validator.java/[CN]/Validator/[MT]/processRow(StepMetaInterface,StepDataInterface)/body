{
  meta=(ValidatorMeta)smi;
  data=(ValidatorData)sdi;
  Object[] r=getRow();
  if (r == null) {
    setOutputDone();
    return false;
  }
  if (first) {
    first=false;
    data.fieldIndexes=new int[meta.getValidations().length];
    for (int i=0; i < meta.getValidations().length; i++) {
      Validation field=meta.getValidations()[i];
      if (!Const.isEmpty(field.getFieldName())) {
        data.fieldIndexes[i]=getInputRowMeta().indexOfValue(field.getFieldName());
        if (data.fieldIndexes[i] < 0) {
          throw new KettleStepException("Unable to find the specified fieldname '" + field.getFieldName() + "' for validation#"+ (i + 1));
        }
      }
 else {
        throw new KettleStepException("There is no name specified for validator field #" + (i + 1));
      }
    }
  }
  if (log.isRowLevel())   log.logRowlevel(toString(),"Read row #" + getLinesRead() + " : "+ getInputRowMeta().getString(r));
  try {
    validateFields(getInputRowMeta(),r);
    putRow(getInputRowMeta(),r);
  }
 catch (  KettleValidatorException e) {
    if (getStepMeta().isDoingErrorHandling()) {
      putError(getInputRowMeta(),r,1,e.getMessage(),e.getFieldname(),e.getCodeDesc());
    }
 else {
      throw new KettleException(e.getMessage(),e);
    }
  }
  if (log.isRowLevel())   log.logRowlevel(toString(),"Wrote row #" + getLinesWritten() + " : "+ getInputRowMeta().getString(r));
  if (checkFeedback(getLinesRead()))   logBasic("Linenr " + getLinesRead());
  return true;
}
