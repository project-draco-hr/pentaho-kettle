{
  Properties props=new Properties();
  String kettlePropsFilename=Const.getKettleDirectory() + Const.FILE_SEPARATOR + fileName;
  InputStream is=null;
  try {
    is=new FileInputStream(kettlePropsFilename);
    props.load(is);
  }
 catch (  IOException ioe) {
    log.logDetailed("Kettle Environment","Unable to read file '" + kettlePropsFilename + "' : "+ ioe.toString());
    log.logDetailed("Kettle Environment",Const.getStackTracker(ioe));
  }
 finally {
    if (is != null)     try {
      is.close();
    }
 catch (    IOException e) {
    }
  }
  return props;
}
