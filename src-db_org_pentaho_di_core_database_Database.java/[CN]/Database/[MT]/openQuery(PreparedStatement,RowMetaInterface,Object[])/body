{
  ResultSet res;
  String debug="Start";
  try {
    debug="OQ Set values";
    setValues(params,data,ps);
    if (canWeSetFetchSize(ps)) {
      debug="OQ Set fetchsize";
      int fs=Const.FETCH_SIZE <= ps.getMaxRows() ? ps.getMaxRows() : Const.FETCH_SIZE;
      if (databaseMeta.getDatabaseInterface() instanceof MySQLDatabaseMeta && databaseMeta.isStreamingResults()) {
        ps.setFetchSize(Integer.MIN_VALUE);
      }
 else {
        ps.setFetchSize(fs);
      }
      debug="OQ Set fetch direction";
      ps.setFetchDirection(ResultSet.FETCH_FORWARD);
    }
    debug="OQ Set max rows";
    if (rowlimit > 0 && databaseMeta.supportsSetMaxRows())     ps.setMaxRows(rowlimit);
    debug="OQ exec query";
    res=ps.executeQuery();
    debug="OQ getRowInfo()";
    rowMeta=getRowInfo(res.getMetaData(),databaseMeta.getDatabaseInterface() instanceof MySQLDatabaseMeta,false);
  }
 catch (  SQLException ex) {
    throw new KettleDatabaseException("ERROR executing query in part[" + debug + "]",ex);
  }
catch (  Exception e) {
    throw new KettleDatabaseException("ERROR executing query in part[" + debug + "]",e);
  }
  return res;
}
