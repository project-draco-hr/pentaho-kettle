{
  long id=getNextDatabaseID();
  long id_database_type=getDatabaseTypeID(type);
  if (id_database_type < 0) {
    id_database_type=getNextDatabaseTypeID();
    String tablename="R_DATABASE_TYPE";
    RowMetaInterface tableMeta=new RowMeta();
    tableMeta.addValueMeta(new ValueMeta("ID_DATABASE_TYPE",ValueMetaInterface.TYPE_INTEGER,5,0));
    tableMeta.addValueMeta(new ValueMeta("CODE",ValueMetaInterface.TYPE_STRING,REP_STRING_CODE_LENGTH,0));
    tableMeta.addValueMeta(new ValueMeta("DESCRIPTION",ValueMetaInterface.TYPE_STRING,REP_STRING_LENGTH,0));
    database.prepareInsert(tableMeta,tablename);
    Object[] tableData=new Object[3];
    int tableIndex=0;
    tableData[tableIndex++]=new Long(id_database_type);
    tableData[tableIndex++]=type;
    tableData[tableIndex++]=type;
    database.setValuesInsert(tableMeta,tableData);
    database.insertRow();
    database.closeInsert();
  }
  long id_database_contype=getDatabaseConTypeID(access);
  RowMetaAndData table=new RowMetaAndData();
  table.addValue(new ValueMeta("ID_DATABASE",ValueMetaInterface.TYPE_INTEGER),new Long(id));
  table.addValue(new ValueMeta("NAME",ValueMetaInterface.TYPE_STRING),name);
  table.addValue(new ValueMeta("ID_DATABASE_TYPE",ValueMetaInterface.TYPE_INTEGER),new Long(id_database_type));
  table.addValue(new ValueMeta("ID_DATABASE_CONTYPE",ValueMetaInterface.TYPE_INTEGER),new Long(id_database_contype));
  table.addValue(new ValueMeta("HOST_NAME",ValueMetaInterface.TYPE_STRING),host);
  table.addValue(new ValueMeta("DATABASE_NAME",ValueMetaInterface.TYPE_STRING),dbname);
  table.addValue(new ValueMeta("PORT",ValueMetaInterface.TYPE_INTEGER),new Long(Const.toInt(port,-1)));
  table.addValue(new ValueMeta("USERNAME",ValueMetaInterface.TYPE_STRING),user);
  table.addValue(new ValueMeta("PASSWORD",ValueMetaInterface.TYPE_STRING),Encr.encryptPasswordIfNotUsingVariables(pass));
  table.addValue(new ValueMeta("SERVERNAME",ValueMetaInterface.TYPE_STRING),servername);
  table.addValue(new ValueMeta("DATA_TBS",ValueMetaInterface.TYPE_STRING),data_tablespace);
  table.addValue(new ValueMeta("INDEX_TBS",ValueMetaInterface.TYPE_STRING),index_tablespace);
  database.prepareInsert(table.getRowMeta(),"R_DATABASE");
  database.setValuesInsert(table);
  database.insertRow();
  database.closeInsert();
  return id;
}
