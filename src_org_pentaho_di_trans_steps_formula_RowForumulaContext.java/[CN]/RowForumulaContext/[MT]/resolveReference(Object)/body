{
  if (name instanceof String) {
    ValueMetaInterface valueMeta;
    Integer idx=(Integer)valueIndexMap.get(name);
    if (idx != null) {
      valueMeta=rowMeta.getValueMeta(idx.intValue());
    }
 else {
      int index=rowMeta.indexOfValue((String)name);
      if (index < 0) {
        ErrorValue errorValue=new DefaultErrorValue((String)name,-1,"Value with name '" + name + "' could not be found in the row.");
        throw new ContextEvaluationException(errorValue);
      }
      valueMeta=rowMeta.getValueMeta(index);
      idx=new Integer(index);
      valueIndexMap.put((String)name,idx);
    }
    Object valueData=rowData[idx];
    try {
      return getPrimitive(valueMeta,valueData);
    }
 catch (    KettleValueException e) {
      ErrorValue errorValue=new DefaultErrorValue(valueMeta.getName(),-1,e.toString());
      throw new ContextEvaluationException(errorValue);
    }
  }
  return null;
}
