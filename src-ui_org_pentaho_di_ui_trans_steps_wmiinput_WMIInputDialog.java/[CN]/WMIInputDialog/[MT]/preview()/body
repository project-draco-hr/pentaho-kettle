{
  WMIInputMeta oneMeta=new WMIInputMeta();
  getInfo(oneMeta,true);
  TransMeta previewMeta=TransPreviewFactory.generatePreviewTransformation(transMeta,oneMeta,wStepname.getText());
  EnterNumberDialog numberDialog=new EnterNumberDialog(shell,props.getDefaultPreviewSize(),BaseMessages.getString(PKG,"WMIInputDialog.EnterPreviewSize"),BaseMessages.getString(PKG,"WMIInputDialog.NumberOfRowsToPreview"));
  int previewSize=numberDialog.open();
  if (previewSize > 0) {
    TransPreviewProgressDialog progressDialog=new TransPreviewProgressDialog(shell,previewMeta,new String[]{wStepname.getText()},new int[]{previewSize});
    progressDialog.open();
    Trans trans=progressDialog.getTrans();
    String loggingText=progressDialog.getLoggingText();
    boolean error=false;
    List<Object[]> rows=null;
    if (!progressDialog.isCancelled()) {
      rows=progressDialog.getPreviewRows(wStepname.getText());
      if (trans.getResult() != null && trans.getResult().getNrErrors() > 0 && rows.size() == 0) {
        error=true;
        EnterTextDialog etd=new EnterTextDialog(shell,BaseMessages.getString(PKG,"System.Dialog.PreviewError.Title"),BaseMessages.getString(PKG,"System.Dialog.PreviewError.Message"),loggingText,true);
        etd.setReadOnly();
        etd.open();
      }
    }
    if (!error) {
      PreviewRowsDialog prd=new PreviewRowsDialog(shell,transMeta,SWT.NONE,wStepname.getText(),progressDialog.getPreviewRowsMeta(wStepname.getText()),progressDialog.getPreviewRows(wStepname.getText()),loggingText);
      prd.open();
    }
  }
}
