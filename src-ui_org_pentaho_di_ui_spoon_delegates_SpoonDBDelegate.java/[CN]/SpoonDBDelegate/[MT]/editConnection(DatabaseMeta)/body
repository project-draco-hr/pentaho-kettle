{
  HasDatabasesInterface hasDatabasesInterface=spoon.getActiveHasDatabasesInterface();
  if (hasDatabasesInterface == null)   return;
  DatabaseMeta before=(DatabaseMeta)databaseMeta.clone();
  XulDatabaseDialog con=new XulDatabaseDialog(spoon.getShell(),databaseMeta);
  con.setDatabases(hasDatabasesInterface.getDatabases());
  String newname=con.open();
  if (!Const.isEmpty(newname)) {
    databaseMeta=con.getDatabaseMeta();
    DatabaseMeta after=(DatabaseMeta)databaseMeta.clone();
    spoon.addUndoChange((UndoInterface)hasDatabasesInterface,new DatabaseMeta[]{before},new DatabaseMeta[]{after},new int[]{hasDatabasesInterface.indexOfDatabase(databaseMeta)});
    saveConnection(databaseMeta);
    spoon.refreshTree();
  }
  spoon.setShellText();
}
