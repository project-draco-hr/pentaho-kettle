{
  DatabaseMeta ci=jobMeta.findDatabase(wLogconnection.getText());
  if (ci != null) {
    RowMetaInterface r=Database.getJobLogrecordFields(false,wBatch.getSelection(),wLogfield.getSelection());
    if (r != null && r.size() > 0) {
      String tablename=wLogtable.getText();
      if (tablename != null && tablename.length() > 0) {
        Database db=new Database(this,ci);
        db.shareVariablesWith(jobMeta);
        try {
          db.connect();
          String createTable=db.getDDL(tablename,r);
          if (!Const.isEmpty(createTable)) {
            SQLEditor sqledit=new SQLEditor(shell,SWT.NONE,ci,null,createTable);
            sqledit.open();
          }
 else {
            MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_INFORMATION);
            mb.setText(BaseMessages.getString(PKG,"JobDialog.NoSqlNedds.DialogTitle"));
            mb.setMessage(BaseMessages.getString(PKG,"JobDialog.NoSqlNedds.DialogMessage"));
            mb.open();
          }
        }
 catch (        KettleDatabaseException dbe) {
          MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
          mb.setMessage(BaseMessages.getString(PKG,"JobDialog.Dialog.ErrorCreatingSQL.Message") + Const.CR + dbe.getMessage());
          mb.setText(BaseMessages.getString(PKG,"JobDialog.Dialog.ErrorCreatingSQL.Title"));
          mb.open();
        }
 finally {
          db.disconnect();
        }
      }
 else {
        MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
        mb.setMessage(BaseMessages.getString(PKG,"JobDialog.Dialog.PleaseEnterALogTable.Message"));
        mb.setText(BaseMessages.getString(PKG,"JobDialog.Dialog.PleaseEnterALogTable.Title"));
        mb.open();
      }
    }
 else {
      MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
      mb.setMessage(BaseMessages.getString(PKG,"JobDialog.Dialog.CouldNotFindFieldsToCreateLogTable.Message"));
      mb.setText(BaseMessages.getString(PKG,"JobDialog.Dialog.CouldNotFindFieldsToCreateLogTable.Title"));
      mb.open();
    }
  }
 else {
    MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
    mb.setMessage(BaseMessages.getString(PKG,"JobDialog.Dialog.SelectCreateValidLogConnection.Message"));
    mb.setText(BaseMessages.getString(PKG,"JobDialog.Dialog.SelectCreateValidLogConnection.Title"));
    mb.open();
  }
}
