{
  LogWriter log=LogWriter.getInstance();
  RowMetaInterface fields=null;
  if (databaseMeta != null) {
    Database db=new Database(databaseMeta);
    databases=new Database[]{db};
    try {
      db.connect();
      String schemaTable=databaseMeta.getQuotedSchemaTableCombination(schemaName,tablename);
      fields=db.getTableFields(schemaTable);
    }
 catch (    KettleDatabaseException dbe) {
      log.logError(toString(),BaseMessages.getString(PKG,"DatabaseLookupMeta.ERROR0004.ErrorGettingTableFields") + dbe.getMessage());
    }
 finally {
      db.disconnect();
    }
  }
  return fields;
}
