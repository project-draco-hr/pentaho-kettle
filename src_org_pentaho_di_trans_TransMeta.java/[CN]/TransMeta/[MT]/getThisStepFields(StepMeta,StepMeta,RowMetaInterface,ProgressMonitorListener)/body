{
  if (log.isDebug())   log.logDebug(toString(),Messages.getString("TransMeta.Log.GettingFieldsFromStep",stepMeta.getName(),stepMeta.getStepID()));
  String name=stepMeta.getName();
  if (monitor != null) {
    monitor.subTask(Messages.getString("TransMeta.Monitor.GettingFieldsFromStepTask.Title",name));
  }
  StepMetaInterface stepint=stepMeta.getStepMetaInterface();
  RowMetaInterface inform[]=null;
  StepMeta[] lu=getInfoStep(stepMeta);
  if (Const.isEmpty(lu)) {
    inform=new RowMetaInterface[]{stepint.getTableFields()};
  }
 else {
    inform=new RowMetaInterface[lu.length];
    for (int i=0; i < lu.length; i++)     inform[i]=getStepFields(lu[i]);
  }
  for (  StepMeta step : steps) {
    if (step.getStepMetaInterface() instanceof MappingMeta) {
      ((MappingMeta)step.getStepMetaInterface()).setRepository(repository);
    }
  }
  stepint.getFields(row,name,inform,nextStep,this);
  return row;
}
