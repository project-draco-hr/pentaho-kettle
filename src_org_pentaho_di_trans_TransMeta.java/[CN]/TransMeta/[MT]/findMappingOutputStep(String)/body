{
  if (!Const.isEmpty(stepname)) {
    StepMeta stepMeta=findStep(stepname);
    if (stepMeta == null) {
      throw new KettleStepException(Messages.getString("TransMeta.Exception.StepNameNotFound",stepname));
    }
    return stepMeta;
  }
 else {
    StepMeta stepMeta=null;
    for (    StepMeta mappingStep : steps) {
      if (mappingStep.getStepID().equals("MappingOutput")) {
        if (stepMeta == null) {
          stepMeta=mappingStep;
        }
 else         if (stepMeta != null) {
          throw new KettleStepException(Messages.getString("TransMeta.Exception.OnlyOneMappingOutputStepAllowed","2"));
        }
      }
    }
    if (stepMeta == null) {
      throw new KettleStepException(Messages.getString("TransMeta.Exception.OneMappingOutputStepRequired"));
    }
    return stepMeta;
  }
}
