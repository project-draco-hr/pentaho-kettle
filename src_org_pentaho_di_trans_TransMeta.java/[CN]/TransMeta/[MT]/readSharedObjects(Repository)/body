{
  if (rep != null) {
    sharedObjectsFile=rep.getTransAttributeString(getId(),0,"SHARED_FILE");
  }
  String soFile=environmentSubstitute(sharedObjectsFile);
  SharedObjects sharedObjects=new SharedObjects(soFile);
  if (sharedObjects.getObjectsMap().isEmpty()) {
    log.logDetailed(toString(),Messages.getString("TransMeta.Log.EmptySharedObjectsFile",soFile));
  }
  for (  SharedObjectInterface object : sharedObjects.getObjectsMap().values()) {
    if (object instanceof DatabaseMeta) {
      DatabaseMeta databaseMeta=(DatabaseMeta)object;
      databaseMeta.shareVariablesWith(this);
      addOrReplaceDatabase(databaseMeta);
    }
 else     if (object instanceof SlaveServer) {
      SlaveServer slaveServer=(SlaveServer)object;
      slaveServer.shareVariablesWith(this);
      addOrReplaceSlaveServer(slaveServer);
    }
 else     if (object instanceof StepMeta) {
      StepMeta stepMeta=(StepMeta)object;
      addOrReplaceStep(stepMeta);
    }
 else     if (object instanceof PartitionSchema) {
      PartitionSchema partitionSchema=(PartitionSchema)object;
      addOrReplacePartitionSchema(partitionSchema);
    }
 else     if (object instanceof ClusterSchema) {
      ClusterSchema clusterSchema=(ClusterSchema)object;
      clusterSchema.shareVariablesWith(this);
      addOrReplaceClusterSchema(clusterSchema);
    }
  }
  if (rep != null) {
    readDatabases(rep,true);
    readPartitionSchemas(rep,true);
    readSlaves(rep,true);
    readClusters(rep,true);
  }
  return sharedObjects;
}
