{
  meta=(SingleThreaderMeta)smi;
  data=(SingleThreaderData)sdi;
  Object[] row=getRow();
  if (row == null) {
    if (data.batchCount > 0) {
      data.executor.oneIteration();
    }
    setOutputDone();
    return false;
  }
  if (first) {
    first=false;
  }
  data.rowProducer.putRow(getInputRowMeta(),row);
  data.batchCount++;
  if (data.batchCount > data.batchSize) {
    data.batchCount=0;
    boolean more=data.executor.oneIteration();
    if (!more) {
      setOutputDone();
      return false;
    }
  }
  return true;
}
