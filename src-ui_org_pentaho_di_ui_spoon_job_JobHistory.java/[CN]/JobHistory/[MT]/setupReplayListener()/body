{
  SelectionAdapter lsReplay=new SelectionAdapter(){
    final SimpleDateFormat df=new SimpleDateFormat(ValueMeta.DEFAULT_DATE_FORMAT_MASK);
    public void widgetSelected(    SelectionEvent e){
      int idx=wFields.getSelectionIndex();
      if (idx >= 0) {
        String fields[]=wFields.getItem(idx);
        String dateString=fields[12];
        if (dateString == null || dateString.equals(Const.NULL_STRING)) {
          MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
          mb.setMessage(Messages.getString("JobHistory.Error.ReplayingJob") + Const.CR + Messages.getString("JobHistory.Error.ReplayDateCannotBeNull"));
          mb.setText(Messages.getString("JobHistory.ERROR"));
          mb.open();
          return;
        }
        try {
          Date date=df.parse(dateString);
          spoon.executeJob(jobMeta,true,false,date,false);
        }
 catch (        ParseException e1) {
          new ErrorDialog(shell,Messages.getString("JobHistory.Error.ReplayingJob2"),Messages.getString("JobHistory.Error.InvalidReplayDate") + dateString,e1);
        }
      }
    }
  }
;
  wReplay.addSelectionListener(lsReplay);
}
