{
  final String table=getSchemaTable();
  if (table != null) {
    Menu mTree=null;
    if (mTree != null && !mTree.isDisposed()) {
      mTree.dispose();
    }
    mTree=new Menu(shell,SWT.POP_UP);
    mTree=new Menu(shell,SWT.POP_UP);
    MenuItem miCol=new MenuItem(mTree,SWT.PUSH);
    miCol.setText(BaseMessages.getString(PKG,"DatabaseExplorerDialog.Menu.DisplayColumns",table));
    miCol.addSelectionListener(new SelectionAdapter(){
      public void widgetSelected(      SelectionEvent e){
        getColumns(table,wTree.getSelection()[0]);
      }
    }
);
    new MenuItem(mTree,SWT.SEPARATOR);
    MenuItem miPrev=new MenuItem(mTree,SWT.PUSH);
    miPrev.setText(BaseMessages.getString(PKG,"DatabaseExplorerDialog.Menu.Preview100",table));
    miPrev.addSelectionListener(new SelectionAdapter(){
      public void widgetSelected(      SelectionEvent e){
        previewTable(table,false);
      }
    }
);
    MenuItem miPrevN=new MenuItem(mTree,SWT.PUSH);
    miPrevN.setText(BaseMessages.getString(PKG,"DatabaseExplorerDialog.Menu.PreviewN",table));
    miPrevN.addSelectionListener(new SelectionAdapter(){
      public void widgetSelected(      SelectionEvent e){
        previewTable(table,true);
      }
    }
);
    MenuItem miCount=new MenuItem(mTree,SWT.PUSH);
    miCount.setText(BaseMessages.getString(PKG,"DatabaseExplorerDialog.Menu.ShowSize",table));
    miCount.addSelectionListener(new SelectionAdapter(){
      public void widgetSelected(      SelectionEvent e){
        showCount(table);
      }
    }
);
    new MenuItem(mTree,SWT.SEPARATOR);
    MenuItem miShow=new MenuItem(mTree,SWT.PUSH);
    miShow.setText(BaseMessages.getString(PKG,"DatabaseExplorerDialog.Menu.ShowLayout",table));
    miShow.addSelectionListener(new SelectionAdapter(){
      public void widgetSelected(      SelectionEvent e){
        showTable(table);
      }
    }
);
    MenuItem miDDL=new MenuItem(mTree,SWT.PUSH);
    miDDL.setText(BaseMessages.getString(PKG,"DatabaseExplorerDialog.Menu.GenDDL"));
    miDDL.addSelectionListener(new SelectionAdapter(){
      public void widgetSelected(      SelectionEvent e){
        getDDL(table);
      }
    }
);
    MenuItem miDDL2=new MenuItem(mTree,SWT.PUSH);
    miDDL2.setText(BaseMessages.getString(PKG,"DatabaseExplorerDialog.Menu.GenDDLOtherConn"));
    miDDL2.addSelectionListener(new SelectionAdapter(){
      public void widgetSelected(      SelectionEvent e){
        getDDLForOther(table);
      }
    }
);
    miDDL2.setEnabled(databases != null);
    MenuItem miSQL=new MenuItem(mTree,SWT.PUSH);
    miSQL.setText(BaseMessages.getString(PKG,"DatabaseExplorerDialog.Menu.OpenSQL",table));
    miSQL.addSelectionListener(new SelectionAdapter(){
      public void widgetSelected(      SelectionEvent e){
        getSQL(table);
      }
    }
);
    new MenuItem(mTree,SWT.SEPARATOR);
    MenuItem miProfile=new MenuItem(mTree,SWT.PUSH);
    miProfile.setText(BaseMessages.getString(PKG,"DatabaseExplorerDialog.Menu.ProfileTable",table));
    miProfile.addSelectionListener(new SelectionAdapter(){
      public void widgetSelected(      SelectionEvent e){
        profileTable(table);
      }
    }
);
    wTree.setMenu(mTree);
  }
 else {
    wTree.setMenu(null);
  }
}
