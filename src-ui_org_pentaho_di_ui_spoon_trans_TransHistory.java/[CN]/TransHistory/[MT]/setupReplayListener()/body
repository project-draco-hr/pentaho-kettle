{
  SelectionAdapter lsReplay=new SelectionAdapter(){
    final SimpleDateFormat df=new SimpleDateFormat(ValueMeta.DEFAULT_DATE_FORMAT_MASK);
    public void widgetSelected(    SelectionEvent e){
      int idx=wFields.getSelectionIndex();
      if (idx >= 0) {
        String fields[]=wFields.getItem(idx);
        String dateString=fields[12];
        try {
          Date replayDate;
          if (Const.isEmpty(dateString))           replayDate=new Date();
 else           replayDate=df.parse(dateString);
          spoon.executeTransformation(transMeta,true,false,false,false,false,replayDate);
        }
 catch (        ParseException e1) {
          new ErrorDialog(shell,Messages.getString("SpoonHistory.Error.ReplayingTransformation2"),Messages.getString("SpoonHistory.Error.InvalidReplayDate") + dateString,e1);
        }
      }
    }
  }
;
  wReplay.addSelectionListener(lsReplay);
}
