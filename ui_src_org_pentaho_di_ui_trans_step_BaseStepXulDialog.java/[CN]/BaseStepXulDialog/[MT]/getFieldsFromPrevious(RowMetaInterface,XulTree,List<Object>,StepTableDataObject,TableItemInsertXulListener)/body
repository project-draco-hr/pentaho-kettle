{
  if (row == null || row.size() == 0)   return;
  List<String> keys=new ArrayList<String>();
  for (  Object entry : fields) {
    keys.add(((StepTableDataObject)entry).getName());
  }
  int choice=0;
  if (keys.size() > 0) {
    Shell shell=((TableViewer)tableView.getManagedObject()).getTable().getShell();
    MessageDialog md=new MessageDialog(shell,BaseMessages.getString(PKG,"BaseStepDialog.GetFieldsChoice.Title"),null,BaseMessages.getString(PKG,"BaseStepDialog.GetFieldsChoice.Message","" + keys.size(),"" + row.size()),MessageDialog.WARNING,new String[]{BaseMessages.getString(PKG,"BaseStepDialog.AddNew"),BaseMessages.getString(PKG,"BaseStepDialog.Add"),BaseMessages.getString(PKG,"BaseStepDialog.ClearAndAdd"),BaseMessages.getString(PKG,"BaseStepDialog.Cancel")},0);
    MessageDialog.setDefaultImage(GUIResource.getInstance().getImageSpoon());
    int idx=md.open();
    choice=idx & 0xFF;
  }
  if (choice == 3 || choice == 255)   return;
  if (choice == 2) {
    fields.clear();
  }
  for (int i=0; i < row.size(); i++) {
    ValueMetaInterface v=row.getValueMeta(i);
    if (choice == 0) {
      if (keys.indexOf(v.getName()) >= 0)       continue;
    }
    if (listener != null && !listener.tableItemInsertedFor(v)) {
      continue;
    }
    StepTableDataObject newField=field.createNew(v);
    fields.add(newField);
  }
}
