{
  NodeList list=doc.getElementsByTagName("toolbox");
  Toolbar toolbar=null;
  if (list != null && list.getLength() > 0) {
    Node toolboxNode=list.item(0);
    Node toolbarNode=XMLHandler.getSubNode(toolboxNode,"toolbar");
    while (toolbarNode != null) {
      if ("toolbar".equals(toolbarNode.getNodeName())) {
        String id=XMLHandler.getTagAttribute(toolbarNode,"id");
        String mode=XMLHandler.getTagAttribute(toolbarNode,"mode");
        toolbar=new Toolbar(shell,id,null);
        if ("full".equals(mode))         toolbar.setMode(Toolbar.MODE_FULL);
        if ("icons".equals(mode))         toolbar.setMode(Toolbar.MODE_ICONS);
        if ("text".equals(mode))         toolbar.setMode(Toolbar.MODE_TEXT);
        Node buttonNode=toolbarNode.getFirstChild();
        while (buttonNode != null) {
          if ("toolbarbutton".equals(buttonNode.getNodeName())) {
            String value=XMLHandler.getTagAttribute(buttonNode,"value");
            String imagePath=XMLHandler.getTagAttribute(buttonNode,"image");
            String hint=XMLHandler.getTagAttribute(buttonNode,"tooltiptext");
            hint=localizeXulText(hint,xulMessages);
            String label=XMLHandler.getTagAttribute(buttonNode,"label");
            label=localizeXulText(label,xulMessages);
            ToolbarButton button=new ToolbarButton(shell,value,toolbar);
            button.setHint(hint);
            button.setText(label);
            InputStream stream=caller.getClass().getResourceAsStream(imagePath);
            if (stream != null) {
              final Image image=new Image(shell.getDisplay(),stream);
              button.setImage(image);
            }
          }
 else           if ("toolbarseparator".equals(buttonNode.getNodeName())) {
            new ToolbarSeparator(shell,toolbar);
          }
          buttonNode=buttonNode.getNextSibling();
        }
      }
      toolbarNode=toolbarNode.getNextSibling();
    }
    return toolbar;
  }
  return null;
}
