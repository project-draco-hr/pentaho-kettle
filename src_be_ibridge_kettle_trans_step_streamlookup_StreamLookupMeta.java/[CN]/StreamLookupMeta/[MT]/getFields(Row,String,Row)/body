{
  Row row;
  if (r == null)   row=new Row();
 else   row=r;
  if (info != null && info.size() != 0) {
    for (int i=0; i < valueName.length; i++) {
      Value v=info.searchValue(value[i]);
      if (v != null) {
        v.setName(valueName[i]);
        v.setOrigin(name);
        row.addValue(v);
      }
 else {
        throw new KettleStepException(Messages.getString("StreamLookupMeta.Exception.ReturnValueCanNotBeFound",value[i]));
      }
    }
  }
 else {
    for (int i=0; i < valueName.length; i++) {
      Value v=new Value(valueName[i],valueDefaultType[i]);
      v.setOrigin(name);
      row.addValue(v);
    }
  }
  return row;
}
