{
  try {
    long id_directory_parent=0;
    if (dir.getParent() != null)     id_directory_parent=dir.getParent().getID();
    dir.setID(insertDirectory(id_directory_parent,dir));
    LogWriter.getInstance().logDetailed(repository.getName(),"New id of directory = " + dir.getID());
    repository.commit();
    repository.loadRepositoryDirectoryTree(dir.findRoot());
  }
 catch (  Exception e) {
    throw new KettleException("Unable to save directory [" + dir + "] in the repository",e);
  }
}
