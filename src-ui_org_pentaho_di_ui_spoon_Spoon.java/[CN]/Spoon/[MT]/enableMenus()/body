{
  boolean enableTransMenu=getActiveTransformation() != null;
  boolean enableJobMenu=getActiveJob() != null;
  boolean enableRepositoryMenu=rep != null;
  boolean enableLastPreviewMenu=false;
  boolean disablePreviewButton=false;
  TransGraph transGraph=getActiveTransGraph();
  if (transGraph != null) {
    TransDebugMeta lastTransDebugMeta=transGraph.getLastTransDebugMeta();
    enableLastPreviewMenu=!(lastTransDebugMeta == null || lastTransDebugMeta.getStepDebugMetaMap().isEmpty());
    disablePreviewButton=transGraph.isRunning() && !transGraph.isHalting();
  }
  menuBar.setEnableById("file-save",enableTransMenu || enableJobMenu);
  menuBar.setEnableById("file-save-as",enableTransMenu || enableJobMenu);
  menuBar.setEnableById("file-close",enableTransMenu || enableJobMenu);
  menuBar.setEnableById("file-print",enableTransMenu || enableJobMenu);
  if (!enableTransMenu && !enableJobMenu) {
    menuBar.setEnableById(UNDO_MENUITEM,false);
    menuBar.setEnableById(REDO_MENUITEM,false);
  }
  menuBar.setEnableById("edit-clear-selection",enableTransMenu);
  menuBar.setEnableById("edit-select-all",enableTransMenu);
  menuBar.setEnableById("edit-copy",enableTransMenu);
  menuBar.setEnableById("edit-paste",enableTransMenu);
  menuBar.setEnableById("trans-run",enableTransMenu && !disablePreviewButton);
  menuBar.setEnableById("trans-replay",enableTransMenu && !disablePreviewButton);
  menuBar.setEnableById("trans-preview",enableTransMenu && !disablePreviewButton);
  menuBar.setEnableById("trans-debug",enableTransMenu && !disablePreviewButton);
  menuBar.setEnableById("trans-verify",enableTransMenu);
  menuBar.setEnableById("trans-impact",enableTransMenu);
  menuBar.setEnableById("trans-get-sql",enableTransMenu);
  menuBar.setEnableById("trans-last-impact",enableTransMenu);
  menuBar.setEnableById("trans-last-check",enableTransMenu);
  menuBar.setEnableById("trans-last-preview",enableTransMenu);
  menuBar.setEnableById("trans-copy",enableTransMenu);
  menuBar.setEnableById("trans-copy-image",enableTransMenu);
  menuBar.setEnableById("trans-settings",enableTransMenu);
  menuBar.setEnableById("job-run",enableJobMenu);
  menuBar.setEnableById("job-copy",enableJobMenu);
  menuBar.setEnableById("job-settings",enableJobMenu);
  menuBar.setEnableById("wizard-connection",enableTransMenu || enableJobMenu);
  menuBar.setEnableById("wizard-copy-table",enableTransMenu || enableJobMenu);
  menuBar.setEnableById("wizard-copy-tables",enableRepositoryMenu || enableTransMenu || enableJobMenu);
  menuBar.setEnableById("repository-disconnect",enableRepositoryMenu);
  menuBar.setEnableById("repository-explore",enableRepositoryMenu);
  menuBar.setEnableById("repository-edit-user",enableRepositoryMenu);
  menuBar.setEnableById("trans-last-preview",enableLastPreviewMenu);
  enableMainEntries(enableTransMenu,enableJobMenu);
  refreshCoreObjects();
}
