{
  boolean enableTransMenu=getActiveTransformation() != null;
  boolean enableJobMenu=getActiveJob() != null;
  boolean enableRepositoryMenu=rep != null;
  menuBar.setEnableById("file-save",enableTransMenu || enableJobMenu);
  menuBar.setEnableById("file-save-as",enableTransMenu || enableJobMenu);
  menuBar.setEnableById("file-close",enableTransMenu || enableJobMenu);
  menuBar.setEnableById("file-print",enableTransMenu || enableJobMenu);
  if (!enableTransMenu && !enableJobMenu) {
    menuBar.setEnableById(UNDO_MENUITEM,false);
    menuBar.setEnableById(REDO_MENUITEM,false);
  }
  menuBar.setEnableById("edit-clear-selection",enableTransMenu);
  menuBar.setEnableById("edit-select-all",enableTransMenu);
  menuBar.setEnableById("edit-copy",enableTransMenu);
  menuBar.setEnableById("edit-paste",enableTransMenu);
  menuBar.setEnableById("trans-run",enableTransMenu);
  menuBar.setEnableById("trans-preview",enableTransMenu);
  menuBar.setEnableById("trans-verify",enableTransMenu);
  menuBar.setEnableById("trans-impact",enableTransMenu);
  menuBar.setEnableById("trans-get-sql",enableTransMenu);
  menuBar.setEnableById("trans-last-impact",enableTransMenu);
  menuBar.setEnableById("trans-last-check",enableTransMenu);
  menuBar.setEnableById("trans-last-preview",enableTransMenu);
  menuBar.setEnableById("trans-copy",enableTransMenu);
  menuBar.setEnableById("trans-copy-image",enableTransMenu);
  menuBar.setEnableById("trans-settings",enableTransMenu);
  menuBar.setEnableById("job-run",enableJobMenu);
  menuBar.setEnableById("job-copy",enableJobMenu);
  menuBar.setEnableById("job-settings",enableJobMenu);
  menuBar.setEnableById("wizard-connection",enableTransMenu || enableJobMenu);
  menuBar.setEnableById("wizard-copy-table",enableTransMenu || enableJobMenu);
  menuBar.setEnableById("wizard-copy-tables",enableRepositoryMenu || enableTransMenu || enableJobMenu);
  menuBar.setEnableById("repository-disconnect",enableRepositoryMenu);
  menuBar.setEnableById("repository-explore",enableRepositoryMenu);
  menuBar.setEnableById("repository-edit-user",enableRepositoryMenu);
  toolbar.setEnableById("sql",enableTransMenu || enableJobMenu);
  toolbar.setEnableById("impact",enableTransMenu);
  toolbar.setEnableById("check",enableTransMenu);
  toolbar.setEnableById("replay",enableTransMenu);
  toolbar.setEnableById("preview",enableTransMenu);
  toolbar.setEnableById("run",enableTransMenu || enableJobMenu);
  toolbar.setEnableById("print",enableTransMenu || enableJobMenu);
  toolbar.setEnableById("saveas",enableTransMenu || enableJobMenu);
  toolbar.setEnableById("save",enableTransMenu || enableJobMenu);
  refreshCoreObjects();
}
