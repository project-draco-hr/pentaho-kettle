{
  try {
    boolean loaded=false;
    FileListener listener=null;
    int idx=fname.lastIndexOf('.');
    if (idx != -1) {
      String extension=fname.substring(idx + 1);
      listener=fileExtensionMap.get(extension);
    }
    Document document=XMLHandler.loadXMLFile(fname);
    Node root=document.getFirstChild();
    if (listener == null) {
      listener=fileNodeMap.get(root.getNodeName());
    }
    if (listener != null) {
      loaded=listener.open(root,fname,importfile);
    }
    if (!loaded) {
      MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
      mb.setMessage(Messages.getString("Spoon.UnknownFileType.Message",fname));
      mb.setText(Messages.getString("Spoon.UnknownFileType.Title"));
      mb.open();
    }
  }
 catch (  KettleException e) {
    new ErrorDialog(shell,Messages.getString("Spoon.Dialog.ErrorOpening.Title"),Messages.getString("Spoon.Dialog.ErrorOpening.Message") + fname,e);
  }
}
