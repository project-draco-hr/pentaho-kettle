{
  if (meta == null)   return false;
  boolean saved=false;
  if (log.isDetailed())   log.logDetailed(toString(),BaseMessages.getString(PKG,"Spoon.Log.SaveToFileOrRepository"));
  if (rep != null) {
    saved=saveToRepository(meta);
  }
 else {
    if (meta.getFilename() != null) {
      saved=save(meta,meta.getFilename(),false);
    }
 else {
      saved=saveFileAs(meta);
    }
  }
  if (saved) {
    saved=meta.saveSharedObjects();
  }
  try {
    if (props.useDBCache() && meta instanceof TransMeta)     ((TransMeta)meta).getDbCache().saveCache(log);
  }
 catch (  KettleException e) {
    new ErrorDialog(shell,BaseMessages.getString(PKG,"Spoon.Dialog.ErrorSavingDatabaseCache.Title"),BaseMessages.getString(PKG,"Spoon.Dialog.ErrorSavingDatabaseCache.Message"),e);
  }
  delegates.tabs.renameTabs();
  refreshTree();
  return saved;
}
