{
  org.pentaho.ui.xul.dom.Document doc=mainSpoonContainer.getDocumentRoot();
  XulMenupopup pluginPopup=(XulMenupopup)doc.getElementById("plugins-popup-placeholder");
  SpoonPerspectiveManager perspectiveManager=SpoonPerspectiveManager.getInstance();
  List<SpoonPerspective> perspectives=perspectiveManager.getPerspectives();
  int i=0;
  for (  SpoonPerspective perspective : perspectives) {
    try {
      XulMenuitem menuItem=(XulMenuitem)doc.createElement("menuitem");
      menuItem.setLabel(perspective.getDisplayName(Locale.getDefault()));
      menuItem.setAttribute("type","checkbox");
      menuItem.setCommand("spoon.selectPerspective(" + i + ")");
      pluginPopup.addComponent(menuItem);
    }
 catch (    XulException e) {
      e.printStackTrace();
    }
    i++;
  }
  upDatePerspectiveMenu();
}
