{
  ResourceExportInterface resourceExportInterface=getActiveTransformation();
  if (resourceExportInterface == null)   resourceExportInterface=getActiveJob();
  if (resourceExportInterface == null)   return;
  FileDialog dialog=new FileDialog(shell,SWT.OPEN);
  dialog.setText(Messages.getString("Spoon.ExportResourceSelectZipFile"));
  dialog.setFilterExtensions(new String[]{"*.zip;*.ZIP","*"});
  dialog.setFilterNames(new String[]{Messages.getString("System.FileType.ZIPFiles"),Messages.getString("System.FileType.AllFiles")});
  if (dialog.open() != null) {
    String zipFilename=dialog.getFilterPath() + Const.FILE_SEPARATOR + dialog.getFileName();
    try {
      String launchFile=ResourceUtil.serializeResourceExportInterface(zipFilename,resourceExportInterface,(VariableSpace)resourceExportInterface,rep);
      String message=ResourceUtil.getExplanation(zipFilename,launchFile,resourceExportInterface);
      EnterTextDialog enterTextDialog=new EnterTextDialog(shell,"Resource serialized","This resource was serialized succesfully!",message);
      enterTextDialog.setReadOnly();
      enterTextDialog.open();
    }
 catch (    Exception e) {
      new ErrorDialog(shell,"Error","Error exporting current file",e);
    }
  }
}
