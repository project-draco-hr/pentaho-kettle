{
  ResourceExportInterface resourceExportInterface=getActiveTransformation();
  if (resourceExportInterface == null)   resourceExportInterface=getActiveJob();
  if (resourceExportInterface == null)   return;
  FileDialog dialog=new FileDialog(shell,SWT.OPEN);
  dialog.setText(Messages.getString("Spoon.ExportResourceSelectZipFile"));
  dialog.setFilterExtensions(new String[]{"*.zip;*.ZIP","*"});
  dialog.setFilterNames(new String[]{Messages.getString("System.FileType.ZIPFiles"),Messages.getString("System.FileType.AllFiles")});
  if (dialog.open() != null) {
    String zipFilename=dialog.getFilterPath() + Const.FILE_SEPARATOR + dialog.getFileName();
    try {
      String launchFile=ResourceUtil.serializeResourceExportInterface(zipFilename,resourceExportInterface,(VariableSpace)resourceExportInterface,rep);
      String message="This resource can be executed in the exported zip file [" + zipFilename + "]"+ Const.CR;
      message+="Important: relative paths to referenced input files don't work anymore!" + Const.CR;
      message+=" We had the choice to either put the files inside the zip archive OR change the references to an absolute path in the various steps." + Const.CR;
      message+="Because of time and functionality constraints, we opted to change the references.  Later we will add options to tweak this behavior" + Const.CR + Const.CR;
      message+="This resource can be executed in the exported zip file [" + zipFilename + "]"+ Const.CR;
      message+="You can do this by running kitchen with the following command:" + Const.CR + Const.CR;
      if (Const.isWindows()) {
        message+="Kitchen.bat /file:\"";
      }
 else {
        message+="sh kitchen.sh -file='";
      }
      message+=launchFile;
      if (Const.isWindows()) {
        message+="\"";
      }
 else {
        message+="'";
      }
      message+=Const.CR + "Please note that you can open this file with File/Open file from URL.  Enter this URL to open it:" + Const.CR+ Const.CR;
      message+=launchFile + Const.CR + Const.CR;
      EnterTextDialog enterTextDialog=new EnterTextDialog(shell,"Resource serialized","This resource was serialized succesfully!",message);
      enterTextDialog.setReadOnly();
      enterTextDialog.open();
    }
 catch (    Exception e) {
      new ErrorDialog(shell,"Error","Error exporting current file",e);
    }
  }
}
