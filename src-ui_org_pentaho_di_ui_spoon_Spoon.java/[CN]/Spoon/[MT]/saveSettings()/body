{
  WindowProperty winprop=new WindowProperty(shell);
  winprop.setName(APPL_TITLE);
  props.setScreen(winprop);
  props.setLogLevel(log.getLogLevelDesc());
  props.setLogFilter(log.getFilter());
  props.setSashWeights(sashform.getWeights());
  props.getOpenTabFiles().clear();
  for (  TabMapEntry entry : delegates.tabs.getTabs()) {
    String fileType=null;
    String filename=null;
    String directory=null;
    int openType=0;
    if (entry.getObjectType() == TabMapEntry.OBJECT_TYPE_TRANSFORMATION_GRAPH) {
      fileType=LastUsedFile.FILE_TYPE_TRANSFORMATION;
      TransMeta transMeta=(TransMeta)entry.getObject().getManagedObject();
      filename=rep != null ? transMeta.getName() : transMeta.getFilename();
      directory=transMeta.getRepositoryDirectory().toString();
      openType=LastUsedFile.OPENED_ITEM_TYPE_MASK_GRAPH;
      if (delegates.tabs.findTabItem(delegates.tabs.makeLogTabName(transMeta),TabMapEntry.OBJECT_TYPE_TRANSFORMATION_LOG) != null) {
        openType|=LastUsedFile.OPENED_ITEM_TYPE_MASK_LOG;
      }
      if (delegates.tabs.findTabItem(delegates.tabs.makeHistoryTabName(transMeta),TabMapEntry.OBJECT_TYPE_TRANSFORMATION_HISTORY) != null) {
        openType|=LastUsedFile.OPENED_ITEM_TYPE_MASK_HISTORY;
      }
    }
 else     if (entry.getObjectType() == TabMapEntry.OBJECT_TYPE_JOB_GRAPH) {
      fileType=LastUsedFile.FILE_TYPE_JOB;
      JobMeta jobMeta=(JobMeta)entry.getObject().getManagedObject();
      filename=rep != null ? jobMeta.getName() : jobMeta.getFilename();
      directory=jobMeta.getRepositoryDirectory().toString();
      openType=LastUsedFile.OPENED_ITEM_TYPE_MASK_GRAPH;
      if (delegates.tabs.findTabItem(delegates.tabs.makeJobLogTabName(jobMeta),TabMapEntry.OBJECT_TYPE_JOB_LOG) != null) {
        openType|=LastUsedFile.OPENED_ITEM_TYPE_MASK_LOG;
      }
      if (delegates.tabs.findTabItem(delegates.tabs.makeJobHistoryTabName(jobMeta),TabMapEntry.OBJECT_TYPE_JOB_HISTORY) != null) {
        openType|=LastUsedFile.OPENED_ITEM_TYPE_MASK_HISTORY;
      }
    }
    if (fileType != null) {
      props.addOpenTabFile(fileType,filename,directory,rep != null,rep != null ? rep.getName() : null,openType);
    }
  }
  props.saveProps();
}
