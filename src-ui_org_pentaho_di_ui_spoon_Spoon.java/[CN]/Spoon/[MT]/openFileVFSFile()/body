{
  FileObject initialFile=null;
  FileObject rootFile=null;
  try {
    initialFile=KettleVFS.getFileObject(getLastFileOpened());
    rootFile=initialFile.getFileSystem().getRoot();
  }
 catch (  IOException e) {
    e.printStackTrace();
    String message=e.getMessage();
    if (e.getCause() != null) {
      message=e.getCause().getMessage();
    }
    MessageBox messageDialog=new MessageBox(shell,SWT.ICON_ERROR | SWT.OK);
    messageDialog.setText("Error");
    messageDialog.setMessage(message);
    messageDialog.open();
    return;
  }
  VfsFileChooserDialog vfsFileChooser=new VfsFileChooserDialog(rootFile,initialFile);
  FileObject selectedFile=vfsFileChooser.open(shell,null,Const.STRING_TRANS_AND_JOB_FILTER_EXT,Const.getTransformationAndJobFilterNames(),VfsFileChooserDialog.VFS_DIALOG_OPEN_FILE);
  if (selectedFile != null) {
    setLastFileOpened(selectedFile.getName().getFriendlyURI());
    openFile(selectedFile.getName().getFriendlyURI(),false);
  }
}
