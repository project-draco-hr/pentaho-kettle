{
  if (rep == null || importfile) {
    FileDialog dialog=new FileDialog(shell,SWT.OPEN);
    dialog.setFilterExtensions(Const.STRING_TRANS_AND_JOB_FILTER_EXT);
    dialog.setFilterNames(Const.getTransformationAndJobFilterNames());
    setFilterPath(dialog);
    String fname=dialog.open();
    if (fname != null) {
      lastDirOpened=dialog.getFilterPath();
      openFile(fname,importfile);
    }
  }
 else {
    SelectObjectDialog sod=new SelectObjectDialog(shell,rep);
    if (sod.open() != null) {
      String type=sod.getObjectType();
      String name=sod.getObjectName();
      RepositoryDirectory repdir=sod.getDirectory();
      if (RepositoryObject.STRING_OBJECT_TYPE_TRANSFORMATION.equals(type)) {
        TransLoadProgressDialog tlpd=new TransLoadProgressDialog(shell,rep,name,repdir,null);
        TransMeta transMeta=tlpd.open();
        sharedObjectsFileMap.put(transMeta.getSharedObjects().getFilename(),transMeta.getSharedObjects());
        setTransMetaVariables(transMeta);
        if (transMeta != null) {
          if (log.isDetailed())           log.logDetailed(toString(),BaseMessages.getString(PKG,"Spoon.Log.LoadToTransformation",name,repdir.getDirectoryName()));
          props.addLastFile(LastUsedFile.FILE_TYPE_TRANSFORMATION,name,repdir.getPath(),true,rep.getName());
          addMenuLast();
          transMeta.clearChanged();
          addTransGraph(transMeta);
        }
        refreshGraph();
        refreshTree();
        refreshHistory();
      }
 else       if (RepositoryObject.STRING_OBJECT_TYPE_JOB.equals(type)) {
        JobLoadProgressDialog jlpd=new JobLoadProgressDialog(shell,rep,name,repdir,null);
        JobMeta jobMeta=jlpd.open();
        sharedObjectsFileMap.put(jobMeta.getSharedObjects().getFilename(),jobMeta.getSharedObjects());
        setJobMetaVariables(jobMeta);
        if (jobMeta != null) {
          props.addLastFile(LastUsedFile.FILE_TYPE_JOB,name,repdir.getPath(),true,rep.getName());
          saveSettings();
          addMenuLast();
          delegates.jobs.addJobGraph(jobMeta);
        }
        refreshGraph();
        refreshTree();
      }
    }
  }
}
