{
  try {
    if (rep == null)     return;
    TransMeta transMeta=getActiveTransformation();
    if (transMeta != null) {
      if (transMeta.getObjectId() != null) {
        EnterStringDialog dialog=new EnterStringDialog(shell,"Transformation locked by " + rep.getUserInfo().getName(),"Lock message","Enter lock message");
        String message=dialog.open();
        rep.lockTransformation(transMeta.getObjectId(),message);
        transMeta.setRepositoryLock(new RepositoryLock(transMeta.getObjectId(),message,rep.getUserInfo().getLogin(),rep.getUserInfo().getName()));
        enableMenus();
        refreshGraph();
      }
    }
    JobMeta jobMeta=getActiveJob();
    if (jobMeta != null) {
      if (jobMeta.getObjectId() != null) {
        EnterStringDialog dialog=new EnterStringDialog(shell,"Job locked by " + rep.getUserInfo().getName(),"Lock message","Enter lock message");
        String message=dialog.open();
        rep.lockJob(jobMeta.getObjectId(),message);
        jobMeta.setRepositoryLock(new RepositoryLock(jobMeta.getObjectId(),message,rep.getUserInfo().getLogin(),rep.getUserInfo().getName()));
        enableMenus();
        refreshGraph();
      }
    }
  }
 catch (  Exception e) {
    new ErrorDialog(shell,"Error locking file","There was an unexpected error locking a file",e);
  }
}
