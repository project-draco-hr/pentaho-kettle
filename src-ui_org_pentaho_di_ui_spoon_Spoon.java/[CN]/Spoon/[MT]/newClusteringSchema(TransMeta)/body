{
  ClusterSchema clusterSchema=new ClusterSchema();
  ClusterSchemaDialog dialog=new ClusterSchemaDialog(shell,clusterSchema,transMeta.getSlaveServers());
  if (dialog.open()) {
    transMeta.getClusterSchemas().add(clusterSchema);
    if (rep != null) {
      try {
        if (!rep.getSecurityProvider().isReadOnly()) {
          rep.save(clusterSchema,Const.VERSION_COMMENT_INITIAL_VERSION,null);
        }
 else {
          throw new KettleException(BaseMessages.getString(PKG,"Spoon.Dialog.Exception.ReadOnlyRepositoryUser"));
        }
      }
 catch (      KettleException e) {
        new ErrorDialog(getShell(),BaseMessages.getString(PKG,"Spoon.Dialog.ErrorSavingCluster.Title"),BaseMessages.getString(PKG,"Spoon.Dialog.ErrorSavingCluster.Message",clusterSchema.getName()),e);
      }
    }
    refreshTree();
  }
}
