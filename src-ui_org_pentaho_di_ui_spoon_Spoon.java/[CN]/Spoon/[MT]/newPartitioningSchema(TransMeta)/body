{
  PartitionSchema partitionSchema=new PartitionSchema();
  PartitionSchemaDialog dialog=new PartitionSchemaDialog(shell,partitionSchema,transMeta.getDatabases(),transMeta);
  if (dialog.open()) {
    transMeta.getPartitionSchemas().add(partitionSchema);
    if (rep != null) {
      try {
        if (!rep.getSecurityProvider().isReadOnly()) {
          rep.save(partitionSchema,Const.VERSION_COMMENT_INITIAL_VERSION,null);
        }
 else {
          throw new KettleException(BaseMessages.getString(PKG,"Spoon.Dialog.Exception.ReadOnlyRepositoryUser"));
        }
      }
 catch (      KettleException e) {
        new ErrorDialog(getShell(),BaseMessages.getString(PKG,"Spoon.Dialog.ErrorSavingPartition.Title"),BaseMessages.getString(PKG,"Spoon.Dialog.ErrorSavingPartition.Message",partitionSchema.getName()),e);
      }
    }
    refreshTree();
  }
}
