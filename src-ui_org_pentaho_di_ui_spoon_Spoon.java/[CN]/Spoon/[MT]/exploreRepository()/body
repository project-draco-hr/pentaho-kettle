{
  if (rep != null) {
    RepositoryExplorerCallback cb=new RepositoryExplorerDialog.RepositoryExplorerCallback(){
      public boolean open(      RepositoryObjectReference objectToOpen){
        String objname=objectToOpen.getName();
        if (objname != null) {
          String object_type=objectToOpen.getType();
          RepositoryDirectory repdir=objectToOpen.getDirectory();
          if (object_type.equals(RepositoryExplorerDialog.STRING_TRANSFORMATIONS)) {
            try {
              TransLoadProgressDialog progressDialog=new TransLoadProgressDialog(shell,rep,objname,repdir);
              TransMeta transMeta=progressDialog.open();
              transMeta.clearChanged();
              transMeta.setFilename(objname);
              addTransGraph(transMeta);
              refreshTree();
              refreshGraph();
            }
 catch (            Exception e) {
              MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
              mb.setMessage(Messages.getString("Spoon.Dialog.ErrorOpening.Message") + objname + Const.CR+ e.getMessage());
              mb.setText(Messages.getString("Spoon.Dialog.ErrorOpening.Title"));
              mb.open();
            }
          }
 else           if (object_type.equals(RepositoryExplorerDialog.STRING_JOBS)) {
            try {
              JobLoadProgressDialog progressDialog=new JobLoadProgressDialog(shell,rep,objname,repdir);
              JobMeta jobMeta=progressDialog.open();
              jobMeta.clearChanged();
              jobMeta.setFilename(objname);
              jobMeta.setArguments(arguments);
              delegates.jobs.addJobGraph(jobMeta);
              refreshTree();
              refreshGraph();
            }
 catch (            Exception e) {
              MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
              mb.setMessage(Messages.getString("Spoon.Dialog.ErrorOpening.Message") + objname + Const.CR+ e.getMessage());
              mb.setText(Messages.getString("Spoon.Dialog.ErrorOpening.Title"));
              mb.open();
            }
          }
        }
        return false;
      }
    }
;
    RepositoryExplorerDialog erd=new RepositoryExplorerDialog(shell,SWT.NONE,rep,rep.getUserInfo(),cb);
    erd.open();
  }
}
