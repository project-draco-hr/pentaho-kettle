{
  Boolean useSleak=System.getProperties().containsKey("SLEAK");
  log=new LogChannel(APP_NAME);
  SpoonFactory.setSpoonInstance(this);
  setRepository(rep);
  if (d != null) {
    display=d;
    destroy=false;
  }
 else {
    if (useSleak) {
      DeviceData data=new DeviceData();
      data.tracking=true;
      display=new Display(data);
    }
 else {
      display=new Display();
    }
    destroy=true;
  }
  props=PropsUI.getInstance();
  sharedObjectsFileMap=new Hashtable<String,SharedObjects>();
  shell=new Shell(display);
  shell.setText(APPL_TITLE);
  staticSpoon=this;
  if (useSleak) {
    Sleak sleak=new Sleak();
    Shell sleakShell=new Shell(display);
    sleakShell.setText("S-Leak");
    org.eclipse.swt.graphics.Point size=sleakShell.getSize();
    sleakShell.setSize(size.x / 2,size.y / 2);
    sleak.create(sleakShell);
    sleakShell.open();
  }
  try {
    JndiUtil.initJNDI();
  }
 catch (  Exception e) {
    new ErrorDialog(shell,"Unable to init simple JNDI","Unable to init simple JNDI",e);
  }
}
