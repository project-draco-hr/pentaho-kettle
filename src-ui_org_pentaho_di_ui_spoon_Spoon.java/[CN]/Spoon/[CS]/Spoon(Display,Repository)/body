{
  this.log=LogWriter.getInstance();
  this.rep=rep;
  if (d != null) {
    display=d;
    destroy=false;
  }
 else {
    display=new Display();
    destroy=true;
  }
  props=PropsUI.getInstance();
  sharedObjectsFileMap=new Hashtable<String,SharedObjects>();
  shell=new Shell(display);
  shell.setText(APPL_TITLE);
  staticSpoon=this;
  JndiUtil.initJNDI();
  SpoonFactory.setSpoonInstance(this);
}
