{
  this.log=new LogChannel(APP_NAME);
  setRepository(rep);
  if (d != null) {
    display=d;
    destroy=false;
  }
 else {
    display=new Display();
    destroy=true;
  }
  props=PropsUI.getInstance();
  sharedObjectsFileMap=new Hashtable<String,SharedObjects>();
  shell=new Shell(display);
  shell.setText(APPL_TITLE);
  staticSpoon=this;
  try {
    JndiUtil.initJNDI();
  }
 catch (  Exception e) {
    new ErrorDialog(shell,"Unable to init simple JNDI","Unable to init simple JNDI",e);
  }
  SpoonFactory.setSpoonInstance(this);
}
