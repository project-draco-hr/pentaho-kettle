{
  log.logDetailed(toString(),"refreshTree() called");
  TreeItem tiJobEntries=null;
  TreeItem tiConnections=null;
  TreeItem ti[]=tMain.getItems();
  for (int i=0; i < ti.length; i++) {
    if (ti[i].getText().equalsIgnoreCase(STRING_JOBENTRIES))     tiJobEntries=ti[i];
    if (ti[i].getText().equalsIgnoreCase(STRING_CONNECTIONS))     tiConnections=ti[i];
  }
  if (tiConnections != null) {
    TreeItem entries[]=tiConnections.getItems();
    for (int i=0; i < entries.length; i++)     entries[i].dispose();
  }
  if (tiJobEntries != null) {
    TreeItem entries[]=tiJobEntries.getItems();
    for (int i=0; i < entries.length; i++)     entries[i].dispose();
  }
  for (int i=0; i < jobMeta.nrDatabases(); i++) {
    DatabaseMeta dbinfo=jobMeta.getDatabase(i);
    TreeItem item=new TreeItem(tiConnections,SWT.NONE);
    item.setText(dbinfo.getName());
  }
  for (int i=0; i < jobMeta.nrJobEntries(); i++) {
    JobEntryCopy je=jobMeta.getJobEntry(i);
    TreeItem item=new TreeItem(tiJobEntries,SWT.NONE);
    if (je.getName() != null)     item.setText(je.getName());
  }
  tMain.setFocus();
  setShellText();
}
