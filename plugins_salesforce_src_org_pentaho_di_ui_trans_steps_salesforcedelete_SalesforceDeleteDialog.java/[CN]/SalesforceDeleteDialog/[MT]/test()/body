{
  boolean successConnection=true;
  String msgError=null;
  String realUsername=null;
  SalesforceConnection connection=null;
  if (!checkInput()) {
    return;
  }
  try {
    SalesforceDeleteMeta meta=new SalesforceDeleteMeta();
    getInfo(meta);
    if (!checkUser()) {
      return;
    }
    String realURL=transMeta.environmentSubstitute(meta.getTargetURL());
    realUsername=transMeta.environmentSubstitute(meta.getUserName());
    String realPassword=transMeta.environmentSubstitute(meta.getPassword());
    connection=new SalesforceConnection(log,realURL,realUsername,realPassword);
    connection.connect();
    successConnection=true;
  }
 catch (  Exception e) {
    successConnection=false;
    msgError=e.getMessage();
  }
 finally {
    if (connection != null) {
      try {
        connection.close();
      }
 catch (      Exception e) {
      }
    }
  }
  if (successConnection) {
    MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_INFORMATION);
    mb.setMessage(BaseMessages.getString(PKG,"SalesforceDeleteDialog.Connected.OK",realUsername) + Const.CR);
    mb.setText(BaseMessages.getString(PKG,"SalesforceDeleteDialog.Connected.Title.Ok"));
    mb.open();
  }
 else {
    new ErrorDialog(shell,BaseMessages.getString(PKG,"SalesforceDeleteDialog.Connected.Title.Error"),BaseMessages.getString(PKG,"SalesforceDeleteDialog.Connected.NOK",realUsername),new Exception(msgError));
  }
}
