{
  meta=(CubeInputMeta)smi;
  data=(CubeInputData)sdi;
  if (super.init(smi,sdi)) {
    try {
      String filename=environmentSubstitute(meta.getFilename());
      if (meta.isAddResultFile()) {
        ResultFile resultFile=new ResultFile(ResultFile.FILE_TYPE_GENERAL,KettleVFS.getFileObject(filename),getTransMeta().getName(),toString());
        resultFile.setComment("File was read by a Cube Input step");
        addResultFile(resultFile);
      }
      data.fis=KettleVFS.getInputStream(filename);
      data.zip=new GZIPInputStream(data.fis);
      data.dis=new DataInputStream(data.zip);
      try {
        data.meta=new RowMeta(data.dis);
        return true;
      }
 catch (      KettleFileException kfe) {
        logError(Messages.getString("CubeInput.Log.UnableToReadMetadata") + kfe.getMessage());
        return false;
      }
    }
 catch (    IOException e) {
      logError(Messages.getString("CubeInput.Log.ErrorReadingFromDataCube") + e.toString());
    }
  }
  return false;
}
