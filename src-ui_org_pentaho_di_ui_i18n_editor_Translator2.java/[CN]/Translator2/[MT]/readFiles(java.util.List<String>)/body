{
  log.logBasic(toString(),Messages.getString("i18n.Log.ScanningSourceDirectories"));
  try {
    crawler=new MessagesSourceCrawler(directories,singleMessagesFile);
    crawler.setFilesToAvoid(filesToAvoid);
    crawler.setXulDirectories(new String[]{"ui"});
    crawler.crawl();
    messagesPackages=crawler.getMessagesPackagesList();
    store=new TranslationsStore(localeList,messagesPackages,referenceLocale);
    store.read(directories);
    int nrKeys=0;
    int keyCounts[]=new int[localeList.size()];
    for (int i=0; i < localeList.size(); i++) {
      String locale=localeList.get(i);
      keyCounts[i]=0;
      for (      KeyOccurrence keyOccurrence : crawler.getOccurrences()) {
        if (showKey(keyOccurrence.getKey(),keyOccurrence.getMessagesPackage())) {
          String value=store.lookupKeyValue(locale,keyOccurrence.getMessagesPackage(),keyOccurrence.getKey());
          if (!Const.isEmpty(value)) {
            keyCounts[i]++;
          }
          if (locale.equals(referenceLocale)) {
            nrKeys++;
          }
        }
      }
    }
    DecimalFormat df=new DecimalFormat("##0.00");
    double donePct[]=new double[localeList.size()];
    System.out.println(Messages.getString("i18n.Log.NumberOfKeysFound","" + nrKeys));
    for (int i=0; i < localeList.size(); i++) {
      donePct[i]=100 * (double)keyCounts[i] / (double)nrKeys;
      System.out.println(localeList.get(i) + " : " + df.format(donePct[i])+ "% complete  ("+ keyCounts[i]+ ")");
    }
  }
 catch (  Exception e) {
    throw new KettleFileException(Messages.getString("i18n.Log.UnableToGetFiles",rootDirectories.toString()),e);
  }
}
