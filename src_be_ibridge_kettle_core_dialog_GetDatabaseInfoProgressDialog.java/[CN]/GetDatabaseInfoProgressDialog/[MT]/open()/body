{
  final DatabaseMetaInformation dmi=new DatabaseMetaInformation(dbInfo);
  IRunnableWithProgress op=new IRunnableWithProgress(){
    public void run(    IProgressMonitor monitor) throws InvocationTargetException, InterruptedException {
      try {
        LocalVariables.getInstance().createKettleVariables(Thread.currentThread().getName(),parentThread.getName(),true);
        dmi.getData(monitor);
      }
 catch (      Exception e) {
        throw new InvocationTargetException(e,"Problem encountered getting information from the database: " + e.toString());
      }
    }
  }
;
  try {
    ProgressMonitorDialog pmd=new ProgressMonitorDialog(shell);
    pmd.run(true,true,op);
  }
 catch (  InvocationTargetException e) {
    new ErrorDialog(shell,"Error getting information","An error occured getting information from the database!",e);
    return null;
  }
catch (  InterruptedException e) {
    new ErrorDialog(shell,"Error getting information","An error occured getting information from the database!",e);
    return null;
  }
  return dmi;
}
