{
  LogWriter log=LogWriter.getInstance();
  Result result=previousResult;
  result.setResult(false);
  String realFilename1=getRealFilename1();
  String realFilename2=getRealFilename2();
  FileObject file1=null;
  FileObject file2=null;
  try {
    if (filename1 != null && filename2 != null) {
      file1=KettleVFS.getFileObject(realFilename1);
      file2=KettleVFS.getFileObject(realFilename2);
      if (file1.exists() && file2.exists()) {
        if (equalFileContents(file1,file2)) {
          result.setResult(true);
        }
 else {
          result.setResult(false);
        }
      }
 else {
        if (!file1.exists())         log.logError(toString(),"File 1 [" + realFilename1 + "] does not exist.");
        if (!file2.exists())         log.logError(toString(),"File 2 [" + realFilename2 + "] does not exist.");
        result.setResult(false);
        result.setNrErrors(1);
      }
    }
 else {
      log.logError(toString(),"Need 2 filenames to compare file contents.");
    }
  }
 catch (  Exception e) {
    result.setResult(false);
    result.setNrErrors(1);
    log.logError(toString(),"Error occurred while comparing file [" + realFilename2 + "] and file ["+ realFilename2+ "]: "+ e.getMessage());
  }
 finally {
    try {
      if (file1 != null)       file1.close();
      if (file2 != null)       file2.close();
    }
 catch (    IOException e) {
    }
  }
  return result;
}
