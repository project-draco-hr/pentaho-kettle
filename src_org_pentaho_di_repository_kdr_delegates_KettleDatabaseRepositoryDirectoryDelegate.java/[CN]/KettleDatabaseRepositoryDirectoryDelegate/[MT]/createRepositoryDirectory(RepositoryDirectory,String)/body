{
  RepositoryDirectory refreshedParentDir=repository.loadRepositoryDirectoryTree().findDirectory(parentDirectory.getPath());
  String path[]=Const.splitPath(directoryPath,RepositoryDirectory.DIRECTORY_SEPARATOR);
  RepositoryDirectory parent=refreshedParentDir;
  for (int level=1; level <= path.length; level++) {
    String subPath[]=new String[level];
    for (int i=0; i < level; i++) {
      subPath[i]=path[i];
    }
    RepositoryDirectory rd=parent.findDirectory(subPath);
    if (rd == null) {
      rd=new RepositoryDirectory(parent,subPath[level - 1]);
      saveRepositoryDirectory(rd);
      parent.addSubdirectory(rd);
      parent=rd;
    }
 else {
      parent=rd;
    }
  }
  return parent;
}
