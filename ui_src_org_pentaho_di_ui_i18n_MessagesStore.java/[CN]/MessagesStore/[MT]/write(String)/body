{
  try {
    File file=new File(filename);
    if (!file.exists()) {
      File parent=file.getParentFile();
      if (!parent.exists()) {
        parent.mkdirs();
      }
    }
    Properties properties=new Properties();
    for (    String key : messagesMap.keySet()) {
      properties.put(key,messagesMap.get(key));
    }
    FileOutputStream fileOutputStream=new FileOutputStream(file);
    String comment="File generated by Pentaho Translator for package '" + messagesPackage + "' in locale '"+ locale+ "'"+ Const.CR+ Const.CR;
    properties.store(fileOutputStream,comment);
    fileOutputStream.close();
    setChanged(false);
  }
 catch (  IOException e) {
    throw new KettleException("Unable to save messages properties file '" + filename + "'",e);
  }
}
