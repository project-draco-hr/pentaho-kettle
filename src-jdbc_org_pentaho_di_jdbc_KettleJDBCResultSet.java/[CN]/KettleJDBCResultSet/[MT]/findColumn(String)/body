{
  KettleJDBCResultSetMetaData rm=(KettleJDBCResultSetMetaData)getMetaData();
  columns=rm.getColumns();
  if (columnMap == null) {
    columnMap=new HashMap<String,Integer>(columnCount);
  }
 else {
    Object pos=columnMap.get(columnName);
    if (pos != null) {
      return ((Integer)pos).intValue();
    }
  }
  for (int i=0; i < columnCount; i++) {
    if (columns[i].realName.equalsIgnoreCase(columnName)) {
      columnMap.put(columnName,new Integer(i + 1));
      return i + 1;
    }
  }
  throw new SQLException(Messages.get("error.resultset.colname",columnName),"07009");
}
