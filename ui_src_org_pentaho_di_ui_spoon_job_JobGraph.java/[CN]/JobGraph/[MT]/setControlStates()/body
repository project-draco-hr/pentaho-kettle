{
  if (isDisposed() || getDisplay().isDisposed()) {
    return;
  }
  getDisplay().asyncExec(new Runnable(){
    public void run(){
      boolean operationsNotAllowed=false;
      try {
        operationsNotAllowed=RepositorySecurityUI.verifyOperations(shell,spoon.rep,false,RepositoryOperation.EXECUTE_JOB);
      }
 catch (      KettleRepositoryLostException krle) {
        log.logError(krle.getLocalizedMessage());
      }
      boolean running=job != null && job.isActive();
      XulToolbarbutton runButton=(XulToolbarbutton)toolbar.getElementById("job-run");
      if (runButton != null && !controlDisposed(runButton) && !operationsNotAllowed) {
        if (runButton.isDisabled() ^ running) {
          runButton.setDisabled(running);
        }
      }
      XulToolbarbutton stopButton=(XulToolbarbutton)toolbar.getElementById("job-stop");
      if (stopButton != null && !controlDisposed(stopButton)) {
        if (stopButton.isDisabled() ^ !running) {
          stopButton.setDisabled(!running);
        }
      }
      XulToolbarbutton replayButton=(XulToolbarbutton)toolbar.getElementById("job-replay");
      if (replayButton != null && !controlDisposed(replayButton) && !operationsNotAllowed) {
        if (replayButton.isDisabled() ^ running) {
          replayButton.setDisabled(running);
        }
      }
      XulToolbarbutton versionsButton=(XulToolbarbutton)toolbar.getElementById("browse-versions");
      if (versionsButton != null && !controlDisposed(versionsButton)) {
        boolean hasRepository=spoon.rep != null;
        boolean enabled=hasRepository && spoon.rep.getRepositoryMeta().getRepositoryCapabilities().supportsRevisions();
        if (versionsButton.isDisabled() ^ !enabled) {
          versionsButton.setDisabled(!enabled);
        }
      }
    }
  }
);
}
