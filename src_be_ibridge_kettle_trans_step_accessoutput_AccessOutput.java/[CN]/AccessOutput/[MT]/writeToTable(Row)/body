{
  if (r == null) {
    if (log.isDetailed())     logDetailed("Last line inserted: stop");
    return false;
  }
  if (first) {
    first=false;
    try {
      String realTablename=StringUtil.environmentSubstitute(meta.getTablename());
      data.table=data.db.getTable(realTablename);
      if (data.table == null) {
        if (meta.isTableCreated()) {
          data.columns=AccessOutputMeta.getColumns(r);
          data.db.createTable(realTablename,data.columns);
          data.table=data.db.getTable(realTablename);
        }
 else {
          logError(Messages.getString("AccessOutput.Error.TableDoesNotExist",realTablename));
          setErrors(1);
          stopAll();
          return false;
        }
      }
    }
 catch (    IOException e) {
      logError(Messages.getString("AccessOutput.Exception.UnexpectedErrorCreatingTable",e.toString()));
      logError(Const.getStackTracker(e));
      setErrors(1);
      stopAll();
      return false;
    }
  }
  return true;
}
