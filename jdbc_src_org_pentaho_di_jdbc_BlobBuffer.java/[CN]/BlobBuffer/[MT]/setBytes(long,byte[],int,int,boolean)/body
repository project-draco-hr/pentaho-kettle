{
  pos--;
  if (pos < 0) {
    throw new SQLException(BaseMessages.getString(PKG,"error.blobclob.badpos"),"HY090");
  }
  if (pos > this.length) {
    throw new SQLException(BaseMessages.getString(PKG,"error.blobclob.badposlen"),"HY090");
  }
  if (bytes == null) {
    throw new SQLException(BaseMessages.getString(PKG,"error.blob.bytesnull"),"HY009");
  }
  if (offset < 0 || offset > bytes.length) {
    throw new SQLException(BaseMessages.getString(PKG,"error.blobclob.badoffset"),"HY090");
  }
  if (len < 0 || pos + len > (long)Integer.MAX_VALUE || offset + len > bytes.length) {
    throw new SQLException(BaseMessages.getString(PKG,"error.blobclob.badlen"),"HY090");
  }
  if (blobFile == null && pos == 0 && len >= this.length && len <= maxMemSize) {
    if (copy) {
      buffer=new byte[len];
      System.arraycopy(bytes,offset,buffer,0,len);
    }
 else {
      buffer=bytes;
    }
    length=len;
    return len;
  }
  try {
    if (!isMemOnly && blobFile == null) {
      createBlobFile();
    }
    open();
    int ptr=(int)pos;
    write(ptr,bytes,offset,len);
    close();
    return len;
  }
 catch (  IOException e) {
    throw new SQLException(BaseMessages.getString(PKG,"error.generic.ioerror",e.getMessage()),"HY000");
  }
}
