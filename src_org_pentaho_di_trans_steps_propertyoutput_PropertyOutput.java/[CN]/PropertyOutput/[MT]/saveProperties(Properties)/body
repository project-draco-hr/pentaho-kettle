{
  OutputStream propsFile=null;
  ;
  try {
    propsFile=KettleVFS.getOutputStream(data.file,false);
    p.store(propsFile,environmentSubstitute(meta.getComment()));
    if (meta.AddToResult()) {
      ResultFile resultFile=new ResultFile(ResultFile.FILE_TYPE_GENERAL,data.file,getTransMeta().getName(),getStepname());
      resultFile.setComment(Messages.getString("PropertyOutput.Log.FileAddedResult"));
      addResultFile(resultFile);
    }
  }
 catch (  Exception e) {
    throw new KettleException(e);
  }
 finally {
    if (propsFile != null) {
      try {
        propsFile.close();
        propsFile=null;
      }
 catch (      Exception e) {
      }
      ;
    }
  }
}
