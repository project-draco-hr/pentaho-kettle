{
  OutputStream propsFile=null;
  try {
    propsFile=new FileOutputStream(fileName);
    p.store(propsFile,environmentSubstitute(meta.getComment()));
    propsFile.close();
    if (meta.AddToResult()) {
      ResultFile resultFile=new ResultFile(ResultFile.FILE_TYPE_GENERAL,KettleVFS.getFileObject(fileName),getTransMeta().getName(),getStepname());
      resultFile.setComment(Messages.getString("PropertyOutput.Log.FileAddedResult"));
      addResultFile(resultFile);
    }
  }
 catch (  IOException ioe) {
    System.out.println("I/O Exception.");
    ioe.printStackTrace();
    System.exit(0);
  }
 finally {
    if (propsFile != null) {
      try {
        propsFile.close();
        propsFile=null;
      }
 catch (      Exception e) {
      }
    }
  }
}
