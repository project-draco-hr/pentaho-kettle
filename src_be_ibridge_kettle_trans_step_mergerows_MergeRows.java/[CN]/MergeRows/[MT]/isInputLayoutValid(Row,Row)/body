{
  if (refRow != null && compareRow != null) {
    String keyFields[]=meta.getKeyFields();
    int nrKeyFields=keyFields.length;
    for (int i=0; i < nrKeyFields; i++) {
      if (refRow.searchValueIndex(keyFields[i]) != compareRow.searchValueIndex(keyFields[i])) {
        return false;
      }
      Value refValue=refRow.searchValue(keyFields[i]);
      if (refValue == null) {
        return false;
      }
      Value compareValue=compareRow.searchValue(keyFields[i]);
      if (compareValue == null) {
        return false;
      }
      if (!refValue.equalValueType(compareValue)) {
        return false;
      }
    }
    String valueFields[]=meta.getValueFields();
    int nrValueFields=valueFields.length;
    for (int i=0; i < nrValueFields; i++) {
      if (refRow.searchValueIndex(valueFields[i]) != compareRow.searchValueIndex(valueFields[i])) {
        return false;
      }
      Value refValue=refRow.searchValue(valueFields[i]);
      if (refValue == null) {
        return false;
      }
      Value compareValue=compareRow.searchValue(valueFields[i]);
      if (compareValue == null) {
        return false;
      }
      if (!refValue.equalValueType(compareValue)) {
        return false;
      }
    }
  }
  return true;
}
