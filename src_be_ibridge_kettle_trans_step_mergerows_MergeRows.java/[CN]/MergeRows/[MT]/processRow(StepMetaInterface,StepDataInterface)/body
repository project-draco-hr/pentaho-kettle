{
  meta=(MergeRowsMeta)smi;
  data=(MergeRowsData)sdi;
  if (first) {
    first=false;
    data.one=getRowFrom(meta.getReferenceStepName());
    data.two=getRowFrom(meta.getCompareStepName());
  }
  if (data.one == null && data.two == null) {
    setOutputDone();
    return false;
  }
  if (data.one == null && data.two != null) {
    data.two.addValue(VALUE_NEW);
    putRow(data.two);
    data.two=getRowFrom(meta.getCompareStepName());
  }
 else   if (data.one != null && data.two == null) {
    data.one.addValue(VALUE_DELETED);
    putRow(data.one);
    data.one=getRowFrom(meta.getReferenceStepName());
  }
 else {
    int compare=data.one.compare(data.two);
    if (compare == 0) {
      data.one.addValue(VALUE_IDENTICAL);
      putRow(data.one);
      data.one=getRowFrom(meta.getReferenceStepName());
      data.two=getRowFrom(meta.getCompareStepName());
    }
 else {
      if (compare < 0) {
        data.one.addValue(VALUE_CHANGED);
        putRow(data.one);
        data.one=getRowFrom(meta.getReferenceStepName());
      }
 else {
      }
    }
  }
  if ((linesRead > 0) && (linesRead % Const.ROWS_UPDATE) == 0)   logBasic("linenr " + linesRead);
  return true;
}
