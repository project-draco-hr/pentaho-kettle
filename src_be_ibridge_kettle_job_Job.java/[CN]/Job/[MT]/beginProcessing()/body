{
  currentDate=new Date();
  logDate=new Date();
  startDate=Const.MIN_DATE;
  endDate=currentDate;
  resetErrors();
  DatabaseMeta logcon=jobMeta.getLogConnection();
  if (logcon != null && !Const.isEmpty(jobMeta.getLogTable())) {
    Database ldb=new Database(logcon);
    try {
      ldb.connect();
      Row lastr=ldb.getLastLogDate(jobMeta.getLogTable(),jobMeta.getName(),true,"end");
      if (lastr != null && lastr.size() > 0) {
        Value last=lastr.getValue(0);
        if (last != null && !last.isNull()) {
          startDate=last.getDate();
        }
      }
      depDate=currentDate;
      Value id_batch=new Value("ID_JOB",(long)1);
      if (jobMeta.isBatchIdUsed()) {
        ldb.getNextValue(null,jobMeta.getLogTable(),id_batch);
        jobMeta.setBatchId(id_batch.getInteger());
      }
      ldb.writeLogRecord(jobMeta.getLogTable(),jobMeta.isBatchIdUsed(),jobMeta.getBatchId(),true,jobMeta.getName(),"start",0L,0L,0L,0L,0L,0L,startDate,endDate,logDate,depDate,currentDate,log.getString());
      ldb.disconnect();
    }
 catch (    KettleDatabaseException dbe) {
      addErrors(1);
      throw new KettleJobException("Unable to begin processing by logging start in logtable " + jobMeta.getLogTable(),dbe);
    }
 finally {
      ldb.disconnect();
    }
  }
  return true;
}
