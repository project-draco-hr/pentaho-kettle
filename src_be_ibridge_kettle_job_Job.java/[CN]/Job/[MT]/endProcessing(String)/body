{
  long read=0L, written=0L, updated=0L, errors=0L, input=0L, output=0L;
  logDate=new Date();
  DatabaseMeta logcon=jobinfo.getLogConnection();
  if (logcon != null) {
    Database ldb=new Database(logcon);
    try {
      ldb.connect();
      ldb.writeLogRecord(jobinfo.logtable,false,0,true,jobinfo.getName(),status,read,written,updated,input,output,errors,startDate,endDate,logDate,depDate,currentDate,log.getString());
    }
 catch (    KettleDatabaseException dbe) {
      throw new KettleJobException("Unable to end processing by writing log record to table " + jobinfo.logtable,dbe);
    }
 finally {
      ldb.disconnect();
    }
  }
  return true;
}
