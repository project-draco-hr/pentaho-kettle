{
  StepErrorMeta stepErrorMeta=stepMeta.getStepErrorMeta();
  if (stepErrorMeta == null)   return;
  if (stepErrorMeta.getMaxErrors() > 0 && linesRejected > stepErrorMeta.getMaxErrors()) {
    logError(Messages.getString("BaseStep.Log.TooManyRejectedRows",Long.toString(stepErrorMeta.getMaxErrors()),Long.toString(linesRejected)));
    setErrors(1L);
    stopAll();
  }
  if (stepErrorMeta.getMaxPercentErrors() > 0 && linesRejected > 0 && (stepErrorMeta.getMinPercentRows() <= 0 || linesRead >= stepErrorMeta.getMinPercentRows())) {
    int pct=(int)(100 * linesRejected / linesRead);
    if (pct > stepErrorMeta.getMaxPercentErrors()) {
      logError(Messages.getString("BaseStep.Log.MaxPercentageRejectedReached",Integer.toString(pct),Long.toString(linesRejected),Long.toString(linesRead)));
      setErrors(1L);
      stopAll();
    }
  }
}
