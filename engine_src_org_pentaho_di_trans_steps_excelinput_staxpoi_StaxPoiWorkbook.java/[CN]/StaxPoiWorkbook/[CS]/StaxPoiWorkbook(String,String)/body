{
  try {
    OPCPackage pkg=OPCPackage.open(filename);
    reader=new XSSFReader(pkg);
    sheetNameIDMap=new HashMap<String,String>();
    List<String> sheetList=new ArrayList<String>();
    InputStream workbookData;
    workbookData=reader.getWorkbookData();
    XMLInputFactory factory=XMLInputFactory.newInstance();
    XMLStreamReader workbookReader=factory.createXMLStreamReader(workbookData);
    while (workbookReader.hasNext()) {
      if (workbookReader.next() == XMLStreamConstants.START_ELEMENT && workbookReader.getLocalName().equals("sheet")) {
        String sheetName=workbookReader.getAttributeValue(null,"name");
        String sheetID=workbookReader.getAttributeValue("http://schemas.openxmlformats.org/officeDocument/2006/relationships","id");
        sheetList.add(sheetName);
        sheetNameIDMap.put(sheetName,sheetID);
      }
    }
    workbookData.close();
  }
 catch (  Exception e) {
    throw new KettleException(e);
  }
  openSheetsMap=new HashMap<String,StaxPoiSheet>();
}
