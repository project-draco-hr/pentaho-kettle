{
  RowMetaInterface rowMeta=generateTestRowMeta();
  String fieldsClause="A, sum( B ) as \"Total sales\"";
  SQLFields fromFields=new SQLFields(rowMeta,fieldsClause);
  assertFalse(fromFields.isDistinct());
  assertEquals(2,fromFields.getFields().size());
  SQLField field=fromFields.getFields().get(0);
  assertEquals("A",field.getName());
  assertNull(field.getAlias());
  assertNotNull("The service data type was not discovered",field.getValueMeta());
  assertEquals("A",field.getValueMeta().getName().toUpperCase());
  field=fromFields.getFields().get(1);
  assertEquals("B",field.getName());
  assertEquals("Total sales",field.getAlias());
  assertNotNull("The service data type was not discovered",field.getValueMeta());
  assertEquals("B",field.getValueMeta().getName().toUpperCase());
}
