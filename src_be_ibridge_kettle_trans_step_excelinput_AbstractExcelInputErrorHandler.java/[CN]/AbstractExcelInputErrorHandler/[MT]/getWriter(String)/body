{
  Writer outputStreamWriter=(Writer)writers.get(sheetName);
  if (outputStreamWriter != null)   return outputStreamWriter;
  File directory=new File(Const.replEnv(destinationDirectory));
  String name=null;
  if (fileExtension == null || fileExtension.length() == 0)   name=processingFilename + "_" + sheetName;
 else   name=processingFilename + "_" + sheetName+ "."+ fileExtension;
  File file=new File(directory,name);
  try {
    if (encoding == null)     outputStreamWriter=new OutputStreamWriter(new FileOutputStream(file));
 else     outputStreamWriter=new OutputStreamWriter(new FileOutputStream(file),encoding);
  }
 catch (  Exception e) {
    throw new KettleException("Could not create TextFileLineErrorHandler for file:" + file.getPath(),e);
  }
  writers.put(sheetName,outputStreamWriter);
  return outputStreamWriter;
}
