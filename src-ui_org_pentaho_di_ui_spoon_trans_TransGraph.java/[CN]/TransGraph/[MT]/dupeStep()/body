{
  try {
    if (transMeta.nrSelectedSteps() <= 1) {
      spoon.dupeStep(transMeta,getCurrentStep());
    }
 else {
      for (int i=0; i < transMeta.nrSteps(); i++) {
        StepMeta stepMeta=transMeta.getStep(i);
        if (stepMeta.isSelected()) {
          spoon.dupeStep(transMeta,stepMeta);
        }
      }
    }
  }
 catch (  Exception ex) {
    new ErrorDialog(shell,Messages.getString("TransGraph.Dialog.ErrorDuplicatingStep.Title"),Messages.getString("TransGraph.Dialog.ErrorDuplicatingStep.Message"),ex);
  }
}
