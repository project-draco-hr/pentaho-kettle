{
  if (transMeta == null)   return false;
  TransDialog tid=new TransDialog(spoon.getShell(),SWT.NONE,transMeta,rep,currentTab);
  tid.setDirectoryChangeAllowed(allowDirectoryChange);
  TransMeta ti=tid.open();
  if (tid.isSharedObjectsFileChanged()) {
    try {
      SharedObjects sharedObjects=transMeta.readSharedObjects(rep);
      spoon.sharedObjectsFileMap.put(sharedObjects.getFilename(),sharedObjects);
    }
 catch (    Exception e) {
      new ErrorDialog(spoon.getShell(),Messages.getString("Spoon.Dialog.ErrorReadingSharedObjects.Title"),Messages.getString("Spoon.Dialog.ErrorReadingSharedObjects.Message",spoon.makeTransGraphTabName(transMeta)),e);
    }
  }
  if (tid.isSharedObjectsFileChanged() || ti != null) {
    try {
      SharedObjects sharedObjects=transMeta.readSharedObjects(rep);
      spoon.sharedObjectsFileMap.put(sharedObjects.getFilename(),sharedObjects);
    }
 catch (    KettleException e) {
      new ErrorDialog(spoon.getShell(),Messages.getString("Spoon.Dialog.ErrorReadingSharedObjects.Title"),Messages.getString("Spoon.Dialog.ErrorReadingSharedObjects.Message",spoon.makeTransGraphTabName(transMeta)),e);
    }
    spoon.refreshTree();
    spoon.delegates.tabs.renameTabs();
  }
  spoon.setShellText();
  return ti != null;
}
