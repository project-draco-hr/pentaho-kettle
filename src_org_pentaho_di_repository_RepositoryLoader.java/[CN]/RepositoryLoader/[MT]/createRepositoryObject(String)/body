{
  try {
    RepositoryPluginMeta meta=findPluginMeta(id);
    if (meta == null) {
      throw new Exception("Unable to find repository plugin meta with type [" + id + "]");
    }
    ClassLoader classLoader=getClassLoader(meta);
    Class<?> repositoryClass=classLoader.loadClass(meta.getClassName());
    Object object=repositoryClass.newInstance();
    if (!(object instanceof Repository)) {
      throw new Exception("Repository plugin class name [" + meta.getClassName() + "] does not implement the Repository interface");
    }
    return (Repository)object;
  }
 catch (  Exception e) {
    throw new KettleException("Unable to create a repository object for repository type id [" + id + "]",e);
  }
}
