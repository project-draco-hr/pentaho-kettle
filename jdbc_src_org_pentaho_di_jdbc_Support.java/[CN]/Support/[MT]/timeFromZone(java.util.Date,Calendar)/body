{
synchronized (cal) {
    java.util.Date tmp=target.getTime();
    try {
      target.setTime(value);
      cal.set(Calendar.HOUR_OF_DAY,target.get(Calendar.HOUR_OF_DAY));
      cal.set(Calendar.MINUTE,target.get(Calendar.MINUTE));
      cal.set(Calendar.SECOND,target.get(Calendar.SECOND));
      cal.set(Calendar.MILLISECOND,target.get(Calendar.MILLISECOND));
      cal.set(Calendar.YEAR,target.get(Calendar.YEAR));
      cal.set(Calendar.MONTH,target.get(Calendar.MONTH));
      cal.set(Calendar.DAY_OF_MONTH,target.get(Calendar.DAY_OF_MONTH));
      return cal.getTime().getTime();
    }
  finally {
      target.setTime(tmp);
    }
  }
}
