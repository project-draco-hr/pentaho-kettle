{
  int i;
  Value v;
  long dat;
  for (i=0; i < r.size(); i++) {
    v=r.getValue(i);
    try {
      setValue(ps,v,i + 1);
    }
 catch (    KettleDatabaseException e) {
      throw new KettleDatabaseException("Unable to set value #" + i + " on dimension using row :"+ r,e);
    }
  }
  if (dateval != null && dateval.getDate() != null && !dateval.isNull()) {
    dat=dateval.getDate().getTime();
  }
 else {
    Calendar cal=Calendar.getInstance();
    dat=cal.getTime().getTime();
  }
  java.sql.Timestamp sdate=new java.sql.Timestamp(dat);
  try {
    ps.setTimestamp(r.size() + 1,sdate);
    ps.setTimestamp(r.size() + 2,sdate);
  }
 catch (  SQLException ex) {
    throw new KettleDatabaseException("Unable to set timestamp on fromdate or todate",ex);
  }
}
