{
  String path="";
  try {
    File file=new File("simple-jndi");
    path=file.getCanonicalPath();
  }
 catch (  Exception e) {
    throw new KettleDatabaseException(e);
  }
  System.setProperty("java.naming.factory.initial","org.osjava.sj.SimpleContextFactory");
  System.setProperty("org.osjava.sj.root",path);
  System.setProperty("org.osjava.sj.delimiter","/");
  connection=null;
  try {
    DataSource dataSource=DatabaseUtil.getDataSourceFromJndi(jndiName);
    if (dataSource != null) {
      connection=dataSource.getConnection();
      if (connection == null) {
        throw new KettleDatabaseException("Invalid JNDI connection " + jndiName);
      }
    }
 else {
      throw new KettleDatabaseException("Invalid JNDI connection " + jndiName);
    }
  }
 catch (  Exception e) {
    throw new KettleDatabaseException("Invalid JNDI connection " + jndiName + " : "+ e.getMessage());
  }
}
