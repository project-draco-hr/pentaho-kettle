{
  try {
    Class.forName(olap4jDriver);
    OlapConnection connection=null;
    String uname=space.environmentSubstitute(username);
    String pwd=space.environmentSubstitute(password);
    if (Const.isEmpty(pwd) && Const.isEmpty(uname)) {
      connection=(OlapConnection)DriverManager.getConnection(olap4jUrl);
    }
 else {
      connection=(OlapConnection)DriverManager.getConnection(olap4jUrl,uname,pwd);
    }
    OlapWrapper wrapper=connection;
    olapConnection=wrapper.unwrap(OlapConnection.class);
    try {
      if (!Const.isEmpty(catalogName)) {
        olapConnection.setCatalog(catalogName);
      }
    }
 catch (    SQLException e) {
      throw new OlapException("Error setting catalog for MDX statement: '" + catalogName + "'");
    }
    OlapStatement stmt=olapConnection.createStatement();
    if (!Const.isEmpty(mdx)) {
      result=stmt.executeOlapQuery(mdx);
    }
 else {
      throw new Exception("Error executing empty MDX query");
    }
  }
 catch (  Exception e) {
    throw e;
  }
}
