{
  meta=(AbortMeta)smi;
  data=(AbortData)sdi;
  Object[] r=getRow();
  if (r == null) {
    setOutputDone();
    return false;
  }
 else {
    putRow(getInputRowMeta(),r);
    nrInputRows++;
    if (nrInputRows > nrThresholdRows) {
      logMinimal(Messages.getString("Abort.Log.Wrote.AbortRow",Long.toString(nrInputRows),r.toString()));
      String message=environmentSubstitute(meta.getMessage());
      if (message == null || message.length() == 0) {
        logMinimal(Messages.getString("Abort.Log.DefaultAbortMessage","" + nrInputRows));
      }
 else {
        logMinimal(message);
      }
      setErrors(1);
      stopAll();
    }
 else {
      if (meta.isAlwaysLogRows()) {
        logMinimal(Messages.getString("Abort.Log.Wrote.Row",Long.toString(nrInputRows),r.toString()));
      }
 else {
        if (log.isRowLevel()) {
          logRowlevel(Messages.getString("Abort.Log.Wrote.Row",Long.toString(nrInputRows),r.toString()));
        }
      }
    }
  }
  return true;
}
