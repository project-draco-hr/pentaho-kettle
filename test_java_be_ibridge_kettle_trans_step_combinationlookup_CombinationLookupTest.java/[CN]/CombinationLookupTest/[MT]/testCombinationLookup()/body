{
  LogWriter log=LogWriter.getInstance();
  EnvUtil.environmentInit();
  try {
    TransMeta transMeta=new TransMeta();
    transMeta.setName("transname");
    for (int i=0; i < databasesXML.length; i++) {
      DatabaseMeta databaseMeta=new DatabaseMeta(databasesXML[i]);
      transMeta.addDatabase(databaseMeta);
    }
    DatabaseMeta lookupDBInfo=transMeta.findDatabase("lookup");
    Database lookupDatabase=new Database(lookupDBInfo);
    lookupDatabase.connect();
    createTables(lookupDatabase);
    createData(lookupDatabase);
    StepLoader steploader=StepLoader.getInstance();
    String fromstepname="read from [" + source_table + "]";
    TableInputMeta tii=new TableInputMeta();
    tii.setDatabaseMeta(transMeta.findDatabase("lookup"));
    String selectSQL="SELECT " + Const.CR;
    selectSQL+="DLR_CD, DLR_NM, DLR_DESC ";
    selectSQL+="FROM " + source_table + " ORDER BY ORDNO;";
    tii.setSQL(selectSQL);
    String fromstepid=steploader.getStepPluginID(tii);
    StepMeta fromstep=new StepMeta(log,fromstepid,fromstepname,(StepMetaInterface)tii);
    fromstep.setLocation(150,100);
    fromstep.setDraw(true);
    fromstep.setDescription("Reads information from table [" + source_table + "] on database ["+ lookupDBInfo+ "]");
    transMeta.addStep(fromstep);
    String lookupstepname="lookup from [lookup]";
    CombinationLookupMeta clm=new CombinationLookupMeta();
    String lookupKey[]={"DLR_CD"};
    clm.setTablename(target_table);
    clm.setKeyField(lookupKey);
    clm.setKeyLookup(lookupKey);
    clm.setTechnicalKeyField("ID");
    clm.setTechKeyCreation(CombinationLookupMeta.CREATION_METHOD_TABLEMAX);
    clm.setDatabase(lookupDBInfo);
    String lookupstepid=steploader.getStepPluginID(clm);
    StepMeta lookupstep=new StepMeta(log,lookupstepid,lookupstepname,(StepMetaInterface)clm);
    lookupstep.setDescription("Looks up information from table [lookup] on database [" + lookupDBInfo + "]");
    transMeta.addStep(lookupstep);
    TransHopMeta hi=new TransHopMeta(fromstep,lookupstep);
    transMeta.addTransHop(hi);
    Trans trans=new Trans(log,transMeta);
    trans.execute(null);
    trans.waitUntilFinished();
    checkResults(lookupDatabase);
  }
 catch (  Exception ex) {
    System.out.println(ex);
  }
}
