{
  if (monitor != null) {
    monitor.beginTask(Messages.getString("TransMeta.Monitor.DeterminingImpactTask.Title"),nrSteps());
  }
  boolean stop=false;
  for (int i=0; i < nrSteps() && !stop; i++) {
    if (monitor != null)     monitor.subTask(Messages.getString("TransMeta.Monitor.LookingAtStepTask.Title") + (i + 1) + "/"+ nrSteps());
    StepMeta stepMeta=getStep(i);
    Row prev=getPrevStepFields(stepMeta);
    StepMetaInterface stepint=stepMeta.getStepMetaInterface();
    Row inform=null;
    StepMeta[] lu=getInfoStep(stepMeta);
    if (lu != null) {
      inform=getStepFields(lu);
    }
 else {
      inform=stepint.getTableFields();
    }
    stepint.analyseImpact(impact,this,stepMeta,prev,null,null,inform);
    if (monitor != null) {
      monitor.worked(1);
      stop=monitor.isCanceled();
    }
  }
  if (monitor != null)   monitor.done();
}
