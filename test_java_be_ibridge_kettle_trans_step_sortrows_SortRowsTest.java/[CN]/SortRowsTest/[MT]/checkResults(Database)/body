{
  String query="SELECT ID, KEY1, KEY2 FROM " + target_table + " ORDER BY ID;";
  String prev_key1=null, prev_key2=null;
  ResultSet rs=db.openQuery(query);
  int idx=0;
  while (rs.next()) {
    String key1=rs.getString("KEY1");
    String key2=rs.getString("KEY2");
    if (prev_key1 != null && prev_key2 != null) {
      if (prev_key1.compareTo(key1) == 0) {
        if (prev_key2.compareTo(key2) > 0) {
          fail("error in sort");
        }
      }
 else       if (prev_key1.compareTo(key1) > 0) {
        fail("error in sort");
      }
    }
    prev_key1=key1;
    prev_key2=key2;
    idx++;
  }
  if (idx != MAX_COUNT) {
    fail("less rows returned than expected" + idx);
  }
}
