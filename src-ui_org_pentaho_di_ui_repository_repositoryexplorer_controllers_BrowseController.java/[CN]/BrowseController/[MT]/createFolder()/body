{
  Collection<UIRepositoryDirectory> directories=folderTree.getSelectedItems();
  if (directories == null || directories.size() == 0) {
    return;
  }
  UIRepositoryDirectory selectedFolder=directories.iterator().next();
  XulPromptBox prompt=promptForName(null);
  prompt.addDialogCallback(new XulDialogCallback<String>(){
    public void onClose(    XulComponent component,    Status status,    String value){
      newName=value;
    }
    public void onError(    XulComponent component,    Throwable err){
      System.out.println(err.getMessage());
    }
  }
);
  prompt.open();
  if (newName != null) {
    if (selectedFolder == null) {
      selectedFolder=repositoryDirectory;
    }
    UIRepositoryDirectory newDirectory=selectedFolder.createFolder(newName);
    directoryBinding.fireSourceChanged();
    selectedItemsBinding.fireSourceChanged();
    this.folderTree.setSelectedItems(Collections.singletonList(selectedFolder));
  }
  newName=null;
}
