{
  this.log=log;
  try {
    clear();
    directory=repdir;
    setID(rep.getJobID(jobname,repdir.getID()));
    if (getID() > 0) {
      long noteids[]=rep.getJobNoteIDs(getID());
      long jecids[]=rep.getJobEntryCopyIDs(getID());
      long hopid[]=rep.getJobHopIDs(getID());
      int nrWork=2 + noteids.length + jecids.length+ hopid.length;
      if (monitor != null)       monitor.beginTask("Loading job " + repdir + Const.FILE_SEPARATOR+ jobname,nrWork);
      if (monitor != null)       monitor.subTask("Reading the available database from the repository");
      readDatabases(rep);
      if (monitor != null)       monitor.worked(1);
      if (monitor != null)       monitor.subTask("Reading the job information");
      Row jobrow=rep.getJob(getID());
      name=jobrow.searchValue("NAME").getString();
      logtable=jobrow.searchValue("TABLE_NAME_LOG").getString();
      long id_logdb=jobrow.searchValue("ID_DATABASE_LOG").getInteger();
      if (id_logdb > 0) {
        logconnection=new DatabaseMeta(rep,id_logdb);
      }
      if (monitor != null)       monitor.worked(1);
      log.logDetailed(toString(),"Loading " + noteids.length + " notes");
      for (int i=0; i < noteids.length; i++) {
        if (monitor != null)         monitor.subTask("Reading note #" + (i + 1) + "/"+ noteids.length);
        NotePadMeta ni=new NotePadMeta(log,rep,noteids[i]);
        if (indexOfNote(ni) < 0)         addNote(ni);
        if (monitor != null)         monitor.worked(1);
      }
      log.logDetailed(toString(),"Loading " + jecids.length + " job entries");
      for (int i=0; i < jecids.length; i++) {
        if (monitor != null)         monitor.subTask("Reading job entry #" + (i + 1) + "/"+ (jecids.length));
        JobEntryCopy jec=new JobEntryCopy(log,rep,getID(),jecids[i],jobentries,databases);
        int idx=indexOfJobEntry(jec);
        if (idx < 0) {
          if (jec.getName() != null && jec.getName().length() > 0)           addJobEntry(jec);
        }
 else {
          setJobEntry(idx,jec);
        }
        if (monitor != null)         monitor.worked(1);
      }
      log.logDetailed(toString(),"Loading " + hopid.length + " job hops");
      for (int i=0; i < hopid.length; i++) {
        if (monitor != null)         monitor.subTask("Reading job hop #" + (i + 1) + "/"+ (jecids.length));
        JobHopMeta hi=new JobHopMeta(rep,hopid[i],this,jobcopies);
        jobhops.add(hi);
        if (monitor != null)         monitor.worked(1);
      }
      clearChanged();
      if (monitor != null)       monitor.subTask("Finishing load");
      if (monitor != null)       monitor.done();
    }
 else {
      throw new KettleException("Can't find job : " + jobname);
    }
  }
 catch (  KettleException dbe) {
    throw new KettleException("An error occurred reading job [" + jobname + "] from the repository",dbe);
  }
}
