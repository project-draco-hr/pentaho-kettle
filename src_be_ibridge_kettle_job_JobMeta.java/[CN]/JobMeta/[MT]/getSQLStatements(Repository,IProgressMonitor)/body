{
  if (monitor != null)   monitor.beginTask("Getting the SQL needed for this job...",nrJobEntries() + 1);
  ArrayList stats=new ArrayList();
  for (int i=0; i < nrJobEntries(); i++) {
    JobEntryCopy copy=getJobEntry(i);
    if (monitor != null)     monitor.subTask("Getting SQL statements for job entry copy [" + copy + "]");
    ArrayList list=copy.getEntry().getSQLStatements(repository);
    stats.addAll(list);
    if (monitor != null)     monitor.worked(1);
  }
  if (monitor != null)   monitor.subTask("Getting SQL statements for the job (logtable, etc.)");
  if (logconnection != null && logTable != null && logTable.length() > 0) {
    Database db=new Database(logconnection);
    try {
      db.connect();
      Row fields=Database.getJobLogrecordFields(useBatchId,logfieldUsed);
      String sql=db.getDDL(logTable,fields);
      if (sql != null && sql.length() > 0) {
        SQLStatement stat=new SQLStatement("<this job>",logconnection,sql);
        stats.add(stat);
      }
    }
 catch (    KettleDatabaseException dbe) {
      SQLStatement stat=new SQLStatement("<this job>",logconnection,null);
      stat.setError("Error obtaining job log table info: " + dbe.getMessage());
      stats.add(stat);
    }
 finally {
      db.disconnect();
    }
  }
  if (monitor != null)   monitor.worked(1);
  if (monitor != null)   monitor.done();
  return stats;
}
