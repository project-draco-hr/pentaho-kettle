{
  DatabaseMeta ci=getLogConnection();
  StringBuffer retval=new StringBuffer();
  retval.append("<job>" + Const.CR);
  retval.append("  " + XMLHandler.addTagValue("name",getName()));
  retval.append("  " + XMLHandler.addTagValue("directory",directory.getPath()));
  for (int i=0; i < nrDatabases(); i++) {
    DatabaseMeta dbinfo=getDatabase(i);
    retval.append(dbinfo.getXML());
  }
  retval.append("  " + XMLHandler.addTagValue("logconnection",ci == null ? "" : ci.getName()));
  retval.append("  " + XMLHandler.addTagValue("logtable",logtable));
  retval.append("   " + XMLHandler.addTagValue("use_batchid",useBatchId));
  retval.append("   " + XMLHandler.addTagValue("pass_batchid",batchIdPassed));
  retval.append("   " + XMLHandler.addTagValue("use_logfield",logfieldUsed));
  retval.append("  <entries>" + Const.CR);
  for (int i=0; i < nrJobEntries(); i++) {
    JobEntryCopy jge=getJobEntry(i);
    retval.append(jge.getXML());
  }
  retval.append("    </entries>" + Const.CR);
  retval.append("  <hops>" + Const.CR);
  for (int i=0; i < nrJobHops(); i++) {
    JobHopMeta hi=getJobHop(i);
    retval.append(hi.getXML());
  }
  retval.append("    </hops>" + Const.CR);
  retval.append("  <notepads>" + Const.CR);
  for (int i=0; i < nrNotes(); i++) {
    NotePadMeta ni=getNote(i);
    retval.append(ni.getXML());
  }
  retval.append("    </notepads>" + Const.CR);
  retval.append("  </job>" + Const.CR);
  return retval.toString();
}
