{
  if (!running) {
    try {
      log.setLogLevel(executionConfiguration.getLogLevel());
      log.logDetailed(toString(),Messages.getString("SpoonLog.Log.DoPreview"));
      String[] args=null;
      Map<String,String> arguments=executionConfiguration.getArguments();
      if (arguments != null) {
        args=convertArguments(arguments);
      }
      setVariables(executionConfiguration);
      trans=new Trans(transMeta);
      trans.setPreview(true);
      trans.setPreviewSteps(executionConfiguration.getPreviewSteps());
      trans.setPreviewSizes(executionConfiguration.getPreviewSizes());
      trans.setPreview(true);
      trans.setSafeModeEnabled(executionConfiguration.isSafeModeEnabled());
      trans.execute(args);
      preview=true;
      readLog();
      running=!running;
      wStart.setEnabled(false);
      wStop.setEnabled(true);
    }
 catch (    Exception e) {
      new ErrorDialog(shell,Messages.getString("SpoonLog.Dialog.UnexpectedErrorDuringPreview.Title"),Messages.getString("SpoonLog.Dialog.UnexpectedErrorDuringPreview.Message"),e);
    }
  }
 else {
    MessageBox m=new MessageBox(shell,SWT.OK | SWT.ICON_WARNING);
    m.setText(Messages.getString("SpoonLog.Dialog.DoNoPreviewWhileRunning.Title"));
    m.setMessage(Messages.getString("SpoonLog.Dialog.DoNoPreviewWhileRunning.Message"));
    m.open();
  }
}
