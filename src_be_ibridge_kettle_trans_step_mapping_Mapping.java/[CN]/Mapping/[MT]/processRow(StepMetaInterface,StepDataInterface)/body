{
  meta=(MappingMeta)smi;
  data=(MappingData)sdi;
  Row r=getRow();
  if (r == null) {
    data.mappingInput.setOutputDone();
    data.mappingInput.setFinished();
    return false;
  }
  if (first) {
    first=false;
    data.renameFieldIndexes=new ArrayList();
    data.renameFieldNames=new ArrayList();
    for (int i=0; i < meta.getInputField().length; i++) {
      if (meta.getInputField()[i] != null && meta.getInputField()[i].length() > 0) {
        if (meta.getInputMapping()[i] != null && meta.getInputMapping()[i].length() > 0) {
          if (!meta.getInputField()[i].equals(meta.getInputMapping()[i])) {
            int idx=r.searchValueIndex(meta.getInputField()[i]);
            if (idx < 0) {
              logError("Mapping target field [" + meta.getInputField()[i] + "] is not present in the input rows!");
              setErrors(1);
              stopAll();
              data.trans.stopAll();
              return false;
            }
            data.renameFieldIndexes.add(new Integer(idx));
            data.renameFieldNames.add(meta.getInputMapping()[i]);
            if (log.isRowLevel())             logRowlevel("#" + data.renameFieldIndexes.size() + " : index="+ i+ ", new name="+ meta.getInputMapping()[i]);
          }
        }
 else {
          logError("Mapping target field #" + i + " is not specified for input ["+ meta.getInputField()[i]+ "]!");
          setErrors(1);
          stopAll();
          data.trans.stopAll();
          return false;
        }
      }
 else {
        logError("Input field #" + i + " is not specified!");
        setErrors(1);
        stopAll();
        data.trans.stopAll();
        return false;
      }
    }
  }
  for (int i=0; i < data.renameFieldIndexes.size(); i++) {
    int idx=((Integer)data.renameFieldIndexes.get(i)).intValue();
    String newName=(String)data.renameFieldNames.get(i);
    r.getValue(idx).setName(newName);
  }
  data.mappingInput.putRow(r);
  if ((linesRead > 0) && (linesRead % Const.ROWS_UPDATE) == 0)   logBasic("Linenr " + linesRead);
  return true;
}
