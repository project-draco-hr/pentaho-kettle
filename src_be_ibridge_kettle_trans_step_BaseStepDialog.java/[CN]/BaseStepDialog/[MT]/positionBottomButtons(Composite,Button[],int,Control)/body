{
  Rectangle largest=null;
  for (int i=0; i < buttons.length; i++) {
    buttons[i].pack(true);
    Rectangle r=buttons[i].getBounds();
    if (largest == null || r.width > largest.width)     largest=r;
    if (buttons[i].getToolTipText() == null) {
      buttons[i].setToolTipText(Const.replace(buttons[i].getText(),"&",""));
    }
  }
  largest.width+=10;
  if ((largest.width % 2) == 1)   largest.width++;
  int middle_left=0;
  int middle_right=0;
  int middle=buttons.length / 2;
  if ((buttons.length % 2) != 0) {
    middle_left=middle;
    middle_right=middle;
    FormData fd1=new FormData();
    fd1.left=new FormAttachment(50,-(largest.width + margin) / 2);
    fd1.right=new FormAttachment(50,(largest.width + margin) / 2);
    if (lastControl != null)     fd1.top=new FormAttachment(lastControl,margin * 3);
    if (lastControl == null)     fd1.bottom=new FormAttachment(100,0);
    buttons[middle].setLayoutData(fd1);
  }
 else {
    middle_left=middle - 1;
    middle_right=middle;
    FormData fd1=new FormData();
    fd1.left=new FormAttachment(50,-(largest.width + margin) - margin);
    fd1.right=new FormAttachment(50,-margin);
    if (lastControl != null)     fd1.top=new FormAttachment(lastControl,margin * 3);
    if (lastControl == null)     fd1.bottom=new FormAttachment(100,0);
    buttons[middle_left].setLayoutData(fd1);
    FormData fd2=new FormData();
    fd2.left=new FormAttachment(buttons[middle_left],margin);
    fd2.right=new FormAttachment(buttons[middle_right],largest.width + margin);
    if (lastControl != null)     fd2.top=new FormAttachment(lastControl,margin * 3);
    if (lastControl == null)     fd2.bottom=new FormAttachment(100,0);
    buttons[middle_right].setLayoutData(fd2);
  }
  for (int ydx=middle_right + 1; ydx < buttons.length; ydx++) {
    FormData fd=new FormData();
    fd.left=new FormAttachment(buttons[ydx - 1],margin);
    fd.right=new FormAttachment(buttons[ydx],largest.width + margin);
    if (lastControl != null)     fd.top=new FormAttachment(lastControl,margin * 3);
    if (lastControl == null)     fd.bottom=new FormAttachment(100,0);
    buttons[ydx].setLayoutData(fd);
  }
  for (int zdx=middle_left - 1; zdx >= 0; zdx--) {
    FormData fd=new FormData();
    fd.left=new FormAttachment(buttons[zdx + 1],-(2 * (largest.width + margin)) - margin);
    fd.right=new FormAttachment(buttons[zdx],largest.width + margin);
    if (lastControl != null)     fd.top=new FormAttachment(lastControl,margin * 3);
    if (lastControl == null)     fd.bottom=new FormAttachment(100,0);
    buttons[zdx].setLayoutData(fd);
  }
}
