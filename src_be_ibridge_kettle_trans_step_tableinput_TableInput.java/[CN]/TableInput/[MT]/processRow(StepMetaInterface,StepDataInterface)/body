{
  if (first) {
    Row parameters;
    first=false;
    if (meta.getInfoSteps() != null) {
      if (meta.isExecuteEachInputRow()) {
        if (log.isDetailed())         logDetailed("Reading single row from stream [" + meta.getLookupStepname() + "]");
        parameters=getRowFrom(meta.getLookupStepname());
        if (log.isDetailed())         logDetailed("Query parameters found = " + parameters.toString());
      }
 else {
        if (log.isDetailed())         logDetailed("Reading query parameters from stream [" + meta.getLookupStepname() + "]");
        parameters=readStartDate();
        if (log.isDetailed())         logDetailed("Query parameters found = " + parameters.toString());
      }
    }
 else {
      parameters=new Row();
    }
    boolean success=doQuery(parameters);
    if (!success) {
      return false;
    }
  }
 else {
    if (data.thisrow != null) {
      data.nextrow=data.db.getRow(data.rs);
      if (data.nextrow != null)       linesInput++;
    }
  }
  if (data.thisrow == null) {
    boolean done=false;
    if (meta.isExecuteEachInputRow()) {
      Row nextRow=getRowFrom(meta.getLookupStepname());
      if (nextRow == null) {
        done=true;
      }
 else {
        closePreviousQuery();
        boolean success=doQuery(nextRow);
        if (!success) {
          return false;
        }
      }
    }
 else {
      done=true;
    }
    if (done) {
      setOutputDone();
      return false;
    }
  }
  if (data.thisrow != null) {
    putRow(data.thisrow);
    data.thisrow=data.nextrow;
    if ((linesInput > 0) && (linesInput % Const.ROWS_UPDATE) == 0)     logBasic("linenr " + linesInput);
  }
  return true;
}
