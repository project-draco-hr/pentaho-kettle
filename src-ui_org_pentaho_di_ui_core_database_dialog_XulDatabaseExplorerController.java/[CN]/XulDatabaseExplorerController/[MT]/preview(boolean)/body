{
  try {
    PromptCallback theCallback=new PromptCallback();
    boolean execute=true;
    if (askLimit) {
      XulPromptBox thePromptBox=(XulPromptBox)this.document.createElement("promptbox");
      thePromptBox.setModalParent(this.dbExplorerDialog.getShell());
      thePromptBox.setTitle("Enter Max Rows");
      thePromptBox.setMessage("Max Rows:");
      thePromptBox.addDialogCallback(theCallback);
      thePromptBox.open();
      execute=theCallback.getLimit() != -1;
    }
    GetPreviewTableProgressDialog pd=new GetPreviewTableProgressDialog(shell,this.model.getDatabaseMeta(),this.model.getTable(),theCallback.getLimit());
    List<Object[]> rows=pd.open();
    if (rows != null) {
      if (rows.size() > 0) {
        PreviewRowsDialog prd=new PreviewRowsDialog(shell,this.model.getDatabaseMeta(),SWT.None,this.model.getTable(),pd.getRowMeta(),rows);
        prd.open();
      }
 else {
        MessageBox mb=new MessageBox(shell,SWT.ICON_INFORMATION | SWT.OK);
        mb.setMessage(BaseMessages.getString(PKG,"DatabaseExplorerDialog.NoRows.Message"));
        mb.setText(BaseMessages.getString(PKG,"DatabaseExplorerDialog.NoRows.Title"));
        mb.open();
      }
    }
  }
 catch (  Exception e) {
    logger.error(e);
  }
}
