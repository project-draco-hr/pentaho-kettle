{
  if (data.bufferIndex == 0)   return;
  try {
    StringBuffer cmdBuff=new StringBuffer();
    cmdBuff.append("COPY ").append(data.bufferIndex).append(" RECORDS INTO ").append(data.schemaTable).append(" FROM STDIN USING DELIMITERS '").append(new String(data.separator)).append("','\\n','").append(new String(data.quote)).append("';");
    String cmd=cmdBuff.toString();
    if (log.isDetailed())     logDetailed(cmd);
    data.monetOutputStream.write(cmd.getBytes());
    for (int i=0; i < data.bufferIndex; i++) {
      data.monetOutputStream.write(data.rowBuffer[i]);
      if (log.isRowLevel())       logRowlevel(new String(data.rowBuffer[i]));
    }
    if (log.isRowLevel())     logRowlevel(Const.CR);
    data.bufferIndex=0;
  }
 catch (  Exception e) {
    throw new KettleException("An error occurred writing data to the mclient process",e);
  }
}
