{
  if (data.bufferIndex == 0)   return;
  try {
    String cmd="COPY " + data.bufferIndex + " RECORDS INTO "+ data.schemaTable+ " FROM STDIN;";
    if (log.isDetailed())     logDetailed(cmd);
    data.monetOutputStream.write(cmd.getBytes());
    for (int i=0; i < data.bufferIndex; i++) {
      data.monetOutputStream.write(data.rowBuffer[i]);
      if (log.isRowLevel())       logRowlevel(new String(data.rowBuffer[i]));
    }
    data.monetOutputStream.write(Const.CR.getBytes());
    if (log.isRowLevel())     logRowlevel(Const.CR);
    data.bufferIndex=0;
  }
 catch (  Exception e) {
    throw new KettleException("An error occurred writing data to the mclient process",e);
  }
}
