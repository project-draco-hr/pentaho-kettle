{
  SoapBindingStub binding=null;
  LoginResult loginResult=null;
  GetUserInfoResult userInfo=null;
  try {
    binding=(SoapBindingStub)new SforceServiceLocator().getSoap();
    if (log.isDetailed())     logDetailed(BaseMessages.getString(PKG,"SalesforceInput.Log.LoginURL") + " : " + binding._getProperty(SoapBindingStub.ENDPOINT_ADDRESS_PROPERTY));
    int timeOut=Const.toInt(timeout,0);
    if (timeOut > 0)     binding.setTimeout(timeOut);
    binding._setProperty(SoapBindingStub.ENDPOINT_ADDRESS_PROPERTY,Url);
    if (log.isDetailed()) {
      logDetailed(BaseMessages.getString(PKG,"SalesforceInput.Log.LoginNow"));
      logDetailed("----------------------------------------->");
      logDetailed(BaseMessages.getString(PKG,"SalesforceInput.Log.LoginURL",Url));
      logDetailed(BaseMessages.getString(PKG,"SalesforceInput.Log.LoginUsername",username));
      logDetailed(BaseMessages.getString(PKG,"SalesforceInput.Log.LoginModule",module));
      if (!Const.isEmpty(condition))       logDetailed(BaseMessages.getString(PKG,"SalesforceInput.Log.LoginCondition",condition));
      logDetailed("<-----------------------------------------");
    }
    loginResult=binding.login(username,password);
    if (log.isDebug()) {
      logDebug(BaseMessages.getString(PKG,"SalesforceInput.Log.SessionId") + " : " + loginResult.getSessionId());
      logDebug(BaseMessages.getString(PKG,"SalesforceInput.Log.NewServerURL") + " : " + loginResult.getServerUrl());
    }
    binding._setProperty(SoapBindingStub.ENDPOINT_ADDRESS_PROPERTY,loginResult.getServerUrl());
    SessionHeader sh=new SessionHeader();
    sh.setSessionId(loginResult.getSessionId());
    binding.setHeader(new SforceServiceLocator().getServiceName().getNamespaceURI(),"SessionHeader",sh);
    userInfo=binding.getUserInfo();
    if (log.isDebug()) {
      logDebug(BaseMessages.getString(PKG,"SalesforceInput.Log.UserInfos") + " : " + userInfo.getUserFullName());
      logDebug("----------------------------------------->");
      logDebug(BaseMessages.getString(PKG,"SalesforceInput.Log.UserName") + " : " + userInfo.getUserFullName());
      logDebug(BaseMessages.getString(PKG,"SalesforceInput.Log.UserEmail") + " : " + userInfo.getUserEmail());
      logDebug(BaseMessages.getString(PKG,"SalesforceInput.Log.UserLanguage") + " : " + userInfo.getUserLanguage());
      logDebug(BaseMessages.getString(PKG,"SalesforceInput.Log.UserOrganization") + " : " + userInfo.getOrganizationName());
      logDebug("<-----------------------------------------");
    }
  }
 catch (  Exception e) {
    throw new KettleException(e);
  }
  return binding;
}
