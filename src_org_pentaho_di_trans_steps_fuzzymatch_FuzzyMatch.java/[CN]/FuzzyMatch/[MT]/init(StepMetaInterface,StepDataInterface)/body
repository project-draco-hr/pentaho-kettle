{
  meta=(FuzzyMatchMeta)smi;
  data=(FuzzyMatchData)sdi;
  if (super.init(smi,sdi)) {
    if (Const.isEmpty(meta.getMainStreamField())) {
      logError(BaseMessages.getString(PKG,"FuzzyMatch.Error.MainStreamFieldMissing"));
      return false;
    }
    if (Const.isEmpty(meta.getLookupField())) {
      logError(BaseMessages.getString(PKG,"FuzzyMatch.Error.LookupStreamFieldMissing"));
      return false;
    }
    data.addValueFieldName=!Const.isEmpty(environmentSubstitute(meta.getOutputValueField()));
    String matchField=environmentSubstitute(meta.getOutputMatchField());
    if (Const.isEmpty(matchField)) {
      logError(BaseMessages.getString(PKG,"FuzzyMatch.Error.OutputMatchFieldMissing"));
      return false;
    }
switch (meta.getAlgorithmType()) {
case FuzzyMatchMeta.OPERATION_TYPE_LEVENSHTEIN:
case FuzzyMatchMeta.OPERATION_TYPE_DAMERAU_LEVENSHTEIN:
case FuzzyMatchMeta.OPERATION_TYPE_NEEDLEMAN_WUNSH:
      data.minimalDistance=Const.toInt(environmentSubstitute(meta.getMinimalValue()),0);
    if (isDetailed())     logDetailed(BaseMessages.getString(PKG,"FuzzyMatch.Log.MinimalDistance",data.minimalDistance));
  data.maximalDistance=Const.toInt(environmentSubstitute(meta.getMaximalValue()),5);
if (isDetailed()) logDetailed(BaseMessages.getString(PKG,"FuzzyMatch.Log.MaximalDistance",data.maximalDistance));
if (!meta.isGetCloserValue()) {
data.valueSeparator=environmentSubstitute(meta.getSeparator());
if (isDetailed()) logDetailed(BaseMessages.getString(PKG,"FuzzyMatch.Log.Separator",data.valueSeparator));
}
break;
case FuzzyMatchMeta.OPERATION_TYPE_JARO:
case FuzzyMatchMeta.OPERATION_TYPE_JARO_WINKLER:
case FuzzyMatchMeta.OPERATION_TYPE_PAIR_SIMILARITY:
data.minimalSimilarity=Const.toDouble(environmentSubstitute(meta.getMinimalValue()),0);
if (isDetailed()) logDetailed(BaseMessages.getString(PKG,"FuzzyMatch.Log.MinimalSimilarity",data.minimalSimilarity));
data.maximalSimilarity=Const.toDouble(environmentSubstitute(meta.getMaximalValue()),1);
if (isDetailed()) logDetailed(BaseMessages.getString(PKG,"FuzzyMatch.Log.MaximalSimilarity",data.maximalSimilarity));
if (!meta.isGetCloserValue()) {
data.valueSeparator=environmentSubstitute(meta.getSeparator());
if (isDetailed()) logDetailed(BaseMessages.getString(PKG,"FuzzyMatch.Log.Separator",data.valueSeparator));
}
break;
default :
break;
}
data.readLookupValues=true;
return true;
}
return false;
}
