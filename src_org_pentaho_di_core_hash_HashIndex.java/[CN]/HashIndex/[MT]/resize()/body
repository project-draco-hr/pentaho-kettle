{
  if (size++ >= threshold) {
    Entry[] oldTable=table;
    int oldCapacity=oldTable.length;
    if (oldCapacity == MAXIMUM_CAPACITY) {
      threshold=Integer.MAX_VALUE;
      return;
    }
    int newCapacity=2 * table.length;
    Entry[] newTable=new Entry[newCapacity];
    for (int j=0; j < oldTable.length; j++) {
      Entry e=oldTable[j];
      if (e != null) {
        oldTable[j]=null;
        do {
          Entry next=e.next;
          int i=e.hash & (newCapacity - 1);
          e.next=newTable[i];
          newTable[i]=e;
          e=next;
        }
 while (e != null);
      }
    }
    table=newTable;
    threshold=(int)(newCapacity * loadFactor);
  }
}
