{
  LogWriter log=LogWriter.getInstance();
  Result result=previousResult;
  result.setResult(false);
  if (filename != null) {
    String realFilename=getRealFilename();
    FileObject fileObject=null;
    try {
      fileObject=KettleVFS.getFileObject(realFilename);
      if (!fileObject.exists()) {
        if (isFailIfFileNotExists()) {
          result.setResult(false);
          log.logError(toString(),"File [" + realFilename + "] doesn't exist, failing.");
        }
 else {
          result.setResult(true);
          log.logBasic(toString(),"File [" + realFilename + "] already deleted.");
        }
      }
 else {
        boolean deleted=fileObject.delete();
        if (!deleted) {
          log.logError(toString(),"Could not delete file [" + realFilename + "].");
          result.setResult(false);
          result.setNrErrors(1);
        }
        log.logBasic(toString(),"File [" + realFilename + "] deleted!");
        result.setResult(true);
      }
    }
 catch (    IOException e) {
      log.logError(toString(),"Could not delete file [" + realFilename + "], exception: "+ e.getMessage());
      result.setResult(false);
      result.setNrErrors(1);
    }
 finally {
      if (fileObject != null) {
        try {
          fileObject.close();
        }
 catch (        IOException ex) {
        }
        ;
      }
    }
  }
 else {
    log.logError(toString(),"No filename is defined.");
  }
  return result;
}
