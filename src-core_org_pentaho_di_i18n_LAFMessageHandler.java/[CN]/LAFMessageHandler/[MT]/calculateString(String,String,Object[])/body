{
  String string=null;
  if (replaceWith != null) {
    string=internalCalc(replacePackage(packageName),replaceSysBundle,key,parameters);
    if (string != null)     return string;
  }
  string=internalCalc(packageName,SYSTEM_BUNDLE_PACKAGE,key,parameters);
  if (string != null)   return string;
  string="!" + key + "!";
  if (LogWriter.getInstance().isDetailed()) {
    String message="Message not found in the preferred and failover locale: key=[" + key + "], package="+ packageName;
    LogWriter.getInstance().logDetailed("i18n",Const.getStackTracker(new KettleException(message)));
  }
  return string;
}
