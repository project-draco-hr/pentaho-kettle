{
  try {
    String buildFilename=buildFilename();
    data.file=KettleVFS.getFileObject(buildFilename,getTransMeta());
    if (meta.isAddToResultFiles()) {
      ResultFile resultFile=new ResultFile(ResultFile.FILE_TYPE_GENERAL,data.file,getTransMeta().getName(),getStepname());
      resultFile.setComment("This file was created with an Excel output step by Pentaho Data Integration");
      addResultFile(resultFile);
    }
    return true;
  }
 catch (  Exception e) {
    log.logError("Unable to add filename to the result",e);
    return false;
  }
}
