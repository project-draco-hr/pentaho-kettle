{
  boolean retval=false;
  try {
    if (data.workbook != null) {
      data.workbook.write();
      data.workbook.close();
      data.outputStream.close();
      data.outputStream=null;
      data.workbook=null;
    }
    data.formats.clear();
    System.gc();
    retval=true;
  }
 catch (  Exception e) {
    logError("Unable to close openFile file",e);
    setErrors(1);
  }
  return retval;
}
