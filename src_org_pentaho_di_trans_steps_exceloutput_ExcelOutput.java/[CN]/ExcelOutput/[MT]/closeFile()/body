{
  boolean retval=false;
  String filename=null;
  try {
    if (meta.isFooterEnabled()) {
      writeHeader();
    }
    if (data.workbook != null) {
      System.gc();
      data.workbook.write();
      data.workbook.close();
      data.workbook=null;
      if (data.outputStream != null) {
        data.outputStream.close();
        data.outputStream=null;
      }
      if (data.sheet != null) {
        data.sheet=null;
      }
      if (data.file != null) {
        filename=data.file.toString();
        data.file.close();
        data.file=null;
      }
    }
    if (log.isDebug())     log.logDebug(toString(),Messages.getString("ExcelOutput.Log.FileClosed",filename));
    System.gc();
    retval=true;
  }
 catch (  Exception e) {
    logError("Unable to close openFile file : " + data.file.toString(),e);
    setErrors(1);
  }
  return retval;
}
