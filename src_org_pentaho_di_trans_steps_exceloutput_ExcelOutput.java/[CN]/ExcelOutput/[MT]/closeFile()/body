{
  boolean retval=false;
  try {
    if (meta.isFooterEnabled()) {
      writeHeader();
    }
    if (data.workbook != null) {
      data.workbook.write();
      data.workbook.close();
      data.workbook=null;
      if (data.outputStream != null) {
        data.outputStream.close();
        data.outputStream=null;
      }
      if (data.sheet != null) {
        data.sheet=null;
      }
    }
    System.gc();
    retval=true;
  }
 catch (  Exception e) {
    logError("Unable to close openFile file",e);
    setErrors(1);
  }
  return retval;
}
