{
synchronized (StepLoader.getInstance()) {
    if (steps == null) {
      try {
        ConfigManager<?> stepsAnntCfg=KettleConfig.getInstance().getManager("steps-annotation-config");
        Collection<StepPluginMeta> mainSteps=stepsAnntCfg.loadAs(StepPluginMeta.class);
        ConfigManager<?> stepsCfg=KettleConfig.getInstance().getManager("steps-xml-config");
        Collection<StepPluginMeta> csteps=stepsCfg.loadAs(StepPluginMeta.class);
        mainSteps.addAll(csteps);
        steps=mainSteps.toArray(new StepPluginMeta[mainSteps.size()]);
      }
 catch (      KettleConfigException e) {
        throw new KettleException("There was an unexpected error while reading the step plugin metadata",e);
      }
    }
  }
}
