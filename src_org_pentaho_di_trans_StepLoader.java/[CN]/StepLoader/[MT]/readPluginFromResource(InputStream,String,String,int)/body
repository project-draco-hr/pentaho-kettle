{
  try {
    DocumentBuilderFactory dbf=DocumentBuilderFactory.newInstance();
    DocumentBuilder db=dbf.newDocumentBuilder();
    Document doc=db.parse(docStream);
    Node plugins=XMLHandler.getSubNode(doc,"plugins");
    if (plugins != null) {
      Node plugin=plugins.getFirstChild();
      while (plugin != null) {
        if ("plugin".equals(plugin.getNodeName())) {
          readPluginFromResource(plugin,path,dir,type,PLUGIN_TYPE_STEP);
        }
        if ("plugin-partitioner".equals(plugin.getNodeName())) {
          readPluginFromResource(plugin,path,dir,type,PLUGIN_TYPE_PARTIONER);
        }
        plugin=plugin.getNextSibling();
      }
    }
    Node plugin=XMLHandler.getSubNode(doc,"plugin");
    if (plugin != null) {
      if ("plugin".equals(plugin.getNodeName())) {
        readPluginFromResource(plugin,path,dir,type,PLUGIN_TYPE_STEP);
      }
      if ("plugin-partitioner".equals(plugin.getNodeName())) {
        readPluginFromResource(plugin,path,dir,type,PLUGIN_TYPE_PARTIONER);
      }
    }
  }
 catch (  Exception e) {
    throw new KettleException(Messages.getString("StepLoader.RuntimeError.UnableToReadPluginXML.TRANS0001"),e);
  }
}
