{
  try {
    if (!closeLastFile())     return false;
    data.last_file=(data.filenr == data.files.length - 1);
    data.filename=data.files[data.filenr];
    logBasic("Opening file: " + data.filename);
    data.fr=new FileInputStream(new File(data.filename));
    if (meta.isZipped()) {
      data.zi=new ZipInputStream(data.fr);
      data.zi.getNextEntry();
      if (meta.getEncoding() != null && meta.getEnclosure().length() > 0) {
        data.isr=new InputStreamReader(new BufferedInputStream(data.zi),meta.getEncoding());
      }
 else {
        data.isr=new InputStreamReader(new BufferedInputStream(data.zi));
      }
    }
 else {
      if (meta.getEncoding() != null && meta.getEnclosure().length() > 0) {
        data.isr=new InputStreamReader(new BufferedInputStream(data.fr),meta.getEncoding());
      }
 else {
        data.isr=new InputStreamReader(new BufferedInputStream(data.fr));
      }
    }
    data.filenr++;
  }
 catch (  Exception e) {
    logError("Couldn't open file #" + data.filenr + " : "+ data.filename+ " --> "+ e.toString());
    stopAll();
    setErrors(1);
    return false;
  }
  return true;
}
