{
  List<String> sheetnames=new ArrayList<String>();
  ExcelInputMeta info=new ExcelInputMeta();
  getInfo(info);
  FileInputList fileList=info.getFileList(transMeta);
  for (Iterator iter=fileList.getFiles().iterator(); iter.hasNext(); ) {
    FileObject fileObject=(FileObject)iter.next();
    try {
      Workbook workbook=Workbook.getWorkbook(KettleVFS.getInputStream(fileObject));
      int nrSheets=workbook.getNumberOfSheets();
      for (int j=0; j < nrSheets; j++) {
        Sheet sheet=workbook.getSheet(j);
        String sheetname=sheet.getName();
        if (Const.indexOfString(sheetname,sheetnames) < 0)         sheetnames.add(sheetname);
      }
      workbook.close();
    }
 catch (    Exception e) {
      new ErrorDialog(shell,Messages.getString("System.Dialog.Error.Title"),Messages.getString("ExcelInputDialog.ErrorReadingFile.DialogMessage",KettleVFS.getFilename(fileObject)),e);
    }
  }
  String lst[]=(String[])sheetnames.toArray(new String[sheetnames.size()]);
  EnterListDialog esd=new EnterListDialog(shell,SWT.NONE,lst);
  String selection[]=esd.open();
  if (selection != null) {
    for (int j=0; j < selection.length; j++) {
      wSheetnameList.add(new String[]{selection[j],""});
    }
    wSheetnameList.removeEmptyRows();
    wSheetnameList.setRowNums();
    wSheetnameList.optWidth(true);
  }
}
