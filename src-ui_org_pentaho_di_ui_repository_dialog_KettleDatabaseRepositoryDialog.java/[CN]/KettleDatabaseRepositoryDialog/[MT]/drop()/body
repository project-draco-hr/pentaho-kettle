{
  KettleDatabaseRepositoryMeta repinfo=new KettleDatabaseRepositoryMeta();
  getInfo(repinfo);
  try {
    KettleDatabaseRepository rep=(KettleDatabaseRepository)RepositoryLoader.createRepository(repinfo,null);
    rep.connect(getClass().getName());
    MessageBox qmb=new MessageBox(shell,SWT.ICON_WARNING | SWT.YES | SWT.NO);
    qmb.setMessage(BaseMessages.getString(PKG,"RepositoryDialog.Dialog.ConfirmRemovalOfRepository.Message"));
    qmb.setText(BaseMessages.getString(PKG,"RepositoryDialog.Dialog.ConfirmRemovalOfRepository.Title"));
    int answer=qmb.open();
    if (answer == SWT.YES) {
      EnterPasswordDialog etd=new EnterPasswordDialog(shell,BaseMessages.getString(PKG,"RepositoryDialog.Dialog.AskAdminPassword.Title"),BaseMessages.getString(PKG,"RepositoryDialog.Dialog.AskAdminPassword.Message"),"");
      String pwd=etd.open();
      if (pwd != null) {
        try {
          UserInfo ui=rep.loadUserInfo("admin");
          if (pwd.equalsIgnoreCase(ui.getPassword())) {
            try {
              rep.dropRepositorySchema();
              MessageBox mb=new MessageBox(shell,SWT.ICON_INFORMATION | SWT.OK);
              mb.setMessage(BaseMessages.getString(PKG,"RepositoryDialog.Dialog.RemovedRepositoryTables.Message"));
              mb.setText(BaseMessages.getString(PKG,"RepositoryDialog.Dialog.RemovedRepositoryTables.Title"));
              mb.open();
            }
 catch (            KettleDatabaseException dbe) {
              MessageBox mb=new MessageBox(shell,SWT.ICON_ERROR | SWT.OK);
              mb.setMessage(BaseMessages.getString(PKG,"RepositoryDialog.Dialog.UnableToRemoveRepository.Message") + Const.CR + dbe.getMessage());
              mb.setText(BaseMessages.getString(PKG,"RepositoryDialog.Dialog.UnableToRemoveRepository.Title"));
              mb.open();
            }
          }
 else {
            MessageBox mb=new MessageBox(shell,SWT.ICON_ERROR | SWT.OK);
            mb.setMessage(BaseMessages.getString(PKG,"RepositoryDialog.Dialog.UnableToRemoveRepositoryPwdIncorrect.Message"));
            mb.setText(BaseMessages.getString(PKG,"RepositoryDialog.Dialog.UnableToRemoveRepositoryPwdIncorrect.Title"));
            mb.open();
          }
        }
 catch (        KettleException e) {
          new ErrorDialog(shell,BaseMessages.getString(PKG,"RepositoryDialog.Dialog.UnableToVerifyAdminUser.Title"),BaseMessages.getString(PKG,"RepositoryDialog.Dialog.UnableToVerifyAdminUser.Message"),e);
        }
      }
    }
    rep.disconnect();
  }
 catch (  KettleException ke) {
    new ErrorDialog(shell,BaseMessages.getString(PKG,"RepositoryDialog.Dialog.NoRepositoryFoundOnConnection.Title"),BaseMessages.getString(PKG,"RepositoryDialog.Dialog.NoRepositoryFoundOnConnection.Message"),ke);
  }
}
