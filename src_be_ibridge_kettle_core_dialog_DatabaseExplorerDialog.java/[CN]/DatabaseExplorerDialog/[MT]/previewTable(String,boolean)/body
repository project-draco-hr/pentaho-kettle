{
  int limit=100;
  if (asklimit) {
    String shell_text="Preview limit";
    String line_text="Number of lines to preview (0=all lines)";
    EnterNumberDialog end=new EnterNumberDialog(shell,props,limit,shell_text,line_text);
    int samples=end.open();
    if (samples >= 0)     limit=samples;
  }
  GetPreviewTableProgressDialog pd=new GetPreviewTableProgressDialog(log,props,shell,dbMeta,table_name,limit);
  ArrayList rows=pd.open();
  if (rows != null) {
    if (rows.size() > 0) {
      PreviewRowsDialog prd=new PreviewRowsDialog(shell,SWT.NONE,table_name,rows);
      prd.open();
    }
 else {
      MessageBox mb=new MessageBox(shell,SWT.ICON_INFORMATION | SWT.OK);
      mb.setMessage("This table contains no rows!");
      mb.setText("Sorry");
      mb.open();
    }
  }
}
