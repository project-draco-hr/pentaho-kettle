{
  int limit=100;
  if (asklimit) {
    String shellText="Preview limit";
    String lineText="Number of lines to preview (0=all lines)";
    EnterNumberDialog end=new EnterNumberDialog(shell,props,limit,shellText,lineText);
    int samples=end.open();
    if (samples >= 0)     limit=samples;
  }
  GetPreviewTableProgressDialog pd=new GetPreviewTableProgressDialog(shell,dbMeta,tableName,limit);
  List rows=pd.open();
  if (rows != null) {
    if (rows.size() > 0) {
      PreviewRowsDialog prd=new PreviewRowsDialog(shell,SWT.NONE,tableName,rows);
      prd.open();
    }
 else {
      MessageBox mb=new MessageBox(shell,SWT.ICON_INFORMATION | SWT.OK);
      mb.setMessage("This table contains no rows!");
      mb.setText("Sorry");
      mb.open();
    }
  }
}
