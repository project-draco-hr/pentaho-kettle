{
  Menu mTree=null;
  TreeItem ti[]=wTree.getSelection();
  if (ti.length == 1) {
    TreeItem parent=ti[0].getParentItem();
    if (parent != null) {
      String schema_name=parent.getText();
      String table_name=ti[0].getText();
      if (ti[0].getItemCount() == 0) {
        String tab=null;
        if (schema_name.equalsIgnoreCase(STRING_TABLES) || schema_name.equalsIgnoreCase(STRING_VIEWS) || schema_name.equalsIgnoreCase(STRING_SYNONYMS)|| (schema_name != null && schema_name.length() == 0)) {
          tab=table_name;
        }
 else {
          tab=dbMeta.getSchemaTableCombination(schema_name,table_name);
        }
        final String table=tab;
        mTree=new Menu(shell,SWT.POP_UP);
        MenuItem miPrev=new MenuItem(mTree,SWT.PUSH);
        miPrev.setText("&Preview first 100 rows of [" + table + "]");
        miPrev.addSelectionListener(new SelectionAdapter(){
          public void widgetSelected(          SelectionEvent e){
            previewTable(table,false);
          }
        }
);
        MenuItem miPrevN=new MenuItem(mTree,SWT.PUSH);
        miPrevN.setText("Preview &first ... rows of [" + table + "]");
        miPrevN.addSelectionListener(new SelectionAdapter(){
          public void widgetSelected(          SelectionEvent e){
            previewTable(table,true);
          }
        }
);
        MenuItem miCount=new MenuItem(mTree,SWT.PUSH);
        miCount.setText("Show size of [" + table + "]");
        miCount.addSelectionListener(new SelectionAdapter(){
          public void widgetSelected(          SelectionEvent e){
            showCount(table);
          }
        }
);
        new MenuItem(mTree,SWT.SEPARATOR);
        MenuItem miShow=new MenuItem(mTree,SWT.PUSH);
        miShow.setText("Show layout of [" + table + "]");
        miShow.addSelectionListener(new SelectionAdapter(){
          public void widgetSelected(          SelectionEvent e){
            showTable(table);
          }
        }
);
        MenuItem miDDL=new MenuItem(mTree,SWT.PUSH);
        miDDL.setText("Generate DDL");
        miDDL.addSelectionListener(new SelectionAdapter(){
          public void widgetSelected(          SelectionEvent e){
            getDDL(table);
          }
        }
);
        MenuItem miDDL2=new MenuItem(mTree,SWT.PUSH);
        miDDL2.setText("Generate DDL for other connection");
        miDDL2.addSelectionListener(new SelectionAdapter(){
          public void widgetSelected(          SelectionEvent e){
            getDDLForOther(table);
          }
        }
);
        MenuItem miSQL=new MenuItem(mTree,SWT.PUSH);
        miSQL.setText("Open SQL for [" + table + "]");
        miSQL.addSelectionListener(new SelectionAdapter(){
          public void widgetSelected(          SelectionEvent e){
            getSQL(table);
          }
        }
);
      }
    }
  }
  wTree.setMenu(mTree);
}
