{
  if (directoryToExport != null) {
    MessageBox box=new MessageBox(shell,SWT.ICON_QUESTION | SWT.APPLICATION_MODAL | SWT.SHEET| SWT.YES| SWT.NO| SWT.CANCEL);
    box.setText(BaseMessages.getString(PKG,"Spoon.QuestionExportDirectory.Title"));
    box.setMessage(BaseMessages.getString(PKG,"Spoon.QuestionExportFolder.Message",Const.CR,directoryToExport.getPath()));
    int answer=box.open();
    if (answer == SWT.NO)     return true;
    if (answer == SWT.CANCEL)     return false;
  }
  FileDialog dialog=new FileDialog(shell,SWT.SAVE | SWT.SINGLE);
  dialog.setText(BaseMessages.getString(PKG,"Spoon.SelectAnXMLFileToExportTo.Message"));
  if (dialog.open() == null)   return false;
  String filename=dialog.getFilterPath() + Const.FILE_SEPARATOR + dialog.getFileName();
  log.logBasic(BaseMessages.getString(PKG,"Spoon.Log.Exporting"),BaseMessages.getString(PKG,"Spoon.Log.ExportObjectsToFile",filename));
  MessageBox box=new MessageBox(shell,SWT.ICON_QUESTION | SWT.APPLICATION_MODAL | SWT.SHEET| SWT.YES| SWT.NO| SWT.CANCEL);
  box.setText(BaseMessages.getString(PKG,"Spoon.QuestionApplyImportRulesToExport.Title"));
  box.setMessage(BaseMessages.getString(PKG,"Spoon.QuestionApplyImportRulesToExport.Message"));
  int answer=box.open();
  if (answer == SWT.CANCEL)   return false;
  ImportRules importRules=new ImportRules();
  if (answer == SWT.YES) {
    ImportRulesDialog importRulesDialog=new ImportRulesDialog(shell,importRules);
    if (!importRulesDialog.open())     return false;
  }
  RepositoryExportProgressDialog repd=new RepositoryExportProgressDialog(shell,rep,directoryToExport,filename,importRules);
  repd.open();
  return true;
}
