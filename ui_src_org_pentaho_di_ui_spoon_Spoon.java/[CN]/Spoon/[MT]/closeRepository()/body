{
  if (rep != null) {
    IMetaStore repMetaStore=rep.getMetaStore();
    rep.disconnect();
    if (repMetaStore != null) {
      try {
        metaStore.removeMetaStore(repMetaStore);
        if (metaStore.getMetaStoreList().size() > 0) {
          metaStore.setActiveMetaStoreName(metaStore.getMetaStoreList().get(0).getName());
        }
      }
 catch (      MetaStoreException e) {
        new ErrorDialog(shell,BaseMessages.getString(PKG,"Spoon.ErrorRemovingMetaStore.Title"),BaseMessages.getString(PKG,"Spoon.ErrorRemovingMetaStore.Message"),e);
      }
    }
  }
  rep=null;
  setRepository(rep);
  setShellText();
  SpoonPluginManager.getInstance().notifyLifecycleListeners(SpoonLifeCycleEvent.REPOSITORY_DISCONNECTED);
}
