{
  if (rep != null)   rep.disconnect();
  if (rep.getMetaStore() != null) {
    try {
      metaStore.removeMetaStore(rep.getMetaStore());
    }
 catch (    MetaStoreException e) {
      new ErrorDialog(shell,BaseMessages.getString(PKG,"Spoon.ErrorRemovingMetaStore.Title"),BaseMessages.getString(PKG,"Spoon.ErrorRemovingMetaStore.Message"),e);
    }
  }
  rep=null;
  setRepository(rep);
  setShellText();
  SpoonPluginManager.getInstance().notifyLifecycleListeners(SpoonLifeCycleEvent.REPOSITORY_DISCONNECTED);
}
