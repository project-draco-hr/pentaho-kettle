{
  String cmdFile=getCmdLine();
  if (Utils.isEmpty(cmdFile)) {
    MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_INFORMATION);
    mb.setMessage(BaseMessages.getString(PKG,"ExportCmdLine.JobOrTransformationMissing.Message"));
    mb.setText(BaseMessages.getString(PKG,"ExportCmdLine.JobOrTransformationMissing.Title"));
    mb.open();
  }
 else {
    boolean export=true;
    FileDialog dialog=new FileDialog(shell,SWT.SAVE);
    dialog.setFilterExtensions(new String[]{"*.bat",".sh","*.*"});
    dialog.setFilterNames(new String[]{BaseMessages.getString(PKG,"ExportCmdLine.BatFiles"),BaseMessages.getString(PKG,"ExportCmdLineShFiles"),BaseMessages.getString(PKG,"ExportCmdLine.AllFiles")});
    String filename=dialog.open();
    if (filename != null) {
      int id=SWT.YES;
      try {
        FileObject f=KettleVFS.getFileObject(filename);
        if (f.exists()) {
          MessageBox mb=new MessageBox(shell,SWT.NO | SWT.YES | SWT.ICON_WARNING);
          mb.setMessage(BaseMessages.getString(PKG,"ExportCmdLineShFiles.FileExistsReplace",filename));
          mb.setText(BaseMessages.getString(PKG,"ExportCmdLineShFiles.ConfirmOverwrite"));
          id=mb.open();
        }
      }
 catch (      Exception e) {
      }
      if (id == SWT.NO) {
        export=false;
      }
      if (export) {
        java.io.FileWriter out=null;
        try {
          out=new java.io.FileWriter(filename);
          out.write(cmdFile);
          out.flush();
        }
 catch (        Exception e) {
          new ErrorDialog(shell,BaseMessages.getString(PKG,"ExportCmdLineShFiles.ErrorWritingFile.Title"),BaseMessages.getString(PKG,"ExportCmdLineShFiles.ErrorWritingFile.Message",filename),e);
        }
 finally {
          if (out != null) {
            try {
              out.close();
            }
 catch (            Exception e) {
            }
          }
        }
        MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_INFORMATION);
        mb.setMessage(BaseMessages.getString(PKG,"ExportCmdLineShFiles.CmdExported.Message",filename));
        mb.setText(BaseMessages.getString(PKG,"ExportCmdLineShFiles.CmdExported.Title"));
        mb.open();
      }
    }
  }
}
