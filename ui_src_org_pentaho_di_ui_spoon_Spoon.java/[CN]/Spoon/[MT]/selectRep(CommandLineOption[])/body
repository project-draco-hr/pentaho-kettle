{
  RepositoryMeta repositoryMeta;
  StringBuilder optionRepname=getCommandLineOption(options,"rep").getArgument();
  StringBuilder optionFilename=getCommandLineOption(options,"file").getArgument();
  StringBuilder optionUsername=getCommandLineOption(options,"user").getArgument();
  StringBuilder optionPassword=getCommandLineOption(options,"pass").getArgument();
  if (Const.isEmpty(optionRepname) && Const.isEmpty(optionFilename) && props.showRepositoriesDialogAtStartup()) {
    if (log.isBasic()) {
      log.logBasic(BaseMessages.getString(PKG,"Spoon.Log.AskingForRepository"));
    }
    loginDialog=new RepositoriesDialog(shell,null,new ILoginCallback(){
      public void onSuccess(      Repository repository){
        setRepository(repository);
        SpoonPluginManager.getInstance().notifyLifecycleListeners(SpoonLifeCycleEvent.REPOSITORY_CONNECTED);
      }
      public void onError(      Throwable t){
        onLoginError(t);
      }
      public void onCancel(){
      }
    }
);
    hideSplash();
    loginDialog.show();
    showSplash();
  }
 else   if (!Const.isEmpty(optionRepname) && Const.isEmpty(optionFilename)) {
    RepositoriesMeta repsInfo=new RepositoriesMeta();
    repsInfo.getLog().setLogLevel(log.getLogLevel());
    try {
      repsInfo.readData();
      repositoryMeta=repsInfo.findRepository(optionRepname.toString());
      if (repositoryMeta != null && !Const.isEmpty(optionUsername) && !Const.isEmpty(optionPassword)) {
        Repository repo=PluginRegistry.getInstance().loadClass(RepositoryPluginType.class,repositoryMeta,Repository.class);
        repo.init(repositoryMeta);
        repo.getLog().setLogLevel(log.getLogLevel());
        repo.connect(optionUsername != null ? optionUsername.toString() : null,optionPassword != null ? optionPassword.toString() : null);
        setRepository(repo);
      }
 else {
        if (!Const.isEmpty(optionUsername) && !Const.isEmpty(optionPassword)) {
          String msg=BaseMessages.getString(PKG,"Spoon.Log.NoRepositoriesDefined");
          log.logError(msg);
          MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
          mb.setMessage(BaseMessages.getString(PKG,"Spoon.Error.Repository.NotFound",optionRepname.toString()));
          mb.setText(BaseMessages.getString(PKG,"Spoon.Error.Repository.NotFound.Title"));
          mb.open();
        }
        loginDialog=new RepositoriesDialog(shell,null,new ILoginCallback(){
          public void onSuccess(          Repository repository){
            setRepository(repository);
            SpoonPluginManager.getInstance().notifyLifecycleListeners(SpoonLifeCycleEvent.REPOSITORY_CONNECTED);
          }
          public void onError(          Throwable t){
            onLoginError(t);
          }
          public void onCancel(){
          }
        }
);
        hideSplash();
        loginDialog.show();
        showSplash();
      }
    }
 catch (    Exception e) {
      hideSplash();
      log.logError("Error reading repositories xml file",e);
    }
  }
}
