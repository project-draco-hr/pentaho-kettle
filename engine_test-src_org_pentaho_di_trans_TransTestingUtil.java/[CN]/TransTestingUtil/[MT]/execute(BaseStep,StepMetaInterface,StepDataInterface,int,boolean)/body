{
  RowSet output=new BlockingRowSet(Math.max(1,expectedRowsAmount));
  step.setOutputRowSets(Collections.singletonList(output));
  int i=0;
  List<Object[]> result=new ArrayList<>(expectedRowsAmount);
  while (step.processRow(meta,data) && i < expectedRowsAmount) {
    Object[] row=output.getRowImmediate();
    assertNotNull(Integer.toString(i),row);
    result.add(row);
    i++;
  }
  assertEquals("The amount of executions should be equal to expected",expectedRowsAmount,i);
  if (checkIsDone) {
    assertTrue(output.isDone());
  }
  return result;
}
