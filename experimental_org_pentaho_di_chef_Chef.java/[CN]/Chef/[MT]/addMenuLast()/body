{
  int idx=msFile.indexOf(miFileSep3);
  int max=msFile.getItemCount();
  for (int i=max - 1; i > idx; i--) {
    MenuItem mi=msFile.getItem(i);
    mi.dispose();
  }
  List lastUsedFiles=props.getLastUsedFiles();
  for (int i=0; i < lastUsedFiles.size(); i++) {
    final LastUsedFile lastUsedFile=(LastUsedFile)lastUsedFiles.get(i);
    MenuItem miFileLast=new MenuItem(msFile,SWT.CASCADE);
    char chr=(char)('1' + i);
    int accel=SWT.CTRL | chr;
    if (i < 9) {
      miFileLast.setAccelerator(accel);
      miFileLast.setText("&" + chr + "  "+ lastUsedFile+ "\tCTRL-"+ chr);
    }
 else {
      miFileLast.setText("   " + lastUsedFile);
    }
    Listener lsFileLast=new Listener(){
      public void handleEvent(      Event e){
        if (showChangedWarning()) {
          boolean noRepository=false;
          if (lastUsedFile.isSourceRepository() && (rep == null || !rep.getRepositoryInfo().getName().equalsIgnoreCase(lastUsedFile.getRepositoryName()))) {
            int perms[]=new int[]{PermissionMeta.TYPE_PERMISSION_JOB};
            RepositoriesDialog rd=new RepositoriesDialog(disp,perms,APP_NAME);
            rd.setRepositoryName(lastUsedFile.getRepositoryName());
            if (rd.open()) {
              if (rep != null)               rep.disconnect();
              rep=new Repository(log,rd.getRepository(),rd.getUser());
              try {
                rep.connect(APP_NAME);
              }
 catch (              KettleException ke) {
                rep=null;
                new ErrorDialog(shell,Messages.getString("Chef.Dialog.UnableToConnectToRepository.Title"),Messages.getString("Chef.Dialog.UnableToConnectToRepository.Message"),ke);
              }
            }
 else {
              noRepository=true;
            }
          }
          if (lastUsedFile.isSourceRepository()) {
            if (!noRepository && rep != null && rep.getRepositoryInfo().getName().equalsIgnoreCase(lastUsedFile.getRepositoryName())) {
              RepositoryDirectory fdRepdir=rep.getDirectoryTree().findDirectory(lastUsedFile.getDirectory());
              try {
                if (fdRepdir != null) {
                  jobMeta=new JobMeta(log,rep,lastUsedFile.getFilename(),fdRepdir);
                  props.addLastFile(LastUsedFile.FILE_TYPE_JOB,lastUsedFile.getFilename(),fdRepdir.getPath(),true,rep.getName());
                }
 else {
                  throw new KettleException(Messages.getString("Chef.Exception.RepositoryDirectoryDoesNotExist") + lastUsedFile.getDirectory());
                }
              }
 catch (              KettleException ke) {
                jobMeta.clear();
                new ErrorDialog(shell,Messages.getString("Chef.ErrorDialog.ErrorLoadingJob.Title"),Messages.getString("Chef.ErrorDialog.ErrorLoadingJob.Message"),ke);
              }
            }
 else {
              jobMeta.clear();
              MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
              mb.setMessage(Messages.getString("Chef.Dialog.CanNotLoadJobConnectToRepositoryFirst.Message"));
              mb.setText(Messages.getString("Chef.Dialog.CanNotLoadJobConnectToRepositoryFirst.Title"));
              mb.open();
            }
          }
 else {
            try {
              jobMeta=new JobMeta(log,lastUsedFile.getFilename(),rep);
              props.addLastFile(LastUsedFile.FILE_TYPE_JOB,lastUsedFile.getFilename(),null,false,null);
            }
 catch (            KettleException ke) {
              jobMeta.clear();
              new ErrorDialog(shell,Messages.getString("Chef.ErrorDialog.UnableToLoadJobFromXML.Title"),Messages.getString("Chef.ErrorDialog.UnableToLoadJobFromXML.Message"),ke);
            }
          }
          saveSettings();
          addMenuLast();
          refreshTree(true);
          refreshGraph();
        }
      }
    }
;
    miFileLast.addListener(SWT.Selection,lsFileLast);
  }
}
