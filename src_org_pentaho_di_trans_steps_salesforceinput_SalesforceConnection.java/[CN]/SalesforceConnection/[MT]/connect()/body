{
  try {
    this.binding=(SoapBindingStub)new SforceServiceLocator().getSoap();
    if (log.isDetailed())     log.logDetailed(BaseMessages.getString(PKG,"SalesforceInput.Log.LoginURL",binding._getProperty(SoapBindingStub.ENDPOINT_ADDRESS_PROPERTY)));
    if (getTimeOut() > 0) {
      binding.setTimeout(getTimeOut());
      if (log.isDebug())       log.logDebug(BaseMessages.getString(PKG,"SalesforceInput.Log.SettingTimeout","" + this.timeout));
    }
    this.binding._setProperty(SoapBindingStub.ENDPOINT_ADDRESS_PROPERTY,getURL());
    if (isUsingCompression()) {
      binding._setProperty(HTTPConstants.MC_ACCEPT_GZIP,useCompression);
      binding._setProperty(HTTPConstants.MC_GZIP_REQUEST,useCompression);
    }
    if (log.isDetailed()) {
      log.logDetailed(BaseMessages.getString(PKG,"SalesforceInput.Log.LoginNow"));
      log.logDetailed("----------------------------------------->");
      log.logDetailed(BaseMessages.getString(PKG,"SalesforceInput.Log.LoginURL",getURL()));
      log.logDetailed(BaseMessages.getString(PKG,"SalesforceInput.Log.LoginUsername",getUsername()));
      if (getModule() != null)       log.logDetailed(BaseMessages.getString(PKG,"SalesforceInput.Log.LoginModule",getModule()));
      if (getCondition() != null)       log.logDetailed(BaseMessages.getString(PKG,"SalesforceInput.Log.LoginCondition",getCondition()));
      log.logDetailed("<-----------------------------------------");
    }
    this.loginResult=this.binding.login(getUsername(),getPassword());
    if (log.isDebug()) {
      log.logDebug(BaseMessages.getString(PKG,"SalesforceInput.Log.SessionId") + " : " + this.loginResult.getSessionId());
      log.logDebug(BaseMessages.getString(PKG,"SalesforceInput.Log.NewServerURL") + " : " + this.loginResult.getServerUrl());
    }
    this.binding._setProperty(SoapBindingStub.ENDPOINT_ADDRESS_PROPERTY,this.loginResult.getServerUrl());
    SessionHeader sh=new SessionHeader();
    sh.setSessionId(loginResult.getSessionId());
    this.binding.setHeader(new SforceServiceLocator().getServiceName().getNamespaceURI(),"SessionHeader",sh);
    this.userInfo=this.binding.getUserInfo();
    if (log.isDebug()) {
      log.logDebug(BaseMessages.getString(PKG,"SalesforceInput.Log.UserInfos") + " : " + this.userInfo.getUserFullName());
      log.logDebug("----------------------------------------->");
      log.logDebug(BaseMessages.getString(PKG,"SalesforceInput.Log.UserName") + " : " + this.userInfo.getUserFullName());
      log.logDebug(BaseMessages.getString(PKG,"SalesforceInput.Log.UserEmail") + " : " + this.userInfo.getUserEmail());
      log.logDebug(BaseMessages.getString(PKG,"SalesforceInput.Log.UserLanguage") + " : " + this.userInfo.getUserLanguage());
      log.logDebug(BaseMessages.getString(PKG,"SalesforceInput.Log.UserOrganization") + " : " + this.userInfo.getOrganizationName());
      log.logDebug("<-----------------------------------------");
    }
    this.serverTimestamp=this.binding.getServerTimestamp().toString();
    if (log.isDebug())     BaseMessages.getString(PKG,"SalesforceInput.Log.ServerTimestamp","" + this.serverTimestamp);
    if (log.isDetailed())     log.logDetailed(BaseMessages.getString(PKG,"SalesforceInput.Log.Connected"));
  }
 catch (  Exception e) {
    throw new KettleException(BaseMessages.getString(PKG,"SalesforceInput.Error.Connection"),e);
  }
}
