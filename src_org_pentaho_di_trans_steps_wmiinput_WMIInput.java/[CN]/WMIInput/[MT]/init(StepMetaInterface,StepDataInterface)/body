{
  meta=(WMIInputMeta)smi;
  data=(WMIInputData)sdi;
  if (super.init(smi,sdi)) {
    try {
      String wmq=meta.getWMI();
      if (meta.isVariableReplacementActive()) {
        wmq=environmentSubstitute(meta.getWMI());
      }
      if (Const.isEmpty(wmq)) {
        throw new KettleException(BaseMessages.getString(PKG,"WMIInput.Error.WMIQueryEmpty"));
      }
      data.query=new WMIQuery(log,environmentSubstitute(meta.getDomain()),environmentSubstitute(meta.getHost()),environmentSubstitute(meta.getUserName()),environmentSubstitute(meta.getPassword()));
      data.query.setQueryLimit(Const.toInt(environmentSubstitute(meta.getRowLimit()),0));
      data.query.connect();
      data.query.openQuery(wmq);
    }
 catch (    Exception e) {
      logError(BaseMessages.getString(PKG,"WMIInput.Error.RunningWMI") + e.getMessage());
      setErrors(1);
      stopAll();
    }
  }
  return true;
}
