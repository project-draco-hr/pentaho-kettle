{
  String line="";
  String dateTimeString="";
  if (timeAdded) {
    SimpleDateFormat df=new SimpleDateFormat("yyyy/MM/dd HH:mm:ss");
    dateTimeString=df.format(new Date(event.timeStamp)) + " - ";
  }
  Object object=event.getMessage();
  if (object instanceof Log4jMessage) {
    Log4jMessage message=(Log4jMessage)object;
    String parts[]=message.getMessage().split(Const.CR);
    for (int i=0; i < parts.length; i++) {
      line+=dateTimeString;
      if (message.getSubject() != null) {
        line+=message.getSubject() + " - ";
      }
      if (message.isError()) {
        BuildVersion buildVersion=BuildVersion.getInstance();
        SimpleDateFormat format=new SimpleDateFormat("yyyy/MM/dd HH:mm:ss");
        line+="ERROR (version " + Const.VERSION + ", build "+ buildVersion.getVersion()+ " from "+ format.format(buildVersion.getBuildDate())+ (Const.isEmpty(buildVersion.getHostname()) ? "" : " @ " + buildVersion.getHostname())+ ") : ";
      }
      line+=parts[i];
      if (i < parts.length - 1)       line+=Const.CR;
    }
  }
 else {
    line+=dateTimeString + object.toString();
  }
  return line;
}
