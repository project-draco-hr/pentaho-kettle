{
  if (preview_shown)   return;
  if (trans == null || !trans.isFinished())   return;
  preview=false;
  BaseStep rt;
  int i;
  List<List<Object[]>> buffers=new ArrayList<List<Object[]>>();
  List<RowMetaInterface> rowMetas=new ArrayList<RowMetaInterface>();
  List<String> names=new ArrayList<String>();
  for (i=0; i < trans.nrSteps(); i++) {
    rt=trans.getRunThread(i);
    if (rt.previewSize > 0) {
      buffers.add(rt.previewBuffer);
      rowMetas.add(rt.getPreviewRowMeta());
      names.add(rt.getStepname());
      log.logBasic(toString(),Messages.getString("SpoonLog.Log.Step") + rt.getStepname() + " --> "+ rt.previewBuffer.size()+ Messages.getString("SpoonLog.Log.Rows"));
    }
  }
  EnterPreviewRowsDialog psd=new EnterPreviewRowsDialog(shell,SWT.NONE,names,rowMetas,buffers);
  preview_shown=true;
  psd.open();
  preview_shown=false;
}
