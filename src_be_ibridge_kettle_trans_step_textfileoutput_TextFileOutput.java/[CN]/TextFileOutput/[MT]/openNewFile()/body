{
  boolean retval=false;
  data.fw=null;
  try {
    File file=new File(buildFilename(true));
    if (meta.isZipped()) {
      FileOutputStream fos=new FileOutputStream(file,meta.isFileAppended());
      data.zip=new ZipOutputStream(fos);
      File entry=new File(buildFilename(false));
      ZipEntry zipentry=new ZipEntry(entry.getName());
      zipentry.setComment("Compressed by Kettle");
      data.zip.putNextEntry(zipentry);
      data.fw=data.zip;
    }
 else {
      FileOutputStream fos=new FileOutputStream(file,meta.isFileAppended());
      data.fw=fos;
    }
    retval=true;
  }
 catch (  Exception e) {
    logError("Error opening new file : " + e.toString());
  }
  data.splitnr++;
  return retval;
}
