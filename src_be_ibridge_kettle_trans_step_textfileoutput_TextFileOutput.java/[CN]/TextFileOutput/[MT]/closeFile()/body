{
  boolean retval=false;
  try {
    logDebug("Closing output stream");
    data.writer.close();
    logDebug("Closed output stream");
    data.writer=null;
    if (data.cmdProc != null) {
      logDebug("Ending running external command");
      int procStatus=data.cmdProc.waitFor();
      data.cmdProc=null;
      logBasic("Command exit status: " + procStatus);
    }
 else {
      logDebug("Closing normal file ..");
      if (meta.getFileCompression() == "Zip") {
        data.zip.closeEntry();
        data.zip.finish();
        data.zip.close();
      }
      if (meta.getFileCompression() == "GZip") {
        data.gzip.finish();
      }
    }
    retval=true;
  }
 catch (  Exception e) {
    logError("Excpetion trying to close file: " + e.toString());
    setErrors(1);
    retval=false;
  }
  return retval;
}
