{
  if (tableinfo != null) {
    String tablename=null;
    TableMeta before=(TableMeta)tableinfo.clone();
    TableDialog td=new TableDialog(shell,SWT.NONE,log,tableinfo,schema);
    td.open();
    if (tablename != null) {
      TableMeta after=(TableMeta)tableinfo.clone();
      addUndoChange(new TableMeta[]{before},new TableMeta[]{after},new int[]{schema.indexOfTable(tableinfo)});
      String newname=tablename;
      TableMeta si=schema.findTable(newname,tableinfo);
      int nr=2;
      while (si != null) {
        newname=tablename + " " + nr;
        si=schema.findTable(newname);
        nr++;
      }
      if (nr > 2) {
        tablename=newname;
        MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_INFORMATION);
        mb.setMessage("This tablename already exists.  Menu changed the tablename to [" + tablename + "]");
        mb.setText("Tip!");
        mb.open();
      }
      tableinfo.setName(tablename);
      refreshGraph();
      refreshTree();
    }
    setShellText();
  }
}
