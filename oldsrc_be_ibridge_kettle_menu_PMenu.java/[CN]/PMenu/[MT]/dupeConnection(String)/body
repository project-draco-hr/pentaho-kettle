{
  int i, pos=0;
  DatabaseMeta db=null, look=null;
  for (i=0; i < schema.nrConnections() && db == null; i++) {
    look=schema.getConnection(i);
    if (look.getName().equalsIgnoreCase(name)) {
      db=look;
      pos=i;
    }
  }
  if (db != null) {
    DatabaseMeta newdb=(DatabaseMeta)db.clone();
    String dupename="(copy of) " + name;
    newdb.setName(dupename);
    schema.addConnection(pos + 1,newdb);
    refreshTree();
    DatabaseDialog con=new DatabaseDialog(shell,SWT.NONE,log,newdb,schema.props);
    String newname=con.open();
    if (newname != null) {
      schema.removeConnection(pos + 1);
      schema.addConnection(pos + 1,newdb);
      if (!newname.equalsIgnoreCase(dupename))       refreshTree();
    }
 else {
      addUndoNew(new DatabaseMeta[]{(DatabaseMeta)db.clone()},new int[]{schema.indexOfConnection(db)});
    }
  }
}
