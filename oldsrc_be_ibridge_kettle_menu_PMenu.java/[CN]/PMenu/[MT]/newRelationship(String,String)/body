{
  TableMeta tabfrom=schema.findTable(fr);
  TableMeta tabto=schema.findTable(to);
  RelationshipMeta hi=new RelationshipMeta(tabfrom,tabto,-1,-1);
  RelationshipDialog hd=new RelationshipDialog(shell,SWT.NONE,log,hi,schema);
  if (hd.open() != null) {
    boolean error=false;
    if (schema.findRelationship(hi.getTableFrom().getName(),hi.getTableTo().getName()) != null) {
      MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
      mb.setMessage("This relationship already exists!");
      mb.setText("Error!");
      mb.open();
      error=true;
    }
    if (!error) {
      schema.addRelationship(hi);
      addUndoNew(new RelationshipMeta[]{(RelationshipMeta)hi.clone()},new int[]{schema.indexOfRelationship(hi)});
      TableMeta sifr=schema.findTable(fr);
      TableMeta sito=schema.findTable(to);
      sifr.draw();
      sito.draw();
      refreshTree();
      refreshGraph();
    }
  }
}
