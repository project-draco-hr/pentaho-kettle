{
  RowSet set=new RowSet(3);
  RowMetaInterface rm=createRowMetaInterface();
  Object[] r1=new Object[]{new Long(1L)};
  Object[] r2=new Object[]{new Long(2L)};
  Object[] r3=new Object[]{new Long(3L)};
  Object[] r4=new Object[]{new Long(4L)};
  Object[] r5=new Object[]{new Long(5L)};
  assertEquals(0,set.size());
  set.putRow(rm,r1);
  assertEquals(1,set.size());
  set.putRow(rm,r2);
  assertEquals(2,set.size());
  Object[] r=set.getRow();
  int i=rm.indexOfValue("ROWNR");
  assertEquals(1L,((Long)r[i]).longValue());
  assertEquals(1,set.size());
  set.putRow(rm,r3);
  assertEquals(2,set.size());
  set.putRow(rm,r4);
  assertEquals(3,set.size());
  r=set.getRow();
  i=rm.indexOfValue("ROWNR");
  assertEquals(2L,((Long)r[i]).longValue());
  assertEquals(2,set.size());
  set.putRow(rm,r5);
  assertEquals(3,set.size());
  r=set.getRow();
  i=rm.indexOfValue("ROWNR");
  assertEquals(3L,((Long)r[i]).longValue());
  assertEquals(2,set.size());
  r=set.getRow();
  i=rm.indexOfValue("ROWNR");
  assertEquals(4L,((Long)r[i]).longValue());
  assertEquals(1,set.size());
  r=set.getRow();
  i=rm.indexOfValue("ROWNR");
  assertEquals(5L,((Long)r[i]).longValue());
  assertEquals(0,set.size());
}
