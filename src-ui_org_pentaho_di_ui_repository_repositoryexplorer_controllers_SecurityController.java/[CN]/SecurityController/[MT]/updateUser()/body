{
  if (rsm != null) {
    try {
      UIRepositoryUser uiUser=security.getSelectedUser();
      Set<IUIRole> previousRoleList=new HashSet<IUIRole>();
      previousRoleList.addAll(uiUser.getRoles());
      uiUser.setDescription(securityUser.getDescription());
      uiUser.setPassword(securityUser.getPassword());
      uiUser.setRoles(new HashSet<IUIRole>(securityUser.getAssignedRoles()));
      rsm.updateUser(uiUser.getUserInfo());
      security.updateUser(uiUser,previousRoleList);
    }
 catch (    KettleException ke) {
      messageBox.setTitle(messages.getString("Dialog.Error"));
      messageBox.setAcceptLabel(messages.getString("Dialog.Ok"));
      messageBox.setMessage(BaseMessages.getString(RepositoryExplorer.class,"UpdateUser.UnableToUpdateUser",ke.getLocalizedMessage()));
      messageBox.open();
    }
  }
  userDialog.hide();
}
