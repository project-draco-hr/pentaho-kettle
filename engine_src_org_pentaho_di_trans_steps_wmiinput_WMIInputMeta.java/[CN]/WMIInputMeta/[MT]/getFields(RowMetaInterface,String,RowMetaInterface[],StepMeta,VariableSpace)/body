{
  WMIQuery query=null;
  String wmq=space.environmentSubstitute(wmiQuery);
  try {
    if (Const.isEmpty(wmq)) {
      throw new KettleException(BaseMessages.getString(PKG,"WMIInput.Error.WMIQueryEmpty"));
    }
    query=new WMIQuery(new LogChannel(this));
    query.connect();
    RowMetaInterface add=query.getRowMeta(wmq);
    if (add != null) {
      for (int i=0; i < add.size(); i++) {
        ValueMetaInterface v=add.getValueMeta(i);
        v.setOrigin(origin);
      }
      row.addRowMeta(add);
    }
  }
 catch (  Exception e) {
    throw new KettleStepException(BaseMessages.getString(PKG,"WMIInputMeta.GetFields.Error",wmq),e);
  }
 finally {
    try {
      if (query != null)       query.close();
    }
 catch (    Exception e) {
    }
    ;
  }
}
