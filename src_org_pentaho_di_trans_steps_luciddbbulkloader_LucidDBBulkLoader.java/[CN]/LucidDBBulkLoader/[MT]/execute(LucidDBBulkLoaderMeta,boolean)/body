{
  Runtime rt=Runtime.getRuntime();
  try {
    String tableName=environmentSubstitute(meta.getTableName());
    String fifoVfsDirectory=environmentSubstitute(meta.getFifoDirectory());
    FileObject directory=KettleVFS.getFileObject(fifoVfsDirectory);
    directory.createFolder();
    String fifoDirectory=KettleVFS.getFilename(directory);
    data.fifoFilename=KettleVFS.getFilename(directory) + Const.FILE_SEPARATOR + tableName+ ".csv";
    data.bcpFilename=KettleVFS.getFilename(directory) + Const.FILE_SEPARATOR + tableName+ ".bcp";
    File fifoFile=new File(data.fifoFilename);
    if (!fifoFile.exists()) {
      String mkFifoCmd="mkfifo " + data.fifoFilename + "";
      logBasic("Creating FIFO file using this command : " + mkFifoCmd);
      Process mkFifoProcess=rt.exec(mkFifoCmd);
      StreamLogger errorLogger=new StreamLogger(mkFifoProcess.getErrorStream(),"mkFifoError");
      StreamLogger outputLogger=new StreamLogger(mkFifoProcess.getInputStream(),"mkFifoOuptut");
      new Thread(errorLogger).start();
      new Thread(outputLogger).start();
      int result=mkFifoProcess.waitFor();
      if (result != 0) {
        throw new Exception("Return code " + result + " received from statement : "+ mkFifoCmd);
      }
    }
    String cmd=createCommandLine(meta,true);
    logBasic("Executing command: " + cmd);
    data.mClientlProcess=rt.exec(cmd);
    data.errorLogger=new StreamLogger(data.mClientlProcess.getErrorStream(),"ERROR");
    data.outputLogger=new StreamLogger(data.mClientlProcess.getInputStream(),"OUTPUT");
    data.bulkOutputStream=data.mClientlProcess.getOutputStream();
    new Thread(data.errorLogger).start();
    new Thread(data.outputLogger).start();
    String fifoServerStatement="";
    fifoServerStatement+="create or replace server " + meta.getFifoServerName() + Const.CR;
    fifoServerStatement+="foreign data wrapper sys_file_wrapper" + Const.CR;
    fifoServerStatement+="options (" + Const.CR;
    fifoServerStatement+="directory '" + fifoDirectory + "',"+ Const.CR;
    fifoServerStatement+="file_extension 'csv'," + Const.CR;
    fifoServerStatement+="with_header 'no'," + Const.CR;
    fifoServerStatement+="num_rows_scan '0'," + Const.CR;
    fifoServerStatement+="lenient 'no');" + Const.CR;
    logBasic("Creating LucidDB fifo_server with the following command: " + fifoServerStatement);
    data.bulkOutputStream.write(fifoServerStatement.getBytes());
    data.bulkOutputStream.flush();
    createBulkLoadConfigFile(data.bcpFilename);
    executeLoadCommand(tableName);
    data.fifoStream=new BufferedOutputStream(new FileOutputStream(new File(data.fifoFilename)));
  }
 catch (  Exception ex) {
    throw new KettleException(ex);
  }
  return true;
}
