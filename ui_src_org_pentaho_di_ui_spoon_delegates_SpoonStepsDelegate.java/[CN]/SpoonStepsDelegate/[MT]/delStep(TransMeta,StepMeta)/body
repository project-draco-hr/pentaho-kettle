{
  spoon.getLog().logDebug(toString(),BaseMessages.getString(PKG,"Spoon.Log.DeleteStep") + stepMeta.getName());
  for (int i=transMeta.nrTransHops() - 1; i >= 0; i--) {
    TransHopMeta hi=transMeta.getTransHop(i);
    if (hi.getFromStep().equals(stepMeta) || hi.getToStep().equals(stepMeta)) {
      int idx=transMeta.indexOfTransHop(hi);
      spoon.addUndoDelete(transMeta,new TransHopMeta[]{(TransHopMeta)hi.clone()},new int[]{idx});
      transMeta.removeTransHop(idx);
      spoon.refreshTree();
    }
  }
  int pos=transMeta.indexOfStep(stepMeta);
  transMeta.removeStep(pos);
  spoon.addUndoDelete(transMeta,new StepMeta[]{stepMeta},new int[]{pos});
  spoon.refreshTree();
  spoon.refreshGraph();
}
