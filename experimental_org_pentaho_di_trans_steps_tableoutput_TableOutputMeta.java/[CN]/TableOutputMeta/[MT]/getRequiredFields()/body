{
  if (databaseMeta != null) {
    Database db=new Database(databaseMeta);
    try {
      db.connect();
      if (!Const.isEmpty(tablename)) {
        String schemaTable=databaseMeta.getQuotedSchemaTableCombination(schemaName,tablename);
        if (db.checkTableExists(schemaTable)) {
          return db.getTableFields(schemaTable);
        }
 else {
          throw new KettleException(Messages.getString("TableOutputMeta.Exception.TableNotFound"));
        }
      }
 else {
        throw new KettleException(Messages.getString("TableOutputMeta.Exception.TableNotSpecified"));
      }
    }
 catch (    Exception e) {
      throw new KettleException(Messages.getString("TableOutputMeta.Exception.ErrorGettingFields"),e);
    }
 finally {
      db.disconnect();
    }
  }
 else {
    throw new KettleException(Messages.getString("TableOutputMeta.Exception.ConnectionNotDefined"));
  }
}
