{
  if (data.filenr >= data.files.nrOfFiles()) {
    setOutputDone();
    return false;
  }
  Row r=new Row();
  FileObject file=data.files.getFile(data.filenr);
  Value filename=new Value("filename",file.getName().getURI());
  filename.setLength(500,-1);
  r.addValue(filename);
  Value short_filename=new Value("short_filename",file.getName().getBaseName());
  short_filename.setLength(500,-1);
  r.addValue(short_filename);
  try {
    Value path=new Value("path",file.getParent().getName().getURI());
    path.setLength(500,-1);
    r.addValue(path);
  }
 catch (  IOException e) {
    throw new KettleException(e);
  }
  data.filenr++;
  putRow(r);
  if ((linesInput > 0) && (linesInput % Const.ROWS_UPDATE) == 0)   logBasic("linenr " + linesInput);
  return true;
}
