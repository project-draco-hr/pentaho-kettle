{
  String databaseName=databaseConnection.getDatabaseName();
  String port=databaseConnection.getDatabasePort();
  String hostname=databaseConnection.getHostname();
  if (databaseConnection.getAccessType() == DatabaseAccessType.ODBC) {
    return "jdbc:odbc:" + databaseName;
  }
 else   if (databaseConnection.getAccessType() == DatabaseAccessType.NATIVE) {
    if (databaseName != null && databaseName.length() > 0 && (databaseName.startsWith("/") || databaseName.startsWith(":"))) {
      return getNativeJdbcPre() + hostname + ":"+ port+ databaseName;
    }
 else     if (Const.isEmpty(port) && (Const.isEmpty(port) || port.equals("-1"))) {
      return getNativeJdbcPre() + databaseName;
    }
 else {
      return getNativeJdbcPre() + hostname + ":"+ port+ ":"+ databaseName;
    }
  }
 else {
    if (databaseName != null && databaseName.length() > 0) {
      if (hostname != null && hostname.length() > 0 && port != null && port.length() > 0) {
        return "jdbc:oracle:oci:@(description=(address=(host=" + hostname + ")(protocol=tcp)(port="+ port+ "))(connect_data=(sid="+ databaseName+ ")))";
      }
 else {
        return "jdbc:oracle:oci:@" + databaseName;
      }
    }
 else {
      throw new KettleDatabaseException("Unable to construct a JDBC URL: at least the database name must be specified");
    }
  }
}
