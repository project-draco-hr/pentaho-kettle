{
  DatabaseMeta inf=null;
  int connr=wConnection.getSelectionIndex();
  if (connr >= 0)   inf=transMeta.getDatabase(connr);
  if (inf != null) {
    log.logDebug(toString(),Messages.getString("DatabaseLookupDialog.Log.LookingAtConnection") + inf.toString());
    DatabaseExplorerDialog std=new DatabaseExplorerDialog(shell,SWT.NONE,inf,transMeta.getDatabases());
    std.setSplitSchemaAndTable(true);
    std.setSelectedSchema(wSchema.getText());
    std.setSelectedTable(wTable.getText());
    if (std.open() != null) {
      wSchema.setText(std.getSchemaName() == null ? "" : std.getSchemaName());
      wTable.setText(std.getTableName());
    }
  }
 else {
    MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
    mb.setMessage(Messages.getString("DatabaseLookupDialog.InvalidConnection.DialogMessage"));
    mb.setText(Messages.getString("DatabaseLookupDialog.InvalidConnection.DialogTitle"));
    mb.open();
  }
}
