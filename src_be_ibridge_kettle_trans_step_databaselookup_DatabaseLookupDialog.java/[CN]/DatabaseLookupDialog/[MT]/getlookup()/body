{
  DatabaseMeta ci=transMeta.findDatabase(wConnection.getText());
  if (ci != null) {
    Database db=new Database(ci);
    try {
      db.connect();
      String tablename=wTable.getText();
      if (tablename != null && tablename.length() != 0) {
        Row r=db.getTableFields(tablename);
        if (r != null) {
          log.logDebug(toString(),Messages.getString("DatabaseLookupDialog.Log.FoundTableFields") + tablename + " --> "+ r.toStringMeta());
          BaseStepDialog.getFieldsFromPrevious(r,wReturn,1,new int[]{1,2},new int[]{4},-1,-1,null);
        }
 else {
          MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
          mb.setMessage(Messages.getString("DatabaseLookupDialog.CouldNotReadTableInfo.DialogMessage"));
          mb.setText(Messages.getString("DatabaseLookupDialog.CouldNotReadTableInfo.DialogTitle"));
          mb.open();
        }
      }
    }
 catch (    KettleException e) {
      MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
      mb.setMessage(Messages.getString("DatabaseLookupDialog.ErrorOccurred.DialogMessage") + Const.CR + e.getMessage());
      mb.setText(Messages.getString("DatabaseLookupDialog.ErrorOccurred.DialogTitle"));
      mb.open();
    }
  }
 else {
    MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
    mb.setMessage(Messages.getString("DatabaseLookupDialog.InvalidConnectionName.DialogMessage"));
    mb.setText(Messages.getString("DatabaseLookupDialog.InvalidConnectionName.DialogTitle"));
    mb.open();
  }
}
