{
  int i;
  DatabaseMeta ci=transMeta.findDatabase(wConnection.getText());
  if (ci != null) {
    Database db=new Database(ci);
    try {
      db.connect();
      String tablename=wTable.getText();
      if (tablename != null && tablename.length() != 0) {
        Row r=db.getTableFields(tablename);
        if (r != null) {
          log.logDebug(toString(),Messages.getString("DatabaseLookupDialog.Log.FoundTableFields") + tablename + " --> "+ r.toStringMeta());
          Table table=wReturn.table;
          int count=table.getItemCount();
          for (i=0; i < r.size(); i++) {
            Value v=r.getValue(i);
            TableItem ti=new TableItem(table,SWT.NONE);
            ti.setText(0,"" + (count + i + 1));
            ti.setText(1,v.getName());
            ti.setText(2,v.getName());
            ti.setText(3,"");
            ti.setText(4,v.getTypeDesc());
          }
          wReturn.removeEmptyRows();
          wReturn.setRowNums();
          wReturn.optWidth(true);
        }
 else {
          MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
          mb.setMessage(Messages.getString("DatabaseLookupDialog.CouldNotReadTableInfo.DialogMessage"));
          mb.setText(Messages.getString("DatabaseLookupDialog.CouldNotReadTableInfo.DialogTitle"));
          mb.open();
        }
      }
    }
 catch (    KettleException e) {
      MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
      mb.setMessage(Messages.getString("DatabaseLookupDialog.ErrorOccurred.DialogMessage") + Const.CR + e.getMessage());
      mb.setText(Messages.getString("DatabaseLookupDialog.ErrorOccurred.DialogTitle"));
      mb.open();
    }
  }
 else {
    MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
    mb.setMessage(Messages.getString("DatabaseLookupDialog.InvalidConnectionName.DialogMessage"));
    mb.setText(Messages.getString("DatabaseLookupDialog.InvalidConnectionName.DialogTitle"));
    mb.open();
  }
}
