{
  ArrayList sheetnames=new ArrayList();
  ExcelInputMeta info=new ExcelInputMeta();
  getInfo(info);
  String files[]=info.getFiles();
  for (int i=0; i < files.length; i++) {
    try {
      File file=new File(files[i]);
      Workbook workbook=Workbook.getWorkbook(file);
      int nrSheets=workbook.getNumberOfSheets();
      for (int j=0; j < nrSheets; j++) {
        Sheet sheet=workbook.getSheet(j);
        String sheetname=sheet.getName();
        if (Const.indexOfString(sheetname,sheetnames) < 0)         sheetnames.add(sheetname);
      }
      workbook.close();
    }
 catch (    Exception e) {
      MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
      mb.setMessage("I was unable to read the Excel file [" + files[i] + "]."+ Const.CR+ "  Please check the files, directories & expression.");
      mb.setText("ERROR");
      mb.open();
    }
  }
  String lst[]=(String[])sheetnames.toArray(new String[sheetnames.size()]);
  EnterListDialog esd=new EnterListDialog(shell,SWT.NONE,lst);
  String selection[]=esd.open();
  if (selection != null) {
    for (int j=0; j < selection.length; j++) {
      wSheetnameList.add(new String[]{selection[j],""});
    }
    wSheetnameList.removeEmptyRows();
    wSheetnameList.setRowNums();
    wSheetnameList.optWidth(true);
  }
}
