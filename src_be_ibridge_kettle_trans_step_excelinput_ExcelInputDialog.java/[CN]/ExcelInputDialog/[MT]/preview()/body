{
  ExcelInputMeta eii=new ExcelInputMeta();
  getInfo(eii);
  StepMeta stepMeta1=new StepMeta(log,"ExcelInput",stepname,eii);
  DummyTransMeta dti=new DummyTransMeta();
  StepMeta stepMeta2=new StepMeta(log,"DummyTrans","Dummy step",dti);
  TransHopMeta hop=new TransHopMeta(stepMeta1,stepMeta2);
  TransMeta ti=new TransMeta((String)null,"Preview run",null);
  ti.addStep(stepMeta1);
  ti.addStep(stepMeta2);
  ti.addTransHop(hop);
  Trans tr=new Trans(log,ti,new String[]{stepMeta2.getName()},new int[]{100});
  tr.execute(new String[]{"dummy transMeta"});
  tr.waitUntilFinished();
  BaseStep bs=tr.findRunThread(stepMeta2.getName());
  if (bs.previewBuffer != null && bs.previewBuffer.size() > 0) {
    PreviewRowsDialog prd=new PreviewRowsDialog(shell,SWT.NONE,stepMeta2.getName(),bs.previewBuffer);
    prd.open();
  }
 else {
    MessageBox mb=new MessageBox(shell,SWT.OK | SWT.ICON_ERROR);
    mb.setMessage("No rows found!.");
    mb.setText("ERROR");
    mb.open();
  }
}
