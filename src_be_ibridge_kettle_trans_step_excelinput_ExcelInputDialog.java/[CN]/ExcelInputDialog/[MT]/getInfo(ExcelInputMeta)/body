{
  stepname=wStepname.getText();
  meta.setRowLimit(Const.toLong(wLimit.getText(),0));
  meta.setFileField(wInclFilenameField.getText());
  meta.setSheetField(wInclSheetnameField.getText());
  meta.setSheetRowNumberField(wInclSheetRownumField.getText());
  meta.setRowNumberField(wInclRownumField.getText());
  meta.setStartsWithHeader(wHeader.getSelection());
  meta.setIgnoreEmptyRows(wNoempty.getSelection());
  meta.setStopOnEmpty(wStoponempty.getSelection());
  meta.setAcceptingFilenames(wAccFilenames.getSelection());
  meta.setAcceptingField(wAccField.getText());
  meta.setAcceptingStep(transMeta.findStep(wAccStep.getText()));
  int nrfiles=wFilenameList.nrNonEmpty();
  int nrsheets=wSheetnameList.nrNonEmpty();
  int nrfields=wFields.nrNonEmpty();
  meta.allocate(nrfiles,nrsheets,nrfields);
  for (int i=0; i < nrfiles; i++) {
    TableItem item=wFilenameList.getNonEmpty(i);
    meta.getFileName()[i]=item.getText(1);
    meta.getFileMask()[i]=item.getText(2);
    meta.getFileRequired()[i]=item.getText(3);
  }
  for (int i=0; i < nrsheets; i++) {
    TableItem item=wSheetnameList.getNonEmpty(i);
    meta.getSheetName()[i]=item.getText(1);
    meta.getStartRow()[i]=Const.toInt(item.getText(2),0);
    meta.getStartColumn()[i]=Const.toInt(item.getText(3),0);
  }
  for (int i=0; i < nrfields; i++) {
    TableItem item=wFields.getNonEmpty(i);
    meta.getField()[i]=new ExcelInputField();
    meta.getField()[i].setName(item.getText(1));
    meta.getField()[i].setType(Value.getType(item.getText(2)));
    String slength=item.getText(3);
    String sprec=item.getText(4);
    meta.getField()[i].setTrimType(ExcelInputMeta.getTrimTypeByDesc(item.getText(5)));
    meta.getField()[i].setRepeated(Messages.getString("System.Combo.Yes").equalsIgnoreCase(item.getText(6)));
    meta.getField()[i].setLength(Const.toInt(slength,-1));
    meta.getField()[i].setPrecision(Const.toInt(sprec,-1));
    meta.getField()[i].setFormat(item.getText(7));
    meta.getField()[i].setCurrencySymbol(item.getText(8));
    meta.getField()[i].setDecimalSymbol(item.getText(9));
    meta.getField()[i].setGroupSymbol(item.getText(10));
  }
  meta.setStrictTypes(wStrictTypes.getSelection());
  meta.setErrorIgnored(wErrorIgnored.getSelection());
  meta.setErrorLineSkipped(wSkipErrorLines.getSelection());
  meta.setWarningFilesDestinationDirectory(wWarningDestDir.getText());
  meta.setBadLineFilesExtension(wWarningExt.getText());
  meta.setErrorFilesDestinationDirectory(wErrorDestDir.getText());
  meta.setErrorFilesExtension(wErrorExt.getText());
  meta.setLineNumberFilesDestinationDirectory(wLineNrDestDir.getText());
  meta.setLineNumberFilesExtension(wLineNrExt.getText());
}
