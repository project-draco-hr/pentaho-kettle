{
  Object[] row=new Object[0];
  if (data.document == null) {
    data.filename=null;
  }
 else   if (!data.document.hasNext()) {
    data.filename=null;
  }
  if (data.filename == null) {
    if (!openNextFile()) {
      return null;
    }
  }
  row=data.document.getNext();
  if (meta.includeFilename() && meta.getFilenameField() != null && meta.getFilenameField().length() > 0) {
    ValueMetaAndData fn=new ValueMetaAndData(meta.getFilenameField(),data.filename);
    row=RowDataUtil.addValueData(row,fn);
  }
  if (meta.includeRowNumber() && meta.getRowNumberField() != null && meta.getRowNumberField().length() > 0) {
    ValueMetaAndData fn=new ValueMetaAndData(meta.getRowNumberField(),new Long(data.rownr));
    row=RowDataUtil.addValueData(row,fn);
  }
  System.arraycopy(row,0,data.previousRow,0,row.length);
  data.rownr++;
  return row;
}
