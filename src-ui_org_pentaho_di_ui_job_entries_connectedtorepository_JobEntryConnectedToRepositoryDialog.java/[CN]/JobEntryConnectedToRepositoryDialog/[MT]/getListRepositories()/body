{
  RepositoriesMeta reps_info=null;
  try {
    LogWriter log=LogWriter.getInstance();
    reps_info=new RepositoriesMeta(log);
    if (!reps_info.readData()) {
      displayMsg(Messages.getString("JobEntryConnectedToRepositoryDialog.Error.NoRepsDefined"),Messages.getString("JobEntryConnectedToRepositoryDialog.Error.NoRepsDefinedMsg"),true);
    }
 else {
      int nrRepositories=reps_info.nrRepositories();
      if (nrRepositories == 0) {
        displayMsg(Messages.getString("System.Dialog.Error.Title"),Messages.getString("JobEntryConnectedToRepositoryDialog.Error.NoRep.DialogMessage"),true);
      }
 else {
        String available[]=new String[nrRepositories];
        for (int i=0; i < nrRepositories; i++) {
          RepositoryMeta ri=reps_info.getRepository(i);
          available[i]=ri.getName();
        }
        String[] source=new String[1];
        source[0]=wRepName.getText();
        int idxSource[]=Const.indexsOfStrings(source,available);
        EnterSelectionDialog dialog=new EnterSelectionDialog(shell,available,Messages.getString("JobEntryConnectedToRepositoryDialog.SelectRepository.Title"),Messages.getString("JobEntryConnectedToRepositoryDialog.SelectRepository.Message"));
        dialog.setMulti(false);
        dialog.setSelectedNrs(idxSource);
        if (dialog.open() != null) {
          int idx[]=dialog.getSelectionIndeces();
          wRepName.setText(available[idx[0]]);
        }
      }
    }
  }
 catch (  Exception e) {
    displayMsg(Messages.getString("System.Dialog.Error.Title"),Messages.getString("JobEntryConnectedToRepositoryDialog.ErrorGettingRepositories.DialogMessage") + Const.CR + ":"+ e.getMessage(),true);
  }
 finally {
    reps_info.clear();
  }
}
