{
  List commands=new ArrayList();
  commands.add("jar");
  commands.add("cvf");
  commands.add(karFile.getPath());
  commands.add("-m");
  commands.add(manifestFile.getPath());
  commands.add(transFile.getPath());
  for (int i=0; i < directories.length; i++) {
    commands.add(directories[i].getPath() + Const.FILE_SEPARATOR + "*.*");
  }
  String[] cmd=(String[])commands.toArray(new String[commands.size()]);
  Runtime runtime=java.lang.Runtime.getRuntime();
  Process proc=runtime.exec(cmd,EnvUtil.getEnvironmentVariablesForRuntimeExec(),karDirectory);
  StreamLogger errorLogger=new StreamLogger(proc.getErrorStream(),"Jar generator (stderr)");
  StreamLogger outputLogger=new StreamLogger(proc.getInputStream(),"Jar generator (stdout)");
  new Thread(errorLogger).start();
  new Thread(outputLogger).start();
  proc.waitFor();
  log.logDetailed("Jar generator","command [" + cmd[0] + "] has finished");
  if (proc.exitValue() != 0) {
    log.logDetailed("Jar generator","Exit status of jar command was " + proc.exitValue());
  }
}
