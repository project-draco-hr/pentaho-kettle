{
  if (Const.isEmpty(wStepname.getText()))   return;
  stepname=wStepname.getText();
  try {
    loadTransformation();
  }
 catch (  KettleException e) {
    new ErrorDialog(shell,BaseMessages.getString(PKG,"SingleThreaderDialog.ErrorLoadingSpecifiedTransformation.Title"),BaseMessages.getString(PKG,"SingleThreaderDialog.ErrorLoadingSpecifiedTransformation.Message"),e);
  }
  singleThreaderMeta.setSpecificationMethod(specificationMethod);
switch (specificationMethod) {
case FILENAME:
    singleThreaderMeta.setFileName(wFilename.getText());
  singleThreaderMeta.setDirectoryPath(null);
singleThreaderMeta.setTransName(null);
singleThreaderMeta.setTransObjectId(null);
break;
case REPOSITORY_BY_NAME:
singleThreaderMeta.setDirectoryPath(wDirectory.getText());
singleThreaderMeta.setTransName(wTransname.getText());
singleThreaderMeta.setFileName(null);
singleThreaderMeta.setTransObjectId(null);
break;
case REPOSITORY_BY_REFERENCE:
singleThreaderMeta.setFileName(null);
singleThreaderMeta.setDirectoryPath(null);
singleThreaderMeta.setTransName(null);
singleThreaderMeta.setTransObjectId(referenceObjectId);
break;
}
singleThreaderMeta.setBatchSize(wBatchSize.getText());
singleThreaderMeta.setInjectStep(wInjectStep.getText());
singleThreaderMeta.setRetrieveStep(wRetrieveStep.getText());
dispose();
}
