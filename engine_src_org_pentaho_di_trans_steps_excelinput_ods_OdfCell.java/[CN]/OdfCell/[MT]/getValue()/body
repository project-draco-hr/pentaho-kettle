{
  try {
switch (getType()) {
case BOOLEAN_FORMULA:
case BOOLEAN:
      return Boolean.valueOf(cell.getBooleanValue());
case DATE_FORMULA:
case DATE:
    long time=cell.getDateValue().getTime().getTime();
  long tzOffset=TimeZone.getDefault().getOffset(time);
return new Date(time + tzOffset);
case NUMBER_FORMULA:
case NUMBER:
return Double.valueOf(cell.getDoubleValue());
case STRING_FORMULA:
case LABEL:
return cell.getStringValue();
case EMPTY:
default :
return null;
}
}
 catch (Exception e) {
throw new RuntimeException("Unable to get value of cell (" + cell.getColumnIndex() + ", "+ cell.getRowIndex()+ ")",e);
}
}
