{
  if (getDisplay().isDisposed())   return;
  getDisplay().asyncExec(new Runnable(){
    public void run(){
      boolean running=job != null && job.isActive();
      XulToolbarbutton runButton=(XulToolbarbutton)toolbar.getElementById("job-run");
      if (runButton != null && !controlDisposed(runButton)) {
        runButton.setDisabled(running);
      }
      XulToolbarbutton stopButton=(XulToolbarbutton)toolbar.getElementById("job-stop");
      if (stopButton != null && !controlDisposed(stopButton)) {
        stopButton.setDisabled(!running);
      }
      XulToolbarbutton versionsButton=(XulToolbarbutton)toolbar.getElementById("browse-versions");
      if (versionsButton != null && !controlDisposed(versionsButton)) {
        boolean hasRepository=spoon.rep != null;
        boolean enabled=hasRepository && spoon.rep.getRepositoryMeta().getRepositoryCapabilities().supportsRevisions();
        versionsButton.setDisabled(!enabled);
      }
    }
  }
);
}
