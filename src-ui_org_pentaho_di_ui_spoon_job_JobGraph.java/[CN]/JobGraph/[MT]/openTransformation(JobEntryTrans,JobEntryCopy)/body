{
  String exactFilename=jobMeta.environmentSubstitute(entry.getFilename());
  String exactTransname=jobMeta.environmentSubstitute(entry.getTransname());
  TabMapEntry tabEntry=spoon.delegates.tabs.findTabMapEntry(exactFilename,ObjectType.TRANSFORMATION_GRAPH);
  if (tabEntry == null) {
    tabEntry=spoon.delegates.tabs.findTabMapEntry(Const.filenameOnly(exactFilename),ObjectType.TRANSFORMATION_GRAPH);
  }
  if (tabEntry != null) {
    spoon.tabfolder.setSelected(tabEntry.getTabItem());
    return;
  }
  if (TransMeta.isRepReference(exactFilename,exactTransname)) {
    try {
      TransMeta newTrans;
      boolean exists=spoon.rep.getTransformationID(exactTransname,spoon.rep.loadRepositoryDirectoryTree().findDirectory(entry.getDirectory())) != null;
      if (!exists) {
        newTrans=new TransMeta(null,exactTransname,entry.arguments);
      }
 else {
        newTrans=spoon.rep.loadTransformation(exactTransname,spoon.rep.loadRepositoryDirectoryTree().findDirectory(entry.getDirectory()),null,true,null);
      }
      copyInternalJobVariables(jobMeta,newTrans);
      spoon.setParametersAsVariablesInUI(newTrans,newTrans);
      spoon.addTransGraph(newTrans);
      newTrans.clearChanged();
      TransGraph transGraph=spoon.getActiveTransGraph();
      attachActiveTrans(transGraph,newTrans,jobEntryCopy);
      spoon.open();
    }
 catch (    Throwable e) {
      new ErrorDialog(shell,BaseMessages.getString(PKG,"JobGraph.Dialog.ErrorLaunchingSpoonCanNotLoadTransformation.Title"),BaseMessages.getString(PKG,"JobGraph.Dialog.ErrorLaunchingSpoonCanNotLoadTransformation.Message"),(Exception)e);
    }
  }
 else {
    try {
      if (Const.isEmpty(exactFilename)) {
        throw new Exception(BaseMessages.getString(PKG,"JobGraph.Exception.NoFilenameSpecified"));
      }
      TransMeta launchTransMeta=null;
      if (KettleVFS.fileExists(exactFilename)) {
        launchTransMeta=new TransMeta(exactFilename);
      }
 else {
        launchTransMeta=new TransMeta();
      }
      launchTransMeta.clearChanged();
      launchTransMeta.setFilename(exactFilename);
      copyInternalJobVariables(jobMeta,launchTransMeta);
      spoon.setParametersAsVariablesInUI(launchTransMeta,launchTransMeta);
      spoon.addTransGraph(launchTransMeta);
      TransGraph transGraph=spoon.getActiveTransGraph();
      attachActiveTrans(transGraph,launchTransMeta,jobEntryCopy);
      spoon.open();
    }
 catch (    Throwable e) {
      new ErrorDialog(shell,BaseMessages.getString(PKG,"JobGraph.Dialog.ErrorLaunchingSpoonCanNotLoadTransformationFromXML.Title"),BaseMessages.getString(PKG,"JobGraph.Dialog.ErrorLaunchingSpoonCanNotLoadTransformationFromXML.Message"),(Exception)e);
    }
  }
  spoon.applyVariables();
}
