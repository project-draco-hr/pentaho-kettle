{
  RowMetaInterface rowMeta=new RowMeta();
  rowMeta.addValueMeta(new ValueMetaTimestamp("DATE_FROM"));
  rowMeta.addValueMeta(new ValueMetaTimestamp("DATE_TO"));
  int[] keyIndexes=new int[]{};
  int fromDateIndex=0;
  int toDateIndex=1;
  DimensionCache dc=new DimensionCache(rowMeta,keyIndexes,fromDateIndex,toDateIndex);
  long t0=1425300000000L;
  final Date D1=new Timestamp(t0);
  final Date D2=new Timestamp(t0 + 3600000L);
  final Date D3=new Timestamp(t0 + 3600000L * 2);
  final Date D4=new Timestamp(t0 + 3600000L * 3);
  final Date D5=new Timestamp(t0 + 3600000L * 4);
  assertCompareDateInterval(dc,null,null,null,null,0);
  assertCompareDateInterval(dc,null,null,D1,null,-1);
  assertCompareDateInterval(dc,D2,null,null,null,1);
  assertCompareDateInterval(dc,D2,null,D1,null,1);
  assertCompareDateInterval(dc,D2,null,D2,null,0);
  assertCompareDateInterval(dc,D2,null,D3,null,-1);
  assertCompareDateInterval(dc,D2,D4,null,null,1);
  assertCompareDateInterval(dc,D2,D4,D1,null,1);
  assertCompareDateInterval(dc,D2,D4,D2,null,0);
  assertCompareDateInterval(dc,D2,D4,D3,null,0);
  assertCompareDateInterval(dc,D2,D4,D4,null,-1);
  assertCompareDateInterval(dc,D2,D4,D5,null,-1);
  assertCompareDateInterval(dc,null,D4,null,null,0);
  assertCompareDateInterval(dc,null,D4,D3,null,0);
  assertCompareDateInterval(dc,null,D4,D4,null,-1);
  assertCompareDateInterval(dc,null,D4,D5,null,-1);
}
