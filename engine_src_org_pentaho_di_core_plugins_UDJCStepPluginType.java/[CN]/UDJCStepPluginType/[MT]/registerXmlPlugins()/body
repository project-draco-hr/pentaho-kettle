{
  for (  PluginFolderInterface folder : pluginFolders) {
    if (folder.isPluginXmlFolder()) {
      List<FileObject> pluginKtrFiles=findStepPluginFiles(folder.getFolder());
      for (      FileObject file : pluginKtrFiles) {
        try {
          Document document=XMLHandler.loadXMLFile(file);
          Node transNode=XMLHandler.getSubNode(document,"transformation");
          Node startNode=(transNode != null) ? transNode : document;
          int numSteps=XMLHandler.countNodes(startNode,"step");
          for (int stepIndex=0; stepIndex < numSteps; stepIndex++) {
            Node stepNode=XMLHandler.getSubNodeByNr(startNode,"step",stepIndex);
            Node udjcNode=XMLHandler.getSubNode(stepNode,"type");
            if (udjcNode != null && udjcNode.getTextContent().trim().equals("UserDefinedJavaClass")) {
              registerUDJCPluginFromXmlResource(stepNode,KettleVFS.getFilename(file.getParent()),this.getClass(),false,file.getParent().getURL());
            }
          }
        }
 catch (        Exception e) {
          log.logError("Error found while reading step plugin.xml file: " + file.getName().toString(),e);
        }
      }
    }
  }
}
