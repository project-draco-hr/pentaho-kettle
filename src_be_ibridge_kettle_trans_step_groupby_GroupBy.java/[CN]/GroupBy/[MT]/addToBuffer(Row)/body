{
  data.bufferList.add(row);
  if (data.bufferList.size() > 5000) {
    if (data.rowsOnFile == 0) {
      try {
        data.tempFile=File.createTempFile(meta.getPrefix(),".tmp",new File(StringUtil.environmentSubstitute(meta.getDirectory())));
        data.fos=new FileOutputStream(data.tempFile);
        data.dos=new DataOutputStream(data.fos);
        data.firstRead=true;
      }
 catch (      IOException e) {
        throw new KettleFileException("Unable to create temporary file",e);
      }
    }
    Row oldest=(Row)data.bufferList.get(0);
    oldest.write(data.dos);
    data.bufferList.remove(0);
    data.rowsOnFile++;
  }
}
