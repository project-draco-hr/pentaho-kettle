{
  for (int i=0; i < data.subjectnrs.length; i++) {
    Value subj=r.getValue(data.subjectnrs[i]);
    Value value=data.agg.getValue(i);
switch (meta.getAggregateType()[i]) {
case GroupByMeta.TYPE_GROUP_SUM:
      value.plus(subj);
    break;
case GroupByMeta.TYPE_GROUP_AVERAGE:
  value.plus(subj);
data.counts[i]++;
break;
case GroupByMeta.TYPE_GROUP_COUNT_ALL:
data.counts[i]++;
break;
case GroupByMeta.TYPE_GROUP_MIN:
if (subj.compare(value) < 0) value.setValue(subj);
break;
case GroupByMeta.TYPE_GROUP_MAX:
if (subj.compare(value) > 0) value.setValue(subj);
break;
case GroupByMeta.TYPE_GROUP_CONCAT_COMMA:
if (!subj.isNull()) {
if (value.getStringLength() > 0) value.setValue(value.getString() + ", ");
value.setValue(value.getString() + subj.getString());
}
break;
default :
break;
}
}
}
