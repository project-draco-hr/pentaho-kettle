{
  String sql;
  int i;
  sql="SELECT " + databaseMeta.quoteField(tk) + ", "+ databaseMeta.quoteField(version);
  if (extra != null) {
    for (i=0; i < extra.length; i++) {
      if (extra[i] != null && extra[i].length() != 0) {
        sql+=", " + databaseMeta.quoteField(extra[i]);
        if (extraRename[i] != null && extraRename[i].length() > 0 && !extra[i].equals(extraRename[i])) {
          sql+=" AS " + databaseMeta.quoteField(extraRename[i]);
        }
      }
    }
  }
  sql+=" FROM " + databaseMeta.quoteField(table) + " WHERE ";
  for (i=0; i < keys.length; i++) {
    if (i != 0)     sql+=" AND ";
    sql+=databaseMeta.quoteField(keys[i]) + " = ? ";
  }
  sql+=" AND ? >= " + databaseMeta.quoteField(datefrom) + " AND ? < "+ databaseMeta.quoteField(dateto);
  try {
    log.logDetailed(toString(),"Dimension Lookup setting preparedStatement to [" + sql + "]");
    prepStatementLookup=connection.prepareStatement(databaseMeta.stripCR(sql));
    if (databaseMeta.supportsSetMaxRows()) {
      prepStatementLookup.setMaxRows(1);
    }
    if (databaseMeta.getDatabaseType() == DatabaseMeta.TYPE_DATABASE_MYSQL) {
      prepStatementLookup.setFetchSize(0);
    }
    log.logDetailed(toString(),"Finished preparing dimension lookup statement.");
  }
 catch (  SQLException ex) {
    throw new KettleDatabaseException("Unable to prepare dimension lookup",ex);
  }
  return true;
}
