{
  Row par=new Row();
  try {
    ParameterMetaData pmd=ps.getParameterMetaData();
    for (int i=1; i < pmd.getParameterCount(); i++) {
      String name="par" + i;
      int sqltype=pmd.getParameterType(i);
      int length=pmd.getPrecision(i);
      int precision=pmd.getScale(i);
      Value val;
switch (sqltype) {
case java.sql.Types.CHAR:
case java.sql.Types.VARCHAR:
        val=new Value(name,Value.VALUE_TYPE_STRING);
      break;
case java.sql.Types.BIGINT:
case java.sql.Types.INTEGER:
case java.sql.Types.NUMERIC:
case java.sql.Types.SMALLINT:
case java.sql.Types.TINYINT:
    val=new Value(name,Value.VALUE_TYPE_INTEGER);
  break;
case java.sql.Types.DECIMAL:
case java.sql.Types.DOUBLE:
case java.sql.Types.FLOAT:
case java.sql.Types.REAL:
val=new Value(name,Value.VALUE_TYPE_NUMBER);
break;
case java.sql.Types.DATE:
case java.sql.Types.TIME:
case java.sql.Types.TIMESTAMP:
val=new Value(name,Value.VALUE_TYPE_DATE);
break;
case java.sql.Types.BOOLEAN:
case java.sql.Types.BIT:
val=new Value(name,Value.VALUE_TYPE_BOOLEAN);
break;
default :
val=new Value(name,Value.VALUE_TYPE_NONE);
break;
}
if (val.isNumeric() && (length > 18 || precision > 18)) {
val=new Value(name,Value.VALUE_TYPE_BIGNUMBER);
}
val.setNull();
par.addValue(val);
}
}
 catch (AbstractMethodError e) {
return null;
}
catch (SQLException e) {
return null;
}
catch (Exception e) {
return null;
}
return par;
}
