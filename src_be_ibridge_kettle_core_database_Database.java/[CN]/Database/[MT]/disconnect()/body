{
  try {
    if (connection == null)     return;
    if (connection.isClosed())     return;
    if (!isAutoCommit())     commit();
    if (pstmt != null) {
      pstmt.close();
      pstmt=null;
    }
    if (prepStatementLookup != null) {
      prepStatementLookup.close();
      prepStatementLookup=null;
    }
    if (prepStatementInsert != null) {
      prepStatementInsert.close();
      prepStatementInsert=null;
    }
    if (prepStatementUpdate != null) {
      prepStatementUpdate.close();
      prepStatementUpdate=null;
    }
    if (pstmt_seq != null) {
      pstmt_seq.close();
      pstmt_seq=null;
    }
    if (connection != null) {
      connection.close();
      connection=null;
    }
    log.logDetailed(toString(),"Connection to database closed!");
  }
 catch (  SQLException ex) {
    log.logError(toString(),"Error disconnecting from database:" + Const.CR + ex.getMessage());
  }
catch (  KettleDatabaseException dbe) {
    log.logError(toString(),"Error disconnecting from database:" + Const.CR + dbe.getMessage());
  }
}
