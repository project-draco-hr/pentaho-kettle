{
  try {
    Class.forName(classname);
  }
 catch (  NoClassDefFoundError e) {
    throw new KettleDatabaseException("Exception while loading class",e);
  }
catch (  ClassNotFoundException e) {
    throw new KettleDatabaseException("Exception while loading class",e);
  }
catch (  Exception e) {
    throw new KettleDatabaseException("Exception while loading class",e);
  }
  try {
    String url=StringUtil.environmentSubstitute(databaseMeta.getURL());
    String userName=StringUtil.environmentSubstitute(databaseMeta.getUsername());
    String password=StringUtil.environmentSubstitute(databaseMeta.getPassword());
    connection=DriverManager.getConnection(url,userName,password);
  }
 catch (  SQLException e) {
    throw new KettleDatabaseException("Error connecting to database: (using class " + classname + ")",e);
  }
catch (  Throwable e) {
    throw new KettleDatabaseException("Error connecting to database: (using class " + classname + ")",e);
  }
}
