{
  String debug="start";
  Row ret;
  ResultSet res=null;
  try {
    debug="pstmt.executeQuery()";
    res=ps.executeQuery();
    debug="getRowInfo()";
    rowinfo=getRowInfo(res.getMetaData());
    debug="getRow(res)";
    ret=getRow(res);
    if (failOnMultipleResults) {
      if (res.next()) {
        throw new KettleDatabaseException("Only 1 row was expected as a result of a lookup, and at least 2 were found!");
      }
    }
    debug="res.close()";
    return ret;
  }
 catch (  SQLException ex) {
    throw new KettleDatabaseException("Error looking up row in database (" + debug + ")",ex);
  }
 finally {
    try {
      if (res != null)       res.close();
    }
 catch (    SQLException e) {
      throw new KettleDatabaseException("Unable to close resultset after looking up data",e);
    }
  }
}
