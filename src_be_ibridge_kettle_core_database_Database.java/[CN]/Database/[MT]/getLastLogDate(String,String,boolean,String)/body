{
  Row row=null;
  String jobtrans=job ? "JOBNAME" : "TRANSNAME";
  String sql="";
  sql+=" SELECT ENDDATE, DEPDATE, STARTDATE";
  sql+=" FROM " + logtable;
  sql+=" WHERE  ERRORS    = 0";
  sql+=" AND    STATUS    = 'end'";
  sql+=" AND    " + jobtrans + " = ?";
  sql+=" ORDER BY LOGDATE DESC, ENDDATE DESC";
  try {
    pstmt=connection.prepareStatement(databaseMeta.stripCR(sql));
    Row r=new Row();
    r.addValue(new Value("TRANSNAME",name));
    setValues(r);
    ResultSet res=pstmt.executeQuery();
    if (res != null) {
      rsmd=res.getMetaData();
      rowinfo=getRowInfo();
      row=getRow(res);
      res.close();
    }
    pstmt.close();
    pstmt=null;
  }
 catch (  SQLException ex) {
    throw new KettleDatabaseException("Unable to obtain last logdate from table " + logtable,ex);
  }
  return row;
}
