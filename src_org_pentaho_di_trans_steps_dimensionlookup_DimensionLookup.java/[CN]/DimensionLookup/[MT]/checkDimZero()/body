{
  DatabaseMeta databaseMeta=meta.getDatabaseMeta();
  int start_tk=databaseMeta.getNotFoundTK(isAutoIncrement());
  String sql="SELECT count(*) FROM " + data.schemaTable + " WHERE "+ databaseMeta.quoteField(meta.getKeyField())+ " = "+ start_tk;
  RowMetaAndData r=data.db.getOneRow(sql);
  Long count=r.getRowMeta().getInteger(r.getData(),0);
  if (count.longValue() == 0) {
    String isql=null;
    try {
      if (!databaseMeta.supportsAutoinc() || !isAutoIncrement()) {
        isql="insert into " + data.schemaTable + "("+ databaseMeta.quoteField(meta.getKeyField())+ ", "+ databaseMeta.quoteField(meta.getVersionField())+ ") values (0, 1)";
      }
 else {
switch (databaseMeta.getDatabaseType()) {
case DatabaseMeta.TYPE_DATABASE_CACHE:
case DatabaseMeta.TYPE_DATABASE_GUPTA:
case DatabaseMeta.TYPE_DATABASE_ORACLE:
          isql="insert into " + data.schemaTable + "("+ databaseMeta.quoteField(meta.getKeyField())+ ", "+ databaseMeta.quoteField(meta.getVersionField())+ ") values (0, 1)";
        break;
case DatabaseMeta.TYPE_DATABASE_INFORMIX:
case DatabaseMeta.TYPE_DATABASE_MYSQL:
      isql="insert into " + data.schemaTable + "("+ databaseMeta.quoteField(meta.getKeyField())+ ", "+ databaseMeta.quoteField(meta.getVersionField())+ ") values (1, 1)";
    break;
case DatabaseMeta.TYPE_DATABASE_MSSQL:
case DatabaseMeta.TYPE_DATABASE_DB2:
case DatabaseMeta.TYPE_DATABASE_DBASE:
case DatabaseMeta.TYPE_DATABASE_GENERIC:
case DatabaseMeta.TYPE_DATABASE_SYBASE:
case DatabaseMeta.TYPE_DATABASE_ACCESS:
case DatabaseMeta.TYPE_DATABASE_DERBY:
  isql="insert into " + data.schemaTable + "("+ databaseMeta.quoteField(meta.getVersionField())+ ") values (1)";
break;
default :
isql="insert into " + data.schemaTable + "("+ databaseMeta.quoteField(meta.getKeyField())+ ", "+ databaseMeta.quoteField(meta.getVersionField())+ ") values (0, 1)";
break;
}
}
data.db.execStatement(databaseMeta.stripCR(isql));
}
 catch (KettleException e) {
throw new KettleDatabaseException("Error inserting 'unknown' row in dimension [" + data.schemaTable + "] : "+ isql,e);
}
}
}
