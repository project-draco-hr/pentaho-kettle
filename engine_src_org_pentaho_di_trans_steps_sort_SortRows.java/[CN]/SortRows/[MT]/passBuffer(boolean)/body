{
  Object[] r=getBuffer();
  Object[] previousRow=null;
  while (r != null && !isStopped()) {
    if (log.isRowLevel())     logRowlevel("Read row: " + getInputRowMeta().getString(r));
    if (meta.isOnlyPassingUniqueRows()) {
      if (previousRow != null) {
        int result=data.outputRowMeta.compare(r,previousRow,data.fieldnrs);
        if (result != 0) {
          putRow(data.outputRowMeta,r);
        }
      }
 else {
        putRow(data.outputRowMeta,r);
      }
      previousRow=r;
    }
 else {
      putRow(data.outputRowMeta,r);
    }
    r=getBuffer();
  }
  clearBuffers();
  if (signal)   setOutputDone();
}
