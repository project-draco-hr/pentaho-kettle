{
  ValueMetaInterface meta=v.getValueMeta();
  Object data=v.getValueData();
switch (meta.getType()) {
case ValueMetaInterface.TYPE_STRING:
    return '"' + meta.getString(data) + '"';
case ValueMetaInterface.TYPE_NUMBER:
  return sqlNumericFormat.format(meta.getNumber(data));
case ValueMetaInterface.TYPE_INTEGER:
return sqlNumericFormat.format(meta.getInteger(data));
case ValueMetaInterface.TYPE_BIGNUMBER:
return sqlNumericFormat.format(meta.getBigNumber(data));
case ValueMetaInterface.TYPE_DATE:
return "{ $date : \"" + jsonDateFormat.format(meta.getBigNumber(data)) + "\" }";
default :
throw new KettleValueException("Converting data type " + meta.toStringMeta() + " to a JSON value is not yet supported");
}
}
