{
  tfoi.setFileName(wFilename.getText());
  tfoi.setFileAsCommand(wFileIsCommand.getSelection());
  tfoi.setServletOutput(wServletOutput.getSelection());
  tfoi.setCreateParentFolder(wCreateParentFolder.getSelection());
  tfoi.setDoNotOpenNewFileInit(wDoNotOpenNewFileInit.getSelection());
  tfoi.setFileFormat(TextFileOutputMeta.formatMapperLineTerminator[wFormat.getSelectionIndex()]);
  tfoi.setFileCompression(wCompression.getText());
  tfoi.setEncoding(wEncoding.getText());
  tfoi.setSeparator(wSeparator.getText());
  tfoi.setEnclosure(wEnclosure.getText());
  tfoi.setExtension(wExtension.getText());
  tfoi.setSplitEvery(Const.toInt(wSplitEvery.getText(),0));
  tfoi.setEndedLine(wEndedLine.getText());
  tfoi.setFileNameField(wFileNameField.getText());
  tfoi.setFileNameInField(wFileNameInField.getSelection());
  tfoi.setEnclosureForced(wEnclForced.getSelection());
  tfoi.setEnclosureFixDisabled(wDisableEnclosureFix.getSelection());
  tfoi.setHeaderEnabled(wHeader.getSelection());
  tfoi.setFooterEnabled(wFooter.getSelection());
  tfoi.setFileAppended(wAppend.getSelection());
  System.out.println("wAppend.getSelection()-1: " + wAppend.getSelection());
  tfoi.setStepNrInFilename(wAddStepnr.getSelection());
  tfoi.setPartNrInFilename(wAddPartnr.getSelection());
  tfoi.setDateInFilename(wAddDate.getSelection());
  tfoi.setTimeInFilename(wAddTime.getSelection());
  tfoi.setDateTimeFormat(wDateTimeFormat.getText());
  tfoi.setSpecifyingFormat(wSpecifyFormat.getSelection());
  tfoi.setPadded(wPad.getSelection());
  tfoi.setAddToResultFiles(wAddToResult.getSelection());
  tfoi.setFastDump(wFastDump.getSelection());
  int i;
  int nrfields=wFields.nrNonEmpty();
  tfoi.allocate(nrfields);
  for (i=0; i < nrfields; i++) {
    TextFileField field=new TextFileField();
    TableItem item=wFields.getNonEmpty(i);
    field.setName(item.getText(1));
    field.setType(item.getText(2));
    field.setFormat(item.getText(3));
    field.setLength(Const.toInt(item.getText(4),-1));
    field.setPrecision(Const.toInt(item.getText(5),-1));
    field.setCurrencySymbol(item.getText(6));
    field.setDecimalSymbol(item.getText(7));
    field.setGroupingSymbol(item.getText(8));
    field.setTrimType(ValueMeta.getTrimTypeByDesc(item.getText(9)));
    field.setNullString(item.getText(10));
    tfoi.getOutputFields()[i]=field;
  }
}
