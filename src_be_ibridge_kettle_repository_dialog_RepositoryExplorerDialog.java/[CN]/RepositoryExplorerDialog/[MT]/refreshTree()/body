{
  try {
    wTree.removeAll();
    rep.setDirectoryTree(new RepositoryDirectory(rep));
    TreeItem tiTree=new TreeItem(wTree,SWT.NONE);
    tiTree.setText(rep.getName() == null ? "-" : rep.getName());
    TreeItem tiObj=new TreeItem(tiTree,SWT.NONE);
    tiObj.setText(STRING_OBJECTS);
    TreeItem tiDB=new TreeItem(tiObj,SWT.NONE);
    tiDB.setText(STRING_DATABASES);
    String dbs[]=rep.getDatabaseNames();
    for (int i=0; i < dbs.length; i++) {
      TreeItem newDB=new TreeItem(tiDB,SWT.NONE);
      newDB.setText(dbs[i]);
    }
    tiDB.setExpanded(false);
    if (userinfo.useTransformations()) {
      TreeItem tiCat=new TreeItem(tiObj,SWT.NONE);
      tiCat.setText(STRING_TRANSFORMATIONS);
      TreeItem newCat=new TreeItem(tiCat,SWT.NONE);
      rep.getDirectoryTree().getTreeWithNames(newCat,rep,dircolor,true,false,false);
      tiCat.setExpanded(true);
    }
    if (userinfo.useJobs()) {
      TreeItem tiJob=new TreeItem(tiObj,SWT.NONE);
      tiJob.setText(STRING_JOBS);
      TreeItem newJob=new TreeItem(tiJob,SWT.NONE);
      rep.getDirectoryTree().getTreeWithNames(newJob,rep,dircolor,false,true,false);
      tiJob.setExpanded(true);
    }
    if (userinfo.useSchemas()) {
      TreeItem tiSch=new TreeItem(tiObj,SWT.NONE);
      tiSch.setText(STRING_SCHEMAS);
      tiSch.setExpanded(true);
    }
    tiObj.setExpanded(true);
    TreeItem tiUser=new TreeItem(tiTree,SWT.NONE);
    tiUser.setText(STRING_USERS);
    String users[]=rep.getUserLogins();
    for (int i=0; i < users.length; i++) {
      if (userinfo.isAdministrator() || userinfo.getLogin().equalsIgnoreCase(users[i])) {
        TreeItem newUser=new TreeItem(tiUser,SWT.NONE);
        newUser.setText(users[i]);
      }
    }
    tiUser.setExpanded(true);
    if (userinfo.isAdministrator()) {
      TreeItem tiProf=new TreeItem(tiTree,SWT.NONE);
      tiProf.setText(STRING_PROFILES);
      String prof[]=rep.getProfiles();
      for (int i=0; i < prof.length; i++) {
        TreeItem newProf=new TreeItem(tiProf,SWT.NONE);
        newProf.setText(prof[i]);
      }
      tiProf.setExpanded(true);
    }
    tiTree.setExpanded(true);
  }
 catch (  KettleException dbe) {
    new ErrorDialog(shell,props,"Error","An error occurred refreshing the repository tree: ",dbe);
  }
}
