{
  try {
    wTree.removeAll();
    rep.setDirectoryTree(new RepositoryDirectory(rep));
    TreeItem tiTree=new TreeItem(wTree,SWT.NONE);
    tiTree.setText(rep.getName() == null ? "-" : rep.getName());
    TreeItem tiParent=new TreeItem(tiTree,SWT.NONE);
    tiParent.setText(STRING_DATABASES);
    String names[]=rep.getDatabaseNames();
    for (int i=0; i < names.length; i++) {
      TreeItem newDB=new TreeItem(tiParent,SWT.NONE);
      newDB.setText(Const.NVL(names[i],""));
    }
    tiParent=new TreeItem(tiTree,SWT.NONE);
    tiParent.setText(STRING_PARTITIONS);
    names=rep.getPartitionSchemaNames();
    for (int i=0; i < names.length; i++) {
      TreeItem newItem=new TreeItem(tiParent,SWT.NONE);
      newItem.setText(Const.NVL(names[i],""));
    }
    tiParent=new TreeItem(tiTree,SWT.NONE);
    tiParent.setText(STRING_SLAVES);
    names=rep.getSlaveNames();
    for (int i=0; i < names.length; i++) {
      TreeItem newItem=new TreeItem(tiParent,SWT.NONE);
      newItem.setText(Const.NVL(names[i],""));
    }
    tiParent=new TreeItem(tiTree,SWT.NONE);
    tiParent.setText(STRING_CLUSTERS);
    names=rep.getClusterNames();
    for (int i=0; i < names.length; i++) {
      TreeItem newItem=new TreeItem(tiParent,SWT.NONE);
      newItem.setText(Const.NVL(names[i],""));
    }
    if (userinfo.useTransformations()) {
      TreeItem tiCat=new TreeItem(tiTree,SWT.NONE);
      tiCat.setText(STRING_TRANSFORMATIONS);
      TreeItem newCat=new TreeItem(tiCat,SWT.NONE);
      rep.getDirectoryTree().getTreeWithNames(newCat,rep,dircolor,sortColumn,ascending);
    }
    if (userinfo.useJobs()) {
      TreeItem tiJob=new TreeItem(tiTree,SWT.NONE);
      tiJob.setText(STRING_JOBS);
      TreeItem newJob=new TreeItem(tiJob,SWT.NONE);
      rep.getDirectoryTree().getTreeWithNames(newJob,rep,dircolor,sortColumn,ascending);
    }
    TreeItem tiUser=new TreeItem(tiTree,SWT.NONE);
    tiUser.setText(STRING_USERS);
    String users[]=rep.getUserLogins();
    for (int i=0; i < users.length; i++) {
      if (userinfo.isAdministrator() || userinfo.getLogin().equalsIgnoreCase(users[i])) {
        if (users[i] != null) {
          TreeItem newUser=new TreeItem(tiUser,SWT.NONE);
          newUser.setText(users[i]);
        }
      }
    }
    if (userinfo.isAdministrator()) {
      TreeItem tiProf=new TreeItem(tiTree,SWT.NONE);
      tiProf.setText(STRING_PROFILES);
      String prof[]=rep.getProfiles();
      for (int i=0; i < prof.length; i++) {
        TreeItem newProf=new TreeItem(tiProf,SWT.NONE);
        newProf.setText(prof[i]);
      }
    }
    TreeMemory.setExpandedFromMemory(wTree,STRING_REPOSITORY_EXPLORER_TREE_NAME);
    tiTree.setExpanded(true);
  }
 catch (  KettleException dbe) {
    new ErrorDialog(shell,Messages.getString("RepositoryExplorerDialog.PopupMenu.Dialog.ErrorRefreshingTree.Title"),Messages.getString("RepositoryExplorerDialog.PopupMenu.Dialog.ErrorRefreshingTree.Message"),dbe);
  }
}
