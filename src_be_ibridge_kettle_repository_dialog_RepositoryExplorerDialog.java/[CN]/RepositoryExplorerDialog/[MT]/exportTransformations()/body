{
  try {
    DirectoryDialog dialog=new DirectoryDialog(shell,SWT.OPEN);
    if (dialog.open() != null) {
      String directory=dialog.getFilterPath();
      long dirids[]=rep.getDirectoryTree().getDirectoryIDs();
      for (int d=0; d < dirids.length; d++) {
        RepositoryDirectory repdir=rep.getDirectoryTree().findDirectory(dirids[d]);
        String trans[]=rep.getTransformationNames(dirids[d]);
        for (int i=0; i < trans.length; i++) {
          TransMeta ti=new TransMeta(rep,trans[i],repdir);
          System.out.println("Loading/Exporting transformation [" + trans[i] + "] in directory ["+ repdir.getPath()+ "]");
          String xml=XMLHandler.getXMLHeader() + ti.getXML();
          File dir=new File(directory + repdir.getPath());
          if (!dir.exists()) {
            dir.mkdir();
            System.out.println("Created directory [" + dir.getName() + "]");
          }
          String filename=directory + repdir.getPath() + Const.FILE_SEPARATOR+ trans[i]+ ".ktr";
          File f=new File(filename);
          try {
            FileOutputStream fos=new FileOutputStream(f);
            fos.write(xml.getBytes(Const.XML_ENCODING));
            fos.close();
          }
 catch (          IOException e) {
            System.out.println("Couldn't create file [" + filename + "]");
          }
        }
      }
    }
  }
 catch (  KettleException e) {
    new ErrorDialog(shell,Messages.getString("RepositoryExplorerDialog.Dialog.ExportTrans.UnexpectedError.Title"),Messages.getString("RepositoryExplorerDialog.Dialog.ExportTrans.UnexpectedError.Message"),e);
  }
}
