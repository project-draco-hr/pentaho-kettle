{
  meta=(AppendMeta)smi;
  data=(AppendData)sdi;
  Object[] input=null;
  if (data.processHead) {
    input=getRowFrom(data.headRowSet);
    if (input == null) {
      data.processHead=false;
      data.processTail=true;
    }
 else {
      if (data.outputRowMeta == null) {
        data.outputRowMeta=data.headRowSet.getRowMeta();
      }
    }
  }
  if (data.processTail) {
    input=getRowFrom(data.tailRowSet);
    if (input == null) {
      setOutputDone();
      return false;
    }
    if (data.outputRowMeta == null) {
      data.outputRowMeta=data.headRowSet.getRowMeta();
    }
  }
  if (input != null) {
    putRow(data.outputRowMeta,input);
  }
  if (checkFeedback(linesRead))   logBasic(Messages.getString("AppendRows.LineNumber") + linesRead);
  return true;
}
