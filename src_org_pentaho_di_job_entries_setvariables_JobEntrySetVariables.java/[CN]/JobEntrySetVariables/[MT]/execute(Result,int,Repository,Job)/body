{
  LogWriter log=LogWriter.getInstance();
  result.setResult(false);
  result.setNrErrors(1);
  try {
    if (variableName != null) {
      for (int i=0; i < variableName.length && !parentJob.isStopped(); i++) {
        String varname=variableName[i];
        String value=variableValue[i];
        if (replaceVars) {
          varname=environmentSubstitute(varname);
          value=environmentSubstitute(value);
        }
switch (getVariableType()[i]) {
case VARIABLE_TYPE_JVM:
{
            System.setProperty(varname,value);
            setVariable(varname,value);
            Job parentjob=parentJob;
            while (parentjob != null) {
              parentjob.setVariable(varname,value);
              parentjob=parentJob.getParentJob();
            }
          }
        break;
case VARIABLE_TYPE_ROOT_JOB:
{
        setVariable(varname,value);
        Job rootJob=parentJob;
        while (rootJob != null) {
          rootJob.setVariable(varname,value);
          rootJob=rootJob.getParentJob();
        }
      }
    break;
case VARIABLE_TYPE_CURRENT_JOB:
{
    setVariable(varname,value);
    if (parentJob != null)     parentJob.setVariable(varname,value);
 else     throw new KettleJobException(BaseMessages.getString(PKG,"JobEntrySetVariables.Error.UnableSetVariableCurrentJob",varname));
  }
break;
case VARIABLE_TYPE_PARENT_JOB:
{
setVariable(varname,value);
if (parentJob != null) {
  parentJob.setVariable(varname,value);
  Job gpJob=parentJob.getParentJob();
  if (gpJob != null)   gpJob.setVariable(varname,value);
 else   throw new KettleJobException(BaseMessages.getString(PKG,"JobEntrySetVariables.Error.UnableSetVariableParentJob",varname));
}
 else {
  throw new KettleJobException(BaseMessages.getString(PKG,"JobEntrySetVariables.Error.UnableSetVariableCurrentJob",varname));
}
}
break;
}
result.setResult(true);
result.setNrErrors(0);
if (log.isDetailed()) log.logDetailed(toString(),BaseMessages.getString(PKG,"JobEntrySetVariables.Log.SetVariableToValue",varname,value));
}
}
}
 catch (Exception e) {
log.logError(toString(),BaseMessages.getString(PKG,"JobEntrySetVariables.UnExcpectedError",e.getMessage()));
}
return result;
}
