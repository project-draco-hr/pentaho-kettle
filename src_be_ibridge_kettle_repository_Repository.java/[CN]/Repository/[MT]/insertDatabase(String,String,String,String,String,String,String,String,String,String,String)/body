{
  long id=getNextDatabaseID();
  long id_database_type=getDatabaseTypeID(type);
  if (id_database_type < 0) {
    id_database_type=getNextDatabaseTypeID();
    String tablename="R_DATABASE_TYPE";
    Row table=new Row();
    table.addValue(new Value("ID_DATABASE_TYPE",Value.VALUE_TYPE_INTEGER,5,0));
    table.addValue(new Value("CODE",Value.VALUE_TYPE_STRING,REP_STRING_CODE_LENGTH,0));
    table.addValue(new Value("DESCRIPTION",Value.VALUE_TYPE_STRING,REP_STRING_LENGTH,0));
    database.prepareInsert(table,tablename);
    table=new Row();
    table.addValue(new Value("ID_DATABASE_TYPE",id_database_type));
    table.addValue(new Value("CODE",type));
    table.addValue(new Value("DESCRIPTION",type));
    database.setValuesInsert(table);
    database.insertRow();
    database.closeInsert();
  }
  long id_database_contype=getDatabaseConTypeID(access);
  Row table=new Row();
  table.addValue(new Value("ID_DATABASE",id));
  table.addValue(new Value("NAME",name));
  table.addValue(new Value("ID_DATABASE_TYPE",id_database_type));
  table.addValue(new Value("ID_DATABASE_CONTYPE",id_database_contype));
  table.addValue(new Value("HOST_NAME",host));
  table.addValue(new Value("DATABASE_NAME",dbname));
  table.addValue(new Value("PORT",(long)Const.toInt(port,-1)));
  table.addValue(new Value("USERNAME",user));
  table.addValue(new Value("PASSWORD",Encr.encryptPasswordIfNotUsingVariables(pass)));
  table.addValue(new Value("SERVERNAME",servername));
  table.addValue(new Value("DATA_TBS",data_tablespace));
  table.addValue(new Value("INDEX_TBS",index_tablespace));
  database.prepareInsert(table,"R_DATABASE");
  database.setValuesInsert(table);
  database.insertRow();
  database.closeInsert();
  return id;
}
