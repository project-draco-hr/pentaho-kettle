{
  String[] transList=getTransformationsUsingPartitionSchema(id_partition_schema);
  if (transList.length == 0) {
    database.execStatement("DELETE FROM R_PARTITION WHERE ID_PARTITION_SCHEMA = " + id_partition_schema);
    database.execStatement("DELETE FROM R_PARTITION_SCHEMA WHERE ID_PARTITION_SCHEMA = " + id_partition_schema);
  }
 else {
    StringBuffer message=new StringBuffer();
    message.append("The partition schema is used by the following transformations:").append(Const.CR);
    for (int i=0; i < transList.length; i++) {
      message.append("  ").append(transList[i]).append(Const.CR);
    }
    message.append(Const.CR);
    KettleDependencyException e=new KettleDependencyException(message.toString());
    throw new KettleDependencyException("This partition schema is still in use by one or more transformations (" + transList.length + ") :",e);
  }
}
