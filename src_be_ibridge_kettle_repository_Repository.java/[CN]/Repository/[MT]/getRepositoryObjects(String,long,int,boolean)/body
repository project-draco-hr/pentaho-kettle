{
  String nameField=databaseMeta.quoteField("NAME");
  String sortField=nameField;
switch (sortPosition) {
case 2:
    sortField="MODIFIED_USER";
  break;
case 3:
sortField="MODIFIED_DATE";
break;
}
String sql="SELECT " + nameField + ", MODIFIED_USER, MODIFIED_DATE "+ "FROM "+ tableName+ " "+ "WHERE ID_DIRECTORY = "+ id_directory+ " "+ "ORDER BY "+ sortField+ " "+ (ascending ? "ASC" : "DESC");
List repositoryObjects=new ArrayList();
ResultSet rs=database.openQuery(sql);
if (rs != null) {
Row r=database.getRow(rs);
while (r != null) {
repositoryObjects.add(new RepositoryObject(r.getValue(0).getString(),r.getValue(1).getString(),r.getValue(2).getDate()));
r=database.getRow(rs);
}
database.closeQuery(rs);
}
return repositoryObjects;
}
