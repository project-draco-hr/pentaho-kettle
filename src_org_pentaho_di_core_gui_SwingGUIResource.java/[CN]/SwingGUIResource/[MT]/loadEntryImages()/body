{
  Map<String,BufferedImage> map=new HashMap<String,BufferedImage>();
  for (  PluginInterface plugin : PluginRegistry.getInstance().getPlugins(JobEntryPluginType.class)) {
    if ("SPECIAL".equals(plugin.getIds()[0])) {
      continue;
    }
    String imageFile=plugin.getImageFile();
    if (imageFile == null) {
      throw new KettleException("No image file (icon) specified for plugin: " + plugin);
    }
    BufferedImage image=getImageIcon(imageFile);
    if (image == null) {
      throw new KettleException("Unable to find image file: " + plugin.getImageFile() + " for plugin: "+ plugin);
    }
    if (image.getHeight(null) < 0) {
      image=getImageIcon(plugin);
      if (image == null || image.getHeight(null) < 0) {
        throw new KettleException("Unable to load image file: " + plugin.getImageFile() + " for plugin: "+ plugin);
      }
    }
    map.put(plugin.getIds()[0],image);
  }
  return map;
}
