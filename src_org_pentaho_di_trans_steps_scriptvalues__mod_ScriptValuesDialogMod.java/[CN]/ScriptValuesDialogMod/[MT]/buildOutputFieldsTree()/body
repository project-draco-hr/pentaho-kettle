{
  try {
    RowMetaInterface r=transMeta.getPrevStepFields(stepname);
    if (r != null) {
      TreeItem item=new TreeItem(wTree,SWT.NULL);
      item.setText("Output Fields");
      String strItemToAdd="";
      for (int i=0; i < r.size(); i++) {
        ValueMetaInterface v=r.getValueMeta(i);
switch (v.getType()) {
case ValueMetaInterface.TYPE_STRING:
case ValueMetaInterface.TYPE_NUMBER:
case ValueMetaInterface.TYPE_INTEGER:
case ValueMetaInterface.TYPE_DATE:
case ValueMetaInterface.TYPE_BOOLEAN:
          strItemToAdd=v.getName() + ".setValue(var)";
        break;
default :
      strItemToAdd=v.getName();
    break;
}
TreeItem itemInputFields=new TreeItem(item,SWT.NULL);
itemInputFields.setText(strItemToAdd);
itemInputFields.setData(strItemToAdd);
}
}
}
 catch (KettleException ke) {
new ErrorDialog(shell,Messages.getString("ScriptValuesDialogMod.FailedToGetFields.DialogTitle"),Messages.getString("ScriptValuesDialogMod.FailedToGetFields.DialogMessage"),ke);
}
}
