{
  stepname=wStepname.getText();
  boolean bInputOK=false;
  if (getCTabItemByName(strActiveScript) == null) {
    MessageBox mb=new MessageBox(shell,SWT.OK | SWT.CANCEL | SWT.ICON_ERROR);
    mb.setMessage("No active Script has been set! Should the first tab set as acitve Script?");
    mb.setText("ERROR");
switch (mb.open()) {
case SWT.OK:
      strActiveScript=folder.getItem(0).getText();
    refresh();
  bInputOK=true;
break;
case SWT.CANCEL:
bInputOK=false;
break;
}
}
 else {
bInputOK=true;
}
if (bInputOK) {
int nrfields=wFields.nrNonEmpty();
input.allocate(nrfields);
for (int i=0; i < nrfields; i++) {
TableItem item=wFields.getNonEmpty(i);
input.getName()[i]=item.getText(1);
input.getRename()[i]=item.getText(2);
if (input.getRename()[i] == null || input.getRename()[i].length() == 0 || input.getRename()[i].equalsIgnoreCase(input.getName()[i])) {
input.getRename()[i]=input.getName()[i];
}
input.getType()[i]=ValueMeta.getType(item.getText(3));
String slen=item.getText(4);
String sprc=item.getText(5);
input.getLength()[i]=Const.toInt(slen,-1);
input.getPrecision()[i]=Const.toInt(sprc,-1);
}
CTabItem[] cTabs=folder.getItems();
if (cTabs.length > 0) {
ScriptValuesScript[] jsScripts=new ScriptValuesScript[cTabs.length];
for (int i=0; i < cTabs.length; i++) {
ScriptValuesScript jsScript=new ScriptValuesScript(ScriptValuesScript.NORMAL_SCRIPT,cTabs[i].getText(),getStyledTextComp(cTabs[i]).getText());
if (cTabs[i].getImage().equals(imageActiveScript)) jsScript.setScriptType(ScriptValuesScript.TRANSFORM_SCRIPT);
 else if (cTabs[i].getImage().equals(imageActiveStartScript)) jsScript.setScriptType(ScriptValuesScript.START_SCRIPT);
 else if (cTabs[i].getImage().equals(imageActiveEndScript)) jsScript.setScriptType(ScriptValuesScript.END_SCRIPT);
jsScripts[i]=jsScript;
}
input.setJSScripts(jsScripts);
}
dispose();
}
}
