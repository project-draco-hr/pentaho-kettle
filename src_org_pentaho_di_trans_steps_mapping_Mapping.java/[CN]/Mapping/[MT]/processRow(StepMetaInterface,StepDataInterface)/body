{
  try {
    meta=(MappingMeta)smi;
    data=(MappingData)sdi;
    if (!inputRowSets.isEmpty()) {
      MappingInput[] mappingInputs=data.mappingTrans.findMappingInput();
      for (      RowSet rowSet : new ArrayList<RowSet>(inputRowSets)) {
        if (mappingInputs.length == 1) {
          inputRowSets.remove(rowSet);
          mappingInputs[0].getInputRowSets().add(rowSet);
        }
 else {
          throw new KettleException("Unsupported situation detected.  To solve it, insert a dummy step.");
        }
      }
    }
    data.mappingTrans.startThreads();
    data.mappingTrans.waitUntilFinished();
    Result result=data.mappingTrans.getResult();
    setErrors(result.getNrErrors());
    setLinesRead(result.getNrLinesRead());
    setLinesWritten(result.getNrLinesWritten());
    setLinesInput(result.getNrLinesInput());
    setLinesOutput(result.getNrLinesOutput());
    setLinesUpdated(result.getNrLinesUpdated());
    setLinesRejected(result.getNrLinesRejected());
    return false;
  }
 catch (  Throwable t) {
    if (data.mappingTrans != null)     data.mappingTrans.stopAll();
    throw new KettleException(t);
  }
}
