{
  try {
    HttpClient client=null;
    DataInputStream dataInputStream=null;
    try {
      client=new HttpClient();
      Credentials creds=new UsernamePasswordCredentials(connection.getUsername(),connection.getPassword());
      client.getState().setCredentials(AuthScope.ANY,creds);
      GetMethod method=new GetMethod(url + "/");
      method.setDoAuthentication(true);
      method.addRequestHeader(new Header("Content-Type","text/xml"));
      int result=client.executeMethod(method);
      if (result == 500) {
        String response=getStreamString(method.getResponseBodyAsStream());
        throw new KettleException("Error 500 reading data from slave server: " + response);
      }
      if (result == 401) {
        String response=getStreamString(method.getResponseBodyAsStream());
        throw new KettleException("Access denied error 401 received while attempting to read data from server: " + response);
      }
      if (result != 200) {
        String response=getStreamString(method.getResponseBodyAsStream());
        throw new KettleException("Error received while attempting to read data from server: " + response);
      }
      return getStreamString(method.getResponseBodyAsStream());
    }
  finally {
      if (dataInputStream != null) {
        dataInputStream.close();
      }
    }
  }
 catch (  Exception e) {
    throw new KettleException("Unable to get open query for URL: " + url,e);
  }
}
