{
  spoon.getLog().logDebug(toString(),Messages.getString("Spoon.Log.DeleteStep") + stepMeta.getName());
  for (int i=transMeta.nrTransHops() - 1; i >= 0; i--) {
    TransHopMeta hi=transMeta.getTransHop(i);
    if (hi.getFromStep().equals(stepMeta) || hi.getToStep().equals(stepMeta)) {
      spoon.addUndoDelete(transMeta,new TransHopMeta[]{hi},new int[]{transMeta.indexOfTransHop(hi)},true);
      transMeta.removeTransHop(i);
      spoon.refreshTree();
    }
  }
  int pos=transMeta.indexOfStep(stepMeta);
  transMeta.removeStep(pos);
  spoon.addUndoDelete(transMeta,new StepMeta[]{stepMeta},new int[]{pos});
  spoon.refreshTree();
  spoon.refreshGraph();
}
