{
  Shell parent=getParent();
  Display display=parent.getDisplay();
  shell=new Shell(parent,SWT.DIALOG_TRIM | SWT.RESIZE | SWT.MAX| SWT.MIN);
  props.setLook(shell);
  setShellImage(shell,input);
  ModifyListener lsMod=new ModifyListener(){
    public void modifyText(    ModifyEvent e){
      input.setChanged();
    }
  }
;
  changed=input.hasChanged();
  FormLayout formLayout=new FormLayout();
  formLayout.marginWidth=Const.FORM_MARGIN;
  formLayout.marginHeight=Const.FORM_MARGIN;
  shell.setLayout(formLayout);
  shell.setText(BaseMessages.getString(PKG,"LDAPOutputDialog.DialogTitle"));
  int middle=props.getMiddlePct();
  int margin=Const.MARGIN;
  wlStepname=new Label(shell,SWT.RIGHT);
  wlStepname.setText(BaseMessages.getString(PKG,"System.Label.StepName"));
  props.setLook(wlStepname);
  fdlStepname=new FormData();
  fdlStepname.left=new FormAttachment(0,0);
  fdlStepname.top=new FormAttachment(0,margin);
  fdlStepname.right=new FormAttachment(middle,-margin);
  wlStepname.setLayoutData(fdlStepname);
  wStepname=new Text(shell,SWT.SINGLE | SWT.LEFT | SWT.BORDER);
  wStepname.setText(stepname);
  props.setLook(wStepname);
  wStepname.addModifyListener(lsMod);
  fdStepname=new FormData();
  fdStepname.left=new FormAttachment(middle,0);
  fdStepname.top=new FormAttachment(0,margin);
  fdStepname.right=new FormAttachment(100,0);
  wStepname.setLayoutData(fdStepname);
  wTabFolder=new CTabFolder(shell,SWT.BORDER);
  props.setLook(wTabFolder,Props.WIDGET_STYLE_TAB);
  wGeneralTab=new CTabItem(wTabFolder,SWT.NONE);
  wGeneralTab.setText(BaseMessages.getString(PKG,"LDAPOutputDialog.General.Tab"));
  wGeneralComp=new Composite(wTabFolder,SWT.NONE);
  props.setLook(wGeneralComp);
  FormLayout fileLayout=new FormLayout();
  fileLayout.marginWidth=3;
  fileLayout.marginHeight=3;
  wGeneralComp.setLayout(fileLayout);
  wConnectionGroup=new Group(wGeneralComp,SWT.SHADOW_NONE);
  props.setLook(wConnectionGroup);
  wConnectionGroup.setText(BaseMessages.getString(PKG,"LDAPOutputDialog.Group.ConnectionGroup.Label"));
  FormLayout connectiongroupLayout=new FormLayout();
  connectiongroupLayout.marginWidth=10;
  connectiongroupLayout.marginHeight=10;
  wConnectionGroup.setLayout(connectiongroupLayout);
  wlHost=new Label(wConnectionGroup,SWT.RIGHT);
  wlHost.setText(BaseMessages.getString(PKG,"LDAPOutputDialog.Host.Label"));
  props.setLook(wlHost);
  fdlHost=new FormData();
  fdlHost.left=new FormAttachment(0,0);
  fdlHost.top=new FormAttachment(wStepname,margin);
  fdlHost.right=new FormAttachment(middle,-margin);
  wlHost.setLayoutData(fdlHost);
  wHost=new TextVar(transMeta,wConnectionGroup,SWT.SINGLE | SWT.LEFT | SWT.BORDER);
  wHost.setToolTipText(BaseMessages.getString(PKG,"LDAPOutputDialog.Host.Tooltip"));
  props.setLook(wHost);
  wHost.addModifyListener(lsMod);
  fdHost=new FormData();
  fdHost.left=new FormAttachment(middle,0);
  fdHost.top=new FormAttachment(wStepname,margin);
  fdHost.right=new FormAttachment(100,0);
  wHost.setLayoutData(fdHost);
  wlPort=new Label(wConnectionGroup,SWT.RIGHT);
  wlPort.setText(BaseMessages.getString(PKG,"LDAPOutputDialog.Port.Label"));
  props.setLook(wlPort);
  fdlPort=new FormData();
  fdlPort.left=new FormAttachment(0,0);
  fdlPort.top=new FormAttachment(wHost,margin);
  fdlPort.right=new FormAttachment(middle,-margin);
  wlPort.setLayoutData(fdlPort);
  wPort=new TextVar(transMeta,wConnectionGroup,SWT.SINGLE | SWT.LEFT | SWT.BORDER);
  props.setLook(wPort);
  wPort.setToolTipText(BaseMessages.getString(PKG,"LDAPOutputDialog.Port.Tooltip"));
  wPort.addModifyListener(lsMod);
  fdPort=new FormData();
  fdPort.left=new FormAttachment(middle,0);
  fdPort.top=new FormAttachment(wHost,margin);
  fdPort.right=new FormAttachment(100,0);
  wPort.setLayoutData(fdPort);
  wlusingAuthentication=new Label(wConnectionGroup,SWT.RIGHT);
  wlusingAuthentication.setText(BaseMessages.getString(PKG,"LDAPOutputDialog.usingAuthentication.Label"));
  props.setLook(wlusingAuthentication);
  fdlusingAuthentication=new FormData();
  fdlusingAuthentication.left=new FormAttachment(0,0);
  fdlusingAuthentication.top=new FormAttachment(wPort,margin);
  fdlusingAuthentication.right=new FormAttachment(middle,-margin);
  wlusingAuthentication.setLayoutData(fdlusingAuthentication);
  wusingAuthentication=new Button(wConnectionGroup,SWT.CHECK);
  props.setLook(wusingAuthentication);
  wusingAuthentication.setToolTipText(BaseMessages.getString(PKG,"LDAPOutputDialog.usingAuthentication.Tooltip"));
  FormData fdusingAuthentication=new FormData();
  fdusingAuthentication.left=new FormAttachment(middle,0);
  fdusingAuthentication.top=new FormAttachment(wPort,margin);
  wusingAuthentication.setLayoutData(fdusingAuthentication);
  wusingAuthentication.addSelectionListener(new SelectionAdapter(){
    public void widgetSelected(    SelectionEvent e){
      useAuthentication();
    }
  }
);
  wlUserName=new Label(wConnectionGroup,SWT.RIGHT);
  wlUserName.setText(BaseMessages.getString(PKG,"LDAPOutputDialog.Username.Label"));
  props.setLook(wlUserName);
  fdlUserName=new FormData();
  fdlUserName.left=new FormAttachment(0,0);
  fdlUserName.top=new FormAttachment(wusingAuthentication,margin);
  fdlUserName.right=new FormAttachment(middle,-margin);
  wlUserName.setLayoutData(fdlUserName);
  wUserName=new TextVar(transMeta,wConnectionGroup,SWT.SINGLE | SWT.LEFT | SWT.BORDER);
  props.setLook(wUserName);
  wUserName.setToolTipText(BaseMessages.getString(PKG,"LDAPOutputDialog.Username.Tooltip"));
  wUserName.addModifyListener(lsMod);
  fdUserName=new FormData();
  fdUserName.left=new FormAttachment(middle,0);
  fdUserName.top=new FormAttachment(wusingAuthentication,margin);
  fdUserName.right=new FormAttachment(100,0);
  wUserName.setLayoutData(fdUserName);
  wlPassword=new Label(wConnectionGroup,SWT.RIGHT);
  wlPassword.setText(BaseMessages.getString(PKG,"LDAPOutputDialog.Password.Label"));
  props.setLook(wlPassword);
  fdlPassword=new FormData();
  fdlPassword.left=new FormAttachment(0,0);
  fdlPassword.top=new FormAttachment(wUserName,margin);
  fdlPassword.right=new FormAttachment(middle,-margin);
  wlPassword.setLayoutData(fdlPassword);
  wPassword=new TextVar(transMeta,wConnectionGroup,SWT.SINGLE | SWT.LEFT | SWT.BORDER);
  wPassword.setToolTipText(BaseMessages.getString(PKG,"LDAPOutputDialog.Password.Tooltip"));
  props.setLook(wPassword);
  wPassword.setEchoChar('*');
  wPassword.addModifyListener(lsMod);
  fdPassword=new FormData();
  fdPassword.left=new FormAttachment(middle,0);
  fdPassword.top=new FormAttachment(wUserName,margin);
  fdPassword.right=new FormAttachment(100,0);
  wPassword.setLayoutData(fdPassword);
  wlReferral=new Label(wConnectionGroup,SWT.RIGHT);
  wlReferral.setText(BaseMessages.getString(PKG,"LDAPOutputDialog.Referral.Label"));
  props.setLook(wlReferral);
  fdlReferral=new FormData();
  fdlReferral.left=new FormAttachment(0,0);
  fdlReferral.right=new FormAttachment(middle,-margin);
  fdlReferral.top=new FormAttachment(wPassword,margin);
  wlReferral.setLayoutData(fdlReferral);
  wReferral=new CCombo(wConnectionGroup,SWT.BORDER | SWT.READ_ONLY);
  props.setLook(wReferral);
  wReferral.addModifyListener(lsMod);
  fdReferral=new FormData();
  fdReferral.left=new FormAttachment(middle,0);
  fdReferral.top=new FormAttachment(wPassword,margin);
  fdReferral.right=new FormAttachment(100,-margin);
  wReferral.setLayoutData(fdReferral);
  wReferral.setItems(LDAPOutputMeta.referralTypeDesc);
  wReferral.addSelectionListener(new SelectionAdapter(){
    public void widgetSelected(    SelectionEvent e){
      input.setChanged();
    }
  }
);
  wlDerefAliases=new Label(wConnectionGroup,SWT.RIGHT);
  wlDerefAliases.setText(BaseMessages.getString(PKG,"LDAPOutputDialog.DerefAliases.Label"));
  props.setLook(wlDerefAliases);
  fdlDerefAliases=new FormData();
  fdlDerefAliases.left=new FormAttachment(0,0);
  fdlDerefAliases.right=new FormAttachment(middle,-margin);
  fdlDerefAliases.top=new FormAttachment(wReferral,margin);
  wlDerefAliases.setLayoutData(fdlDerefAliases);
  wDerefAliases=new CCombo(wConnectionGroup,SWT.BORDER | SWT.READ_ONLY);
  props.setLook(wDerefAliases);
  wDerefAliases.addModifyListener(lsMod);
  fdDerefAliases=new FormData();
  fdDerefAliases.left=new FormAttachment(middle,0);
  fdDerefAliases.top=new FormAttachment(wReferral,margin);
  fdDerefAliases.right=new FormAttachment(100,-margin);
  wDerefAliases.setLayoutData(fdDerefAliases);
  wDerefAliases.setItems(LDAPOutputMeta.derefAliasesTypeDesc);
  wDerefAliases.addSelectionListener(new SelectionAdapter(){
    public void widgetSelected(    SelectionEvent e){
      input.setChanged();
    }
  }
);
  wTest=new Button(wConnectionGroup,SWT.PUSH);
  wTest.setText(BaseMessages.getString(PKG,"LDAPOutputDialog.TestConnection.Label"));
  props.setLook(wTest);
  fdTest=new FormData();
  wTest.setToolTipText(BaseMessages.getString(PKG,"LDAPOutputDialog.TestConnection.Tooltip"));
  fdTest.top=new FormAttachment(wDerefAliases,margin);
  fdTest.right=new FormAttachment(100,0);
  wTest.setLayoutData(fdTest);
  fdConnectionGroup=new FormData();
  fdConnectionGroup.left=new FormAttachment(0,margin);
  fdConnectionGroup.top=new FormAttachment(0,margin);
  fdConnectionGroup.right=new FormAttachment(100,-margin);
  wConnectionGroup.setLayoutData(fdConnectionGroup);
  wSettings=new Group(wGeneralComp,SWT.SHADOW_NONE);
  props.setLook(wSettings);
  wSettings.setText(BaseMessages.getString(PKG,"LDAPOutputDialog.Group.Settings.Label"));
  FormLayout SettingsLayout=new FormLayout();
  SettingsLayout.marginWidth=10;
  SettingsLayout.marginHeight=10;
  wSettings.setLayout(SettingsLayout);
  wlOperation=new Label(wSettings,SWT.RIGHT);
  wlOperation.setText(BaseMessages.getString(PKG,"LDAPOutputDialog.Operation.Label"));
  props.setLook(wlOperation);
  fdlOperation=new FormData();
  fdlOperation.left=new FormAttachment(0,0);
  fdlOperation.right=new FormAttachment(middle,-margin);
  fdlOperation.top=new FormAttachment(wConnectionGroup,margin);
  wlOperation.setLayoutData(fdlOperation);
  wOperation=new CCombo(wSettings,SWT.BORDER | SWT.READ_ONLY);
  props.setLook(wOperation);
  wOperation.addModifyListener(lsMod);
  fdOperation=new FormData();
  fdOperation.left=new FormAttachment(middle,0);
  fdOperation.top=new FormAttachment(wConnectionGroup,margin);
  fdOperation.right=new FormAttachment(100,-margin);
  wOperation.setLayoutData(fdOperation);
  wOperation.setItems(LDAPOutputMeta.operationTypeDesc);
  wOperation.addSelectionListener(new SelectionAdapter(){
    public void widgetSelected(    SelectionEvent e){
      updateOperation();
      input.setChanged();
    }
  }
);
  wlMultiValuedSeparator=new Label(wSettings,SWT.RIGHT);
  wlMultiValuedSeparator.setText(BaseMessages.getString(PKG,"LDAPOutputDialog.MultiValuedSeparator.Label"));
  props.setLook(wlMultiValuedSeparator);
  fdlMultiValuedSeparator=new FormData();
  fdlMultiValuedSeparator.left=new FormAttachment(0,0);
  fdlMultiValuedSeparator.top=new FormAttachment(wOperation,margin);
  fdlMultiValuedSeparator.right=new FormAttachment(middle,-margin);
  wlMultiValuedSeparator.setLayoutData(fdlMultiValuedSeparator);
  wMultiValuedSeparator=new TextVar(transMeta,wSettings,SWT.SINGLE | SWT.LEFT | SWT.BORDER);
  props.setLook(wMultiValuedSeparator);
  wMultiValuedSeparator.setToolTipText(BaseMessages.getString(PKG,"LDAPOutputDialog.MultiValuedSeparator.Tooltip"));
  wMultiValuedSeparator.addModifyListener(lsMod);
  fdMultiValuedSeparator=new FormData();
  fdMultiValuedSeparator.left=new FormAttachment(middle,0);
  fdMultiValuedSeparator.top=new FormAttachment(wOperation,margin);
  fdMultiValuedSeparator.right=new FormAttachment(100,0);
  wMultiValuedSeparator.setLayoutData(fdMultiValuedSeparator);
  wlFailIfNotExist=new Label(wSettings,SWT.RIGHT);
  wlFailIfNotExist.setText(BaseMessages.getString(PKG,"LDAPOutputDialog.FailIfNotExist.Label"));
  props.setLook(wlFailIfNotExist);
  fdlFailIfNotExist=new FormData();
  fdlFailIfNotExist.left=new FormAttachment(0,0);
  fdlFailIfNotExist.top=new FormAttachment(wMultiValuedSeparator,margin);
  fdlFailIfNotExist.right=new FormAttachment(middle,-margin);
  wlFailIfNotExist.setLayoutData(fdlFailIfNotExist);
  wFailIfNotExist=new Button(wSettings,SWT.CHECK);
  wFailIfNotExist.setToolTipText(BaseMessages.getString(PKG,"LDAPOutputDialog.FailIfNotExist.Tooltip"));
  props.setLook(wFailIfNotExist);
  fdFailIfNotExist=new FormData();
  fdFailIfNotExist.left=new FormAttachment(middle,0);
  fdFailIfNotExist.top=new FormAttachment(wMultiValuedSeparator,margin);
  fdFailIfNotExist.right=new FormAttachment(100,0);
  wFailIfNotExist.setLayoutData(fdFailIfNotExist);
  SelectionAdapter lsSelR=new SelectionAdapter(){
    public void widgetSelected(    SelectionEvent arg0){
      input.setChanged();
    }
  }
;
  wFailIfNotExist.addSelectionListener(lsSelR);
  wlDeleteField=new Label(wSettings,SWT.RIGHT);
  wlDeleteField.setText(BaseMessages.getString(PKG,"LDAPOutputDialog.DnField.Label"));
  props.setLook(wlDeleteField);
  fdlDeleteField=new FormData();
  fdlDeleteField.left=new FormAttachment(0,0);
  fdlDeleteField.top=new FormAttachment(wFailIfNotExist,margin);
  fdlDeleteField.right=new FormAttachment(middle,-margin);
  wlDeleteField.setLayoutData(fdlDeleteField);
  wDeleteField=new ComboVar(transMeta,wSettings,SWT.SINGLE | SWT.READ_ONLY | SWT.BORDER);
  wDeleteField.setEditable(true);
  props.setLook(wDeleteField);
  wDeleteField.addModifyListener(lsMod);
  fdDeleteField=new FormData();
  fdDeleteField.left=new FormAttachment(middle,0);
  fdDeleteField.top=new FormAttachment(wFailIfNotExist,margin);
  fdDeleteField.right=new FormAttachment(100,-margin);
  wDeleteField.setLayoutData(fdDeleteField);
  wDeleteField.addFocusListener(new FocusListener(){
    public void focusLost(    org.eclipse.swt.events.FocusEvent e){
    }
    public void focusGained(    org.eclipse.swt.events.FocusEvent e){
      getPreviousFields();
    }
  }
);
  fdSettings=new FormData();
  fdSettings.left=new FormAttachment(0,margin);
  fdSettings.top=new FormAttachment(wConnectionGroup,margin);
  fdSettings.right=new FormAttachment(100,-margin);
  wSettings.setLayoutData(fdSettings);
  fdGeneralComp=new FormData();
  fdGeneralComp.left=new FormAttachment(0,0);
  fdGeneralComp.top=new FormAttachment(0,0);
  fdGeneralComp.right=new FormAttachment(100,0);
  fdGeneralComp.bottom=new FormAttachment(100,0);
  wGeneralComp.setLayoutData(fdGeneralComp);
  wGeneralComp.layout();
  wGeneralTab.setControl(wGeneralComp);
  wFieldsTab=new CTabItem(wTabFolder,SWT.NONE);
  wFieldsTab.setText(BaseMessages.getString(PKG,"LDAPOutputDialog.Fields.Tab"));
  wFieldsComp=new Composite(wTabFolder,SWT.NONE);
  props.setLook(wFieldsComp);
  FormLayout fieldsLayout=new FormLayout();
  fieldsLayout.marginWidth=3;
  fieldsLayout.marginHeight=3;
  wFieldsComp.setLayout(fieldsLayout);
  wFields=new Group(wFieldsComp,SWT.SHADOW_NONE);
  props.setLook(wFields);
  wFields.setText(BaseMessages.getString(PKG,"LDAPOutputDialog.Group.Fields.Label"));
  FormLayout FieldsLayout=new FormLayout();
  FieldsLayout.marginWidth=10;
  FieldsLayout.marginHeight=10;
  wFields.setLayout(FieldsLayout);
  wlBaseDN=new Label(wFields,SWT.RIGHT);
  wlBaseDN.setText(BaseMessages.getString(PKG,"LDAPOutputDialog.BaseDN.Label"));
  props.setLook(wlBaseDN);
  fdlBaseDN=new FormData();
  fdlBaseDN.left=new FormAttachment(0,0);
  fdlBaseDN.top=new FormAttachment(wSettings,margin);
  fdlBaseDN.right=new FormAttachment(middle,-margin);
  wlBaseDN.setLayoutData(fdlBaseDN);
  wBaseDN=new TextVar(transMeta,wFields,SWT.SINGLE | SWT.LEFT | SWT.BORDER);
  wBaseDN.setToolTipText(BaseMessages.getString(PKG,"LDAPOutputDialog.BaseDN.Tooltip"));
  props.setLook(wBaseDN);
  wBaseDN.addModifyListener(lsMod);
  fdBaseDN=new FormData();
  fdBaseDN.left=new FormAttachment(middle,0);
  fdBaseDN.top=new FormAttachment(wSettings,margin);
  fdBaseDN.right=new FormAttachment(100,0);
  wBaseDN.setLayoutData(fdBaseDN);
  wBaseDN.addModifyListener(new ModifyListener(){
    public void modifyText(    ModifyEvent e){
      input.setChanged();
      if (Const.isEmpty(wBaseDN.getText())) {
        wDoMapping.setEnabled(false);
      }
 else {
        setFieldsCombo();
        wDoMapping.setEnabled(true);
      }
    }
  }
);
  wlReturn=new Label(wFields,SWT.NONE);
  wlReturn.setText(BaseMessages.getString(PKG,"LDAPOutputUpdateDialog.UpdateFields.Label"));
  props.setLook(wlReturn);
  fdlReturn=new FormData();
  fdlReturn.left=new FormAttachment(0,0);
  fdlReturn.top=new FormAttachment(wBaseDN,margin);
  wlReturn.setLayoutData(fdlReturn);
  int UpInsCols=3;
  int UpInsRows=(input.getUpdateLookup() != null ? input.getUpdateLookup().length : 1);
  ciReturn=new ColumnInfo[UpInsCols];
  ciReturn[0]=new ColumnInfo(BaseMessages.getString(PKG,"LDAPOutputUpdateDialog.ColumnInfo.TableField"),ColumnInfo.COLUMN_TYPE_CCOMBO,new String[]{""},false);
  ciReturn[1]=new ColumnInfo(BaseMessages.getString(PKG,"LDAPOutputUpdateDialog.ColumnInfo.StreamField"),ColumnInfo.COLUMN_TYPE_CCOMBO,new String[]{""},false);
  ciReturn[2]=new ColumnInfo(BaseMessages.getString(PKG,"LDAPOutputUpdateDialog.ColumnInfo.Update"),ColumnInfo.COLUMN_TYPE_CCOMBO,new String[]{"Y","N"});
  tableFieldColumns.add(ciReturn[0]);
  wReturn=new TableView(transMeta,wFields,SWT.BORDER | SWT.FULL_SELECTION | SWT.MULTI| SWT.V_SCROLL| SWT.H_SCROLL,ciReturn,UpInsRows,lsMod,props);
  wGetLU=new Button(wFields,SWT.PUSH);
  wGetLU.setText(BaseMessages.getString(PKG,"LDAPOutputUpdateDialog.GetAndUpdateFields.Label"));
  fdGetLU=new FormData();
  fdGetLU.top=new FormAttachment(wlReturn,margin);
  fdGetLU.right=new FormAttachment(100,0);
  wGetLU.setLayoutData(fdGetLU);
  wDoMapping=new Button(wFields,SWT.PUSH);
  wDoMapping.setText(BaseMessages.getString(PKG,"LDAPOutputUpdateDialog.EditMapping.Label"));
  fdDoMapping=new FormData();
  fdDoMapping.top=new FormAttachment(wGetLU,margin);
  fdDoMapping.right=new FormAttachment(100,0);
  wDoMapping.setLayoutData(fdDoMapping);
  wDoMapping.addListener(SWT.Selection,new Listener(){
    public void handleEvent(    Event arg0){
      generateMappings();
    }
  }
);
  fdReturn=new FormData();
  fdReturn.left=new FormAttachment(0,0);
  fdReturn.top=new FormAttachment(wlReturn,margin);
  fdReturn.right=new FormAttachment(wGetLU,-5 * margin);
  fdReturn.bottom=new FormAttachment(100,-2 * margin);
  wReturn.setLayoutData(fdReturn);
  final Runnable runnable=new Runnable(){
    public void run(){
      StepMeta stepMeta=transMeta.findStep(stepname);
      if (stepMeta != null) {
        try {
          RowMetaInterface row=transMeta.getPrevStepFields(stepMeta);
          for (int i=0; i < row.size(); i++) {
            inputFields.put(row.getValueMeta(i).getName(),Integer.valueOf(i));
          }
          setComboBoxes();
        }
 catch (        KettleException e) {
          logError(BaseMessages.getString(PKG,"System.Dialog.GetFieldsFailed.Message"));
        }
      }
    }
  }
;
  new Thread(runnable).start();
  fdFields=new FormData();
  fdFields.left=new FormAttachment(0,margin);
  fdFields.top=new FormAttachment(wSettings,margin);
  fdFields.right=new FormAttachment(100,-margin);
  fdFields.bottom=new FormAttachment(100,-margin);
  wFields.setLayoutData(fdFields);
  fdFieldsComp=new FormData();
  fdFieldsComp.left=new FormAttachment(0,0);
  fdFieldsComp.top=new FormAttachment(0,0);
  fdFieldsComp.right=new FormAttachment(100,0);
  fdFieldsComp.bottom=new FormAttachment(100,0);
  wFieldsComp.setLayoutData(fdFieldsComp);
  wFieldsComp.layout();
  wFieldsTab.setControl(wFieldsComp);
  fdTabFolder=new FormData();
  fdTabFolder.left=new FormAttachment(0,0);
  fdTabFolder.top=new FormAttachment(wStepname,margin);
  fdTabFolder.right=new FormAttachment(100,0);
  fdTabFolder.bottom=new FormAttachment(100,-50);
  wTabFolder.setLayoutData(fdTabFolder);
  wOK=new Button(shell,SWT.PUSH);
  wOK.setText(BaseMessages.getString(PKG,"System.Button.OK"));
  wCancel=new Button(shell,SWT.PUSH);
  wCancel.setText(BaseMessages.getString(PKG,"System.Button.Cancel"));
  setButtonPositions(new Button[]{wOK,wCancel},margin,wTabFolder);
  lsOK=new Listener(){
    public void handleEvent(    Event e){
      ok();
    }
  }
;
  lsTest=new Listener(){
    public void handleEvent(    Event e){
      test();
    }
  }
;
  lsPreview=new Listener(){
    public void handleEvent(    Event e){
      preview();
    }
  }
;
  lsCancel=new Listener(){
    public void handleEvent(    Event e){
      cancel();
    }
  }
;
  lsGetLU=new Listener(){
    public void handleEvent(    Event e){
      getUpdate();
    }
  }
;
  wOK.addListener(SWT.Selection,lsOK);
  wTest.addListener(SWT.Selection,lsTest);
  wCancel.addListener(SWT.Selection,lsCancel);
  wGetLU.addListener(SWT.Selection,lsGetLU);
  lsDef=new SelectionAdapter(){
    public void widgetDefaultSelected(    SelectionEvent e){
      ok();
    }
  }
;
  wStepname.addSelectionListener(lsDef);
  shell.addShellListener(new ShellAdapter(){
    public void shellClosed(    ShellEvent e){
      cancel();
    }
  }
);
  wTabFolder.setSelection(0);
  setSize();
  getData(input);
  useAuthentication();
  updateOperation();
  input.setChanged(changed);
  shell.open();
  while (!shell.isDisposed()) {
    if (!display.readAndDispatch())     display.sleep();
  }
  return stepname;
}
