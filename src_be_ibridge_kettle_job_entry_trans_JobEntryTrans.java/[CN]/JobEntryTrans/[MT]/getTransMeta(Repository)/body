{
  LogWriter log=LogWriter.getInstance();
  TransMeta transMeta=null;
  if (!Const.isEmpty(getFilename())) {
    log.logBasic(toString(),"Loading transformation from XML file [" + StringUtil.environmentSubstitute(getFilename()) + "]");
    transMeta=new TransMeta(StringUtil.environmentSubstitute(getFilename()));
  }
 else   if (!Const.isEmpty(getTransname()) && getDirectory() != null) {
    log.logBasic(toString(),"Loading transformation from repository [" + StringUtil.environmentSubstitute(getTransname()) + "] in directory ["+ getDirectory()+ "]");
    transMeta=new TransMeta(rep,StringUtil.environmentSubstitute(getTransname()),getDirectory());
  }
 else {
    throw new KettleJobException("The transformation to execute is not specified!");
  }
  transMeta.setArguments(arguments);
  return transMeta;
}
