{
  meta=(SwitchCaseMeta)smi;
  data=(SwitchCaseData)sdi;
  if (super.init(smi,sdi)) {
    data.outputMap=new Hashtable<Object,RowSet>();
    if (Const.isEmpty(meta.getFieldname())) {
      logError(Messages.getString("SwitchCase.Log.NoFieldSpecifiedToSwitchWith"));
      return false;
    }
    data.valueMeta=new ValueMeta(meta.getFieldname(),meta.getCaseValueType());
    data.valueMeta.setConversionMask(meta.getCaseValueFormat());
    data.valueMeta.setGroupingSymbol(meta.getCaseValueGroup());
    data.valueMeta.setDecimalSymbol(meta.getCaseValueDecimal());
    data.stringValueMeta=data.valueMeta.clone();
    data.stringValueMeta.setType(ValueMetaInterface.TYPE_STRING);
    try {
      boolean ok=true;
      for (int i=0; i < meta.getCaseTargetSteps().length; i++) {
        if (meta.getCaseTargetSteps()[i] == null) {
          logError(Messages.getString("SwitchCase.Log.NoTargetStepSpecifiedForValue",meta.getCaseValues()[i]));
          ok=false;
        }
 else {
          RowSet rowSet=findOutputRowSet(meta.getCaseTargetSteps()[i].getName());
          if (rowSet != null) {
            try {
              Object value=data.valueMeta.convertDataFromString(meta.getCaseValues()[i],data.stringValueMeta,null,null,ValueMeta.TRIM_TYPE_NONE);
              if (data.valueMeta.isNull(value)) {
                data.nullRowSet=rowSet;
              }
 else {
                data.outputMap.put(value,rowSet);
              }
            }
 catch (            Exception e) {
              logError(Messages.getString("SwitchCase.Log.UnableToConvertValue",meta.getCaseValues()[i]),e);
              ok=false;
            }
          }
 else {
            logError(Messages.getString("SwitchCase.Log.UnableToFindTargetRowSetForStep",meta.getCaseTargetSteps()[i].getName()));
            ok=false;
          }
        }
      }
      if (meta.getDefaultTargetStep() != null) {
        data.defaultRowSet=findOutputRowSet(meta.getDefaultTargetStep().getName());
      }
 else {
        data.defaultRowSet=null;
      }
      return ok;
    }
 catch (    Exception e) {
      e.printStackTrace();
      logError(e.getMessage());
      return false;
    }
  }
  return false;
}
