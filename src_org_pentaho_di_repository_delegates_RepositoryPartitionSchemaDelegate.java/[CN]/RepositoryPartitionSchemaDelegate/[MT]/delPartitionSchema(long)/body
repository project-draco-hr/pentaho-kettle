{
  String[] transList=repository.getTransformationsUsingPartitionSchema(id_partition_schema);
  if (transList.length == 0) {
    repository.connectionDelegate.getDatabase().execStatement("DELETE FROM " + quoteTable(Repository.TABLE_R_PARTITION) + " WHERE "+ quote(Repository.FIELD_PARTITION_ID_PARTITION_SCHEMA)+ " = "+ id_partition_schema);
    repository.connectionDelegate.getDatabase().execStatement("DELETE FROM " + quoteTable(Repository.TABLE_R_PARTITION_SCHEMA) + " WHERE "+ quote(Repository.FIELD_PARTITION_SCHEMA_ID_PARTITION_SCHEMA)+ " = "+ id_partition_schema);
  }
 else {
    StringBuffer message=new StringBuffer();
    message.append("The partition schema is used by the following transformations:").append(Const.CR);
    for (int i=0; i < transList.length; i++) {
      message.append("  ").append(transList[i]).append(Const.CR);
    }
    message.append(Const.CR);
    KettleDependencyException e=new KettleDependencyException(message.toString());
    throw new KettleDependencyException("This partition schema is still in use by one or more transformations (" + transList.length + ") :",e);
  }
}
