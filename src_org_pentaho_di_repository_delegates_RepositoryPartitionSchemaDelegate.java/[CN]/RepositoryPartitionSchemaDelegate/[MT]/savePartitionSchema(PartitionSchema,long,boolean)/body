{
  partitionSchema.setId(getPartitionSchemaID(partitionSchema.getName()));
  if (partitionSchema.getId() < 0) {
    partitionSchema.setId(insertPartitionSchema(partitionSchema));
  }
 else {
    updatePartitionSchema(partitionSchema);
    repository.delPartitions(partitionSchema.getId());
  }
  for (int i=0; i < partitionSchema.getPartitionIDs().size(); i++) {
    insertPartition(partitionSchema.getId(),partitionSchema.getPartitionIDs().get(i));
  }
  if (isUsedByTransformation) {
    repository.insertTransformationPartitionSchema(id_transformation,partitionSchema.getId());
  }
}
