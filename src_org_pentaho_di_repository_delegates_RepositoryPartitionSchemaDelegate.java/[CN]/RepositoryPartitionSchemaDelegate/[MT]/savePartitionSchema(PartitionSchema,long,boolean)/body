{
  partitionSchema.setID(getPartitionSchemaID(partitionSchema.getName()));
  if (partitionSchema.getID() < 0) {
    partitionSchema.setID(insertPartitionSchema(partitionSchema));
  }
 else {
    updatePartitionSchema(partitionSchema);
    repository.delPartitions(partitionSchema.getID());
  }
  for (int i=0; i < partitionSchema.getPartitionIDs().size(); i++) {
    insertPartition(partitionSchema.getID(),partitionSchema.getPartitionIDs().get(i));
  }
  if (isUsedByTransformation) {
    repository.insertTransformationPartitionSchema(id_transformation,partitionSchema.getID());
  }
}
