{
  if (data.file != null) {
    data.jsonReader.readFile(data.filename);
  }
 else {
    if (meta.isReadUrl()) {
      data.jsonReader.readUrl(data.stringToParse);
    }
 else {
      data.jsonReader.readString(data.stringToParse);
    }
  }
  data.resultList=new ArrayList<JSONArray>();
  data.nrrecords=-1;
  data.recordnr=0;
  String prevPath="";
  for (int i=0; i < data.nrInputFields; i++) {
    String path=meta.getInputFields()[i].getPath();
    JSONArray ja=data.jsonReader.getPath(path);
    if (data.nrrecords != -1 && data.nrrecords != ja.size()) {
      throw new KettleException(BaseMessages.getString(PKG,"JsonInput.Error.BadStructure",ja.size(),path,prevPath,data.nrrecords));
    }
    data.resultList.add(ja);
    if (data.nrrecords == -1)     data.nrrecords=ja.size();
    prevPath=path;
  }
  if (log.isDetailed()) {
    logDetailed(BaseMessages.getString(PKG,"JsonInput.Log.NrRecords",data.nrrecords));
  }
}
