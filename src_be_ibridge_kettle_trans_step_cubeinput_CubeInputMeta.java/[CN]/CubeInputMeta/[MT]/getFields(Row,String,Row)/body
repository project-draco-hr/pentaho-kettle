{
  Row row;
  if (r == null)   row=new Row();
 else   row=r;
  GZIPInputStream fis=null;
  DataInputStream dis=null;
  try {
    File f=new File(filename);
    fis=new GZIPInputStream(new FileInputStream(f));
    dis=new DataInputStream(fis);
    Row add=getMetaData(dis);
    if (add == null)     return row;
    for (int i=0; i < add.size(); i++) {
      Value v=add.getValue(i);
      v.setOrigin(name);
    }
    row.addRow(add);
  }
 catch (  KettleFileException kfe) {
    throw new KettleStepException("Unable to read metadata from cube file",kfe);
  }
catch (  IOException e) {
    throw new KettleStepException("Error opening/reading cube file",e);
  }
 finally {
    try {
      if (fis != null)       fis.close();
      if (dis != null)       dis.close();
    }
 catch (    IOException ioe) {
      throw new KettleStepException("Unable to close cube file",ioe);
    }
  }
  return row;
}
