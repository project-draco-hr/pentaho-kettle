{
  IRunnableWithProgress op=new IRunnableWithProgress(){
    public void run(    IProgressMonitor monitor) throws InvocationTargetException, InterruptedException {
      LocalVariables.getInstance().createKettleVariables(Thread.currentThread(),shell.getDisplay().getSyncThread(),true);
      try {
        transInfo=new TransMeta(rep,transname,repdir,monitor);
      }
 catch (      KettleException e) {
        throw new InvocationTargetException(e,Messages.getString("TransLoadProgressDialog.Exception.ErrorLoadingTransformation"));
      }
    }
  }
;
  try {
    ProgressMonitorDialog pmd=new ProgressMonitorDialog(shell);
    pmd.run(false,false,op);
  }
 catch (  InvocationTargetException e) {
    new ErrorDialog(shell,Props.getInstance(),Messages.getString("TransLoadProgressDialog.ErrorLoadingTransformation.DialogTitle"),Messages.getString("TransLoadProgressDialog.ErrorLoadingTransformation.DialogMessage"),e);
    transInfo=null;
  }
catch (  InterruptedException e) {
    new ErrorDialog(shell,Props.getInstance(),Messages.getString("TransLoadProgressDialog.ErrorLoadingTransformation.DialogTitle"),Messages.getString("TransLoadProgressDialog.ErrorLoadingTransformation.DialogMessage"),e);
    transInfo=null;
  }
  return transInfo;
}
