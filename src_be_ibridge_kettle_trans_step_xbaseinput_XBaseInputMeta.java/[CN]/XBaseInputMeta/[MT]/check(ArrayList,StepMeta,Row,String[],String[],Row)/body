{
  CheckResult cr;
  if (dbfFileName == null) {
    cr=new CheckResult(CheckResult.TYPE_RESULT_ERROR,"Please select or create a DBF file to use",stepinfo);
    remarks.add(cr);
  }
 else {
    cr=new CheckResult(CheckResult.TYPE_RESULT_OK,"DBF filename specified",stepinfo);
    remarks.add(cr);
    XBase xbi=new XBase(StringUtil.environmentSubstitute(dbfFileName));
    try {
      xbi.open();
      cr=new CheckResult(CheckResult.TYPE_RESULT_OK,"DBF File opened OK : exists!",stepinfo);
      remarks.add(cr);
      Row r=xbi.getFields();
      cr=new CheckResult(CheckResult.TYPE_RESULT_OK,r.size() + " fields could be determined in the DBF file",stepinfo);
      remarks.add(cr);
    }
 catch (    KettleException ke) {
      cr=new CheckResult(CheckResult.TYPE_RESULT_ERROR,"No fields could be found in the DBF file because of an error: " + Const.CR + ke.getMessage(),stepinfo);
      remarks.add(cr);
    }
 finally {
      xbi.close();
    }
  }
}
