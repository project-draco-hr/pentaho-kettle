{
  Row row;
  if (r == null)   row=new Row();
 else   row=r;
  XBase xbi=new XBase(StringUtil.environmentSubstitute(dbfFileName));
  try {
    xbi.open();
    Row add=xbi.getFields();
    for (int i=0; i < add.size(); i++) {
      Value v=add.getValue(i);
      v.setOrigin(name);
    }
    row.addRow(add);
  }
 catch (  KettleException ke) {
    throw new KettleStepException("Unable to read meta-data from XBase file!",ke);
  }
 finally {
    xbi.close();
  }
  if (rowNrAdded && rowNrField != null && rowNrField.length() > 0) {
    Value rnr=new Value(rowNrField,Value.VALUE_TYPE_INTEGER);
    rnr.setOrigin(name);
    row.addValue(rnr);
  }
  return row;
}
