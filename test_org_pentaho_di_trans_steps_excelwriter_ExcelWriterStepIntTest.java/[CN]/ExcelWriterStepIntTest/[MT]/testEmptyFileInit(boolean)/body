{
  String stepName="Excel Writer";
  ExcelWriterStepMeta meta=new ExcelWriterStepMeta();
  meta.setDefault();
  File tempOutputFile=File.createTempFile("testPDI14854",".xlsx");
  tempOutputFile.delete();
  meta.setFileName(tempOutputFile.getAbsolutePath().replace(".xlsx",""));
  meta.setExtension("xlsx");
  meta.setSheetname("Sheet10");
  meta.setOutputFields(new ExcelWriterStepField[]{});
  meta.setHeaderEnabled(true);
  meta.setDoNotOpenNewFileInit(!createEmptyFile);
  TransMeta transMeta=TransTestFactory.generateTestTransformation(null,meta,stepName);
  List<RowMetaAndData> inputList=new ArrayList<RowMetaAndData>();
  TransTestFactory.executeTestTransformation(transMeta,TransTestFactory.INJECTOR_STEPNAME,stepName,TransTestFactory.DUMMY_STEPNAME,inputList);
  try {
    Thread.sleep(1000);
  }
 catch (  InterruptedException ignore) {
  }
  assertEquals(createEmptyFile,tempOutputFile.exists());
  if (tempOutputFile.exists()) {
    tempOutputFile.delete();
  }
}
