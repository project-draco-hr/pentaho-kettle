{
  long retval=counter;
  counter+=increment;
  if (loop && counter > maximum)   counter=start;
  return retval;
}
