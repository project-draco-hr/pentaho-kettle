{
  if (string.startsWith("i18n:")) {
    String[] parts=string.split(":");
    if (parts.length != 3)     return string;
 else {
      return BaseMessages.getString(parts[1],parts[2]);
    }
  }
 else {
    int oldLogLevel=LogWriter.getInstance().getLogLevel();
    LogWriter.getInstance().setLogLevel(LogWriter.LOG_LEVEL_BASIC);
    String translation=BaseMessages.getString(packageName,string,resourceClass);
    if (translation.startsWith("!") && translation.endsWith("!"))     translation=BaseMessages.getString(PKG,string,resourceClass);
    LogWriter.getInstance().setLogLevel(oldLogLevel);
    if (translation.startsWith("!") && translation.endsWith("!"))     translation=BaseMessages.getString(altPackageName,string,resourceClass);
    return translation;
  }
}
