{
  data.bufferList.add(row);
  if (data.bufferList.size() > 5000) {
    if (data.rowsOnFile == 0) {
      try {
        data.tempFile=File.createTempFile(meta.getPrefix(),".tmp",new File(environmentSubstitute(meta.getDirectory())));
        data.fosToTempFile=new FileOutputStream(data.tempFile);
        data.dosToTempFile=new DataOutputStream(data.fosToTempFile);
        data.firstRead=true;
      }
 catch (      IOException e) {
        throw new KettleFileException(BaseMessages.getString(PKG,"GroupBy.Exception.UnableToCreateTemporaryFile"),e);
      }
    }
    Object[] oldest=data.bufferList.get(0);
    data.inputRowMeta.writeData(data.dosToTempFile,oldest);
    data.bufferList.remove(0);
    data.rowsOnFile++;
  }
}
