{
  PluginRegistry registry=getInstance();
  try {
    annotationDB=new AnnotationDB();
    URLClassLoader urlClassLoader=((URLClassLoader)pluginTypes.getClass().getClassLoader());
    URL[] urls=urlClassLoader.getURLs();
    LogChannel.GENERAL.logDetailed("Found " + urls.length + " objects in the classpath.");
    long startScan=System.currentTimeMillis();
    annotationDB.scanArchives(urls);
    LogChannel.GENERAL.logDetailed("Finished annotation scan in " + (System.currentTimeMillis() - startScan) + "ms.");
    classPathFinder=new ClassPathFinder(urlClassLoader);
  }
 catch (  IOException e) {
    throw new KettlePluginException("Unable to scan for annotations in the classpath",e);
  }
  for (  PluginTypeInterface pluginType : pluginTypes) {
    registry.registerPluginType(pluginType.getClass());
    long startScan=System.currentTimeMillis();
    pluginType.searchPlugins();
    LogChannel.GENERAL.logDetailed("Registered " + registry.getPlugins(pluginType.getClass()).size() + " plugins of type '"+ pluginType.getName()+ "' in "+ (System.currentTimeMillis() - startScan)+ "ms.");
  }
}
