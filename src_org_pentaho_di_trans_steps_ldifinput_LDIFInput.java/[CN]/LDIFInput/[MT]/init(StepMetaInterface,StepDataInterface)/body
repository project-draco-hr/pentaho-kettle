{
  meta=(LDIFInputMeta)smi;
  data=(LDIFInputData)sdi;
  if (super.init(smi,sdi)) {
    data.files=meta.getFiles(this);
    if (data.files.nrOfFiles() == 0 && data.files.nrOfMissingFiles() == 0) {
      logError(Messages.getString("LDIFInput.Log.NoFiles"));
      return false;
    }
    try {
      data.outputRowMeta=new RowMeta();
      meta.getFields(data.outputRowMeta,getStepname(),null,null,this);
      data.convertRowMeta=data.outputRowMeta.clone();
      for (int i=0; i < data.convertRowMeta.size(); i++)       data.convertRowMeta.getValueMeta(i).setType(ValueMetaInterface.TYPE_STRING);
      data.convertRowMeta=data.outputRowMeta.clone();
      for (int i=0; i < data.convertRowMeta.size(); i++) {
        data.convertRowMeta.getValueMeta(i).setType(ValueMetaInterface.TYPE_STRING);
      }
      data.rownr=1L;
      data.nrInputFields=meta.getInputFields().length;
      data.multiValueSeparator=environmentSubstitute(meta.getMultiValuedSeparator());
    }
 catch (    Exception e) {
      logError("Error initializing step: " + e.toString());
      logError(Const.getStackTracker(e));
      return false;
    }
    return true;
  }
  return false;
}
