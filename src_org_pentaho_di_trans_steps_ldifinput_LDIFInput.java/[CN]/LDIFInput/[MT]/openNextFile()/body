{
  try {
    if (data.filenr >= data.files.nrOfFiles()) {
      if (log.isDetailed())       logDetailed(Messages.getString("LDIFInput.Log.FinishedProcessing"));
      return false;
    }
    data.last_file=(data.filenr == data.files.nrOfFiles() - 1);
    data.file=(FileObject)data.files.getFile(data.filenr);
    data.filenr++;
    if (log.isDetailed())     logDetailed(Messages.getString("LDIFInput.Log.OpeningFile",data.file.toString()));
    if (meta.AddToResultFilename()) {
      ResultFile resultFile=new ResultFile(ResultFile.FILE_TYPE_GENERAL,data.file,getTransMeta().getName(),getStepname());
      resultFile.setComment(Messages.getString("LDIFInput.Log.FileAddedResult"));
      addResultFile(resultFile);
    }
    data.InputLDIF=new LDIF(KettleVFS.getFilename(data.file));
    if (log.isDetailed())     logDetailed(Messages.getString("LDIFInput.Log.FileOpened",data.file.toString()));
  }
 catch (  Exception e) {
    logError(Messages.getString("LDIFInput.Log.UnableToOpenFile","" + data.filenr,data.file.toString(),e.toString()));
    stopAll();
    setErrors(1);
    return false;
  }
  return true;
}
