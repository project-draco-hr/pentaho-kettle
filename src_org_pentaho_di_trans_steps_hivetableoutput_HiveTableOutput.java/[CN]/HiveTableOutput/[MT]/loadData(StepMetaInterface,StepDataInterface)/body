{
  String fileLocation="LOCAL";
  HiveTableOutputMeta meta=(HiveTableOutputMeta)smi;
  if (((HiveTableOutputData)data).db == null) {
    DatabaseMeta databaseMeta=new DatabaseMeta();
    HiveDatabaseMeta hiveDatabaseMeta=new HiveDatabaseMeta();
    hiveDatabaseMeta.setName("HIVE");
    hiveDatabaseMeta.setHostname(meta.getHiveHostName());
    hiveDatabaseMeta.setDatabasePortNumberString(meta.getHivePort());
    hiveDatabaseMeta.setServername(meta.getHiveHostName());
    hiveDatabaseMeta.setDatabaseName(meta.getHiveDatabase());
    hiveDatabaseMeta.setUsername(meta.getHiveUsername());
    hiveDatabaseMeta.setPassword(meta.getHivePassword());
    hiveDatabaseMeta.setPluginName("Hadoop Hive");
    hiveDatabaseMeta.setPluginId("HIVE");
    databaseMeta.setDatabaseInterface(hiveDatabaseMeta);
    ((HiveTableOutputData)data).db=new Database(this,databaseMeta);
  }
  try {
    ((HiveTableOutputData)data).db.connect();
    StringBuilder sqlStringBuilder=new StringBuilder();
    sqlStringBuilder.append("LOAD DATA ");
    sqlStringBuilder.append(fileLocation);
    sqlStringBuilder.append((meta.getTruncateTable() ? " OVERWRITE " : ""));
    sqlStringBuilder.append(" INPATH '");
    sqlStringBuilder.append(meta.getFileName());
    sqlStringBuilder.append(".");
    sqlStringBuilder.append(meta.getExtension());
    sqlStringBuilder.append("' INTO TABLE ");
    sqlStringBuilder.append(meta.getTargetTableName());
    String sqlString=sqlStringBuilder.toString();
    System.out.println(getClass().getName() + ".loadData(): sql = " + sqlString);
    Result result=((HiveTableOutputData)data).db.execStatement(sqlString);
    System.out.println(getClass().getName() + ".loadData(): statement executed.  result.getExitStatus =  " + result.getExitStatus());
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
}
