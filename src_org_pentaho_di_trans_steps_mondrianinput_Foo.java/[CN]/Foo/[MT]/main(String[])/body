{
  final String connectString="Provider=mondrian;" + "Jdbc=jdbc:odbc:MondrianFoodMart;" + "Catalog=file:demo/FoodMart.xml;"+ "JdbcDrivers=sun.jdbc.odbc.JdbcOdbcDriver";
  Connection connection=DriverManager.getConnection(connectString,null,true);
  Query query=connection.parseQuery("select\n" + " {([Gender].[F], [Measures].[Unit Sales]),\n" + "  ([Gender].[M], [Measures].[Store Sales]),\n"+ "  ([Gender].[F], [Measures].[Unit Sales])} on columns,\n"+ " CrossJoin([Marital Status].Members,\n"+ "           [Product].Children) on rows\n"+ "from [Sales]");
  Result result=connection.execute(query);
  final PrintWriter pw=new PrintWriter(System.out);
  pw.println("Output in flattened format (one row for each cell)");
  outputFlattened(result,pw);
  pw.println("Output in row format (one row for each cell)");
  outputRectangular(result,pw);
  pw.flush();
}
