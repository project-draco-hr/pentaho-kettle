{
  final Axis[] axes=result.getAxes();
  if (axes.length != 2) {
    throw new IllegalArgumentException("tabular output only supported for 2-dimensional results");
  }
  List<String> headings=new ArrayList<String>();
  List<List<Object>> rows=new ArrayList<List<Object>>();
  final Axis rowsAxis=axes[1];
  final Axis columnsAxis=axes[0];
  int rowOrdinal=-1;
  int[] coords={0,0};
  for (  Position rowPos : rowsAxis.getPositions()) {
    ++rowOrdinal;
    coords[1]=rowOrdinal;
    if (rowOrdinal == 0) {
      for (      Member rowMember : rowPos) {
        headings.add(rowMember.getHierarchy().getUniqueName());
      }
      for (      Position columnPos : columnsAxis.getPositions()) {
        String heading="";
        for (        Member columnMember : columnPos) {
          if (!heading.equals("")) {
            heading+=", ";
          }
          heading+=columnMember.getUniqueName();
        }
        headings.add(heading);
      }
    }
    List<Object> rowValues=new ArrayList<Object>();
    for (    Member rowMember : rowPos) {
      rowValues.add(rowMember.getUniqueName());
    }
    for (int columnOrdinal=0; columnOrdinal < columnsAxis.getPositions().size(); ++columnOrdinal) {
      coords[0]=columnOrdinal;
      final Cell cell=result.getCell(coords);
      rowValues.add(cell.getValue());
    }
    rows.add(rowValues);
  }
  pw.println("Headings:");
  int columnOrdinal=-1;
  for (  String heading : headings) {
    pw.println("\theading #" + (++columnOrdinal) + ": "+ heading);
  }
  pw.println();
  pw.println("Rows:");
  rowOrdinal=-1;
  for (  List<Object> rowValues : rows) {
    pw.println("\trow #" + (++rowOrdinal) + ":");
    columnOrdinal=-1;
    for (    Object rowValue : rowValues) {
      pw.println("\t\tvalue #" + (++columnOrdinal) + ": "+ rowValue);
    }
  }
}
