{
  ValueMetaInterface v=new ValueMeta(space.environmentSubstitute(getOutputMatchField()),ValueMeta.TYPE_STRING);
  v.setOrigin(name);
  v.setStorageType(ValueMeta.STORAGE_TYPE_NORMAL);
  inputRowMeta.addValueMeta(v);
  String mainField=space.environmentSubstitute(getOutputValueField());
  if (!Const.isEmpty(mainField) && isGetCloserValue()) {
switch (getAlgorithmType()) {
case FuzzyMatchMeta.OPERATION_TYPE_DAMERAU_LEVENSHTEIN:
case FuzzyMatchMeta.OPERATION_TYPE_LEVENSHTEIN:
      v=new ValueMeta(mainField,ValueMeta.TYPE_INTEGER);
    v.setLength(ValueMetaInterface.DEFAULT_INTEGER_LENGTH);
  break;
case FuzzyMatchMeta.OPERATION_TYPE_JARO:
case FuzzyMatchMeta.OPERATION_TYPE_JARO_WINKLER:
case FuzzyMatchMeta.OPERATION_TYPE_PAIR_SIMILARITY:
v=new ValueMeta(mainField,ValueMeta.TYPE_NUMBER);
break;
default :
v=new ValueMeta(mainField,ValueMeta.TYPE_STRING);
break;
}
v.setStorageType(ValueMeta.STORAGE_TYPE_NORMAL);
v.setOrigin(name);
inputRowMeta.addValueMeta(v);
}
boolean activateAdditionalFields=isGetCloserValue() || (getAlgorithmType() == FuzzyMatchMeta.OPERATION_TYPE_DOUBLE_METAPHONE) || (getAlgorithmType() == FuzzyMatchMeta.OPERATION_TYPE_SOUNDEX)|| (getAlgorithmType() == FuzzyMatchMeta.OPERATION_TYPE_REFINED_SOUNDEX)|| (getAlgorithmType() == FuzzyMatchMeta.OPERATION_TYPE_METAPHONE);
if (activateAdditionalFields) {
if (info != null && info.length == 1 && info[0] != null) {
for (int i=0; i < valueName.length; i++) {
v=info[0].searchValueMeta(value[i]);
if (v != null) {
v.setName(valueName[i]);
v.setOrigin(name);
v.setStorageType(ValueMetaInterface.STORAGE_TYPE_NORMAL);
inputRowMeta.addValueMeta(v);
}
 else {
throw new KettleStepException(BaseMessages.getString(PKG,"FuzzyMatchMeta.Exception.ReturnValueCanNotBeFound",value[i]));
}
}
}
 else {
for (int i=0; i < valueName.length; i++) {
v=new ValueMeta(valueName[i],ValueMeta.TYPE_STRING);
v.setOrigin(name);
inputRowMeta.addValueMeta(v);
}
}
}
}
