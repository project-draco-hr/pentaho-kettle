{
  try {
    if (connection != null) {
      connection.close();
      if (!databaseMeta.isUsingConnectionPool()) {
        connection=null;
      }
    }
    if (log.isDetailed())     log.logDetailed(toString(),"Connection to database closed!");
  }
 catch (  SQLException e) {
    throw new KettleDatabaseException("Error disconnecting from database '" + toString() + "'",e);
  }
}
