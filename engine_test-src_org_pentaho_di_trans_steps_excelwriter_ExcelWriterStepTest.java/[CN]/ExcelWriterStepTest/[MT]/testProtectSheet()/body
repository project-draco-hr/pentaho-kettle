{
  File xlsFile=File.createTempFile("testXLSProtect",".xls");
  HSSFWorkbook wb=createWorkbook(xlsFile);
  StepMockHelper<ExcelWriterStepMeta,ExcelWriterStepData> mockHelper=new StepMockHelper<ExcelWriterStepMeta,ExcelWriterStepData>("Excel Writer Test",ExcelWriterStepMeta.class,ExcelWriterStepData.class);
  when(mockHelper.logChannelInterfaceFactory.create(any(),any(LoggingObjectInterface.class))).thenReturn(mockHelper.logChannelInterface);
  ExcelWriterStep step=new ExcelWriterStep(mockHelper.stepMeta,mockHelper.stepDataInterface,0,mockHelper.transMeta,mockHelper.trans);
  step.protectSheet(wb.getSheet(SHEET_NAME),"aa");
  assertTrue(wb.getSheet(SHEET_NAME).getProtect());
}
