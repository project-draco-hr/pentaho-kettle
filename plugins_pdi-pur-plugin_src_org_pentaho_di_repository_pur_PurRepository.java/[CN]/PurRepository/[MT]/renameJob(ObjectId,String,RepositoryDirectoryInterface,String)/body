{
  String absPath=calcDestAbsPath(idJobForRename,newDirectory,newJobName,RepositoryObjectType.JOB);
  RepositoryFile fileFromDestination=pur.getFile(absPath);
  RepositoryFile fileBeforeRename=pur.getFileById(idJobForRename.getId());
  if (fileFromDestination == null && newJobName != null) {
    fileBeforeRename=new RepositoryFile.Builder(fileBeforeRename).title(RepositoryFile.DEFAULT_LOCALE,newJobName).build();
    NodeRepositoryFileData data=pur.getDataAtVersionForRead(fileBeforeRename.getId(),null,NodeRepositoryFileData.class);
    fileBeforeRename=pur.updateFile(fileBeforeRename,data,versionComment);
    pur.moveFile(idJobForRename.getId(),absPath,null);
    rootRef.clearRef();
    return idJobForRename;
  }
 else {
    throw new KettleException(BaseMessages.getString(PKG,"PurRepository.ERROR_0006_UNABLE_TO_RENAME_JOB",fileBeforeRename.getName(),newJobName));
  }
}
