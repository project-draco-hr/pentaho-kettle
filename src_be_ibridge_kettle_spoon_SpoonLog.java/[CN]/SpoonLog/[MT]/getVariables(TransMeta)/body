{
  Properties sp=new Properties();
  KettleVariables kettleVariables=KettleVariables.getInstance();
  sp.putAll(kettleVariables.getProperties());
  sp.putAll(System.getProperties());
  List vars=transMeta.getUsedVariables();
  if (vars != null && vars.size() > 0) {
    Row variables=new Row();
    for (int i=0; i < vars.size(); i++) {
      String varname=(String)vars.get(i);
      Value varval=new Value(varname,sp.getProperty(varname,""));
      variables.addValue(varval);
    }
    EnterStringsDialog esd=new EnterStringsDialog(shell,SWT.NONE,variables);
    if (esd.open() != null) {
      for (int i=0; i < variables.size(); i++) {
        Value varval=variables.getValue(i);
        kettleVariables.setVariable(varval.getName(),varval.getString());
        System.out.println("Variable ${" + varval.getName() + "} set to ["+ varval.getString()+ "]");
      }
    }
  }
}
