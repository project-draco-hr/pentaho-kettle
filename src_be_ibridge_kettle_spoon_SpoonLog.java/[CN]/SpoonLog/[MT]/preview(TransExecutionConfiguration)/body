{
  if (!running) {
    try {
      log.logDetailed(toString(),Messages.getString("SpoonLog.Log.DoPreview"));
      String[] args=null;
      Row arguments=executionConfiguration.getArguments();
      if (arguments != null) {
        args=convertArguments(arguments);
      }
      setVariables(executionConfiguration);
      spoon.tabfolder.setSelection(1);
      trans=new Trans(log,spoon.getTransMeta(),executionConfiguration.getPreviewSteps(),executionConfiguration.getPreviewSizes());
      trans.execute(args);
      preview=true;
      readLog();
      running=!running;
      wStart.setText(STOP_TEXT);
    }
 catch (    Exception e) {
      new ErrorDialog(shell,Messages.getString("SpoonLog.Dialog.UnexpectedErrorDuringPreview.Title"),Messages.getString("SpoonLog.Dialog.UnexpectedErrorDuringPreview.Message"),e);
    }
  }
 else {
    MessageBox m=new MessageBox(shell,SWT.OK | SWT.ICON_WARNING);
    m.setText(Messages.getString("SpoonLog.Dialog.DoNoPreviewWhileRunning.Title"));
    m.setMessage(Messages.getString("SpoonLog.Dialog.DoNoPreviewWhileRunning.Message"));
    m.open();
  }
}
