{
  try {
    LogWriter log=LogWriter.getInstance();
    TransMeta transMeta=null;
    if (!Const.isEmpty(getFilename())) {
      String filename=parentVariableSpace != null ? parentVariableSpace.environmentSubstitute(getFilename()) : environmentSubstitute(getFilename());
      log.logBasic(toString(),"Loading transformation from XML file [" + filename + "]");
      transMeta=new TransMeta(filename);
      transMeta.setParentVariableSpace(parentVariableSpace);
    }
 else     if (!Const.isEmpty(getTransname()) && getDirectory() != null) {
      String filename=parentVariableSpace != null ? parentVariableSpace.environmentSubstitute(getTransname()) : environmentSubstitute(getTransname());
      log.logBasic(toString(),"Loading transformation from repository [" + filename + "] in directory ["+ getDirectory()+ "]");
      if (rep != null) {
        transMeta=new TransMeta(rep,filename,getDirectory());
        transMeta.setParentVariableSpace(parentVariableSpace);
      }
 else {
        throw new KettleException("No repository defined!");
      }
    }
 else {
      throw new KettleJobException("The transformation to execute is not specified!");
    }
    transMeta.setArguments(arguments);
    return transMeta;
  }
 catch (  Exception e) {
    throw new KettleException("Unexpected error during transformation metadata load",e);
  }
}
