{
  try {
    LogWriter log=LogWriter.getInstance();
    TransMeta transMeta=null;
    if (!Const.isEmpty(getFilename())) {
      String filename=environmentSubstitute(getFilename());
      log.logBasic(toString(),"Loading transformation from XML file [" + filename + "]");
      transMeta=new TransMeta(filename,null,true,this);
      transMeta.copyVariablesFrom(this);
    }
 else     if (!Const.isEmpty(getTransname()) && getDirectory() != null) {
      String filename=environmentSubstitute(getTransname());
      log.logBasic(toString(),BaseMessages.getString(PKG,"JobTrans.Log.LoadingTransRepDirec",filename,"" + getDirectory()));
      if (rep != null) {
        transMeta=new TransMeta(rep,filename,rep.getDirectoryTree().findDirectory(environmentSubstitute(getDirectory())));
        transMeta.copyVariablesFrom(this);
      }
 else {
        throw new KettleException(BaseMessages.getString(PKG,"JobTrans.Exception.NoRepDefined"));
      }
    }
 else {
      throw new KettleJobException(BaseMessages.getString(PKG,"JobTrans.Exception.TransNotSpecified"));
    }
    transMeta.setArguments(arguments);
    return transMeta;
  }
 catch (  Exception e) {
    throw new KettleException(BaseMessages.getString(PKG,"JobTrans.Exception.MetaDataLoad"),e);
  }
}
