{
  LogWriter log=LogWriter.getInstance();
  TransMeta transMeta=null;
  if (!Const.isEmpty(getFilename())) {
    log.logBasic(toString(),"Loading transformation from XML file [" + environmentSubstitute(getFilename()) + "]");
    transMeta=new TransMeta(environmentSubstitute(getFilename()));
  }
 else   if (!Const.isEmpty(getTransname()) && getDirectory() != null) {
    log.logBasic(toString(),"Loading transformation from repository [" + environmentSubstitute(getTransname()) + "] in directory ["+ getDirectory()+ "]");
    if (rep != null) {
      transMeta=new TransMeta(rep,environmentSubstitute(getTransname()),getDirectory());
    }
 else {
      throw new KettleException("No repository defined!");
    }
  }
 else {
    throw new KettleJobException("The transformation to execute is not specified!");
  }
  transMeta.setArguments(arguments);
  return transMeta;
}
