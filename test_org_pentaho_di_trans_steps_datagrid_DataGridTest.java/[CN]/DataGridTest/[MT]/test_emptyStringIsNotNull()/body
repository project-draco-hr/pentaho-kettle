{
  FieldAccessorUtl.ensureEmptyStringIsNotNull(true);
  final DataGridMeta meta=new DataGridMeta();
  String[] fieldNames=new String[]{FIELD_NAME_STR_1,FIELD_NAME_NUM_2,FIELD_NAME_NUM_1};
  final String[] fieldTypes=new String[]{FIELD_TYPE_STRING,FIELD_TYPE_STRING,FIELD_TYPE_NUMBER};
  String[] fieldFormats=new String[]{null,null,null};
  String[] currencies=new String[]{null,null,null};
  String[] decimals=new String[]{null,null,null};
  String[] groups=new String[]{null,null,null};
  int[] fieldLengths=new int[]{-1,-1,-1};
  int[] fieldPrecisions=new int[]{-1,-1,-1};
  boolean[] setEmptyStrings=new boolean[]{false,true,false};
  final int fieldsCount=fieldNames.length;
  Assert.assertEquals("(test data) fieldTypes.length",fieldsCount,fieldTypes.length);
  Assert.assertEquals("(test data) fieldFormats.length",fieldsCount,fieldFormats.length);
  Assert.assertEquals("(test data) currencies.length",fieldsCount,currencies.length);
  Assert.assertEquals("(test data) decimals.length",fieldsCount,decimals.length);
  Assert.assertEquals("(test data) groups.length",fieldsCount,groups.length);
  Assert.assertEquals("(test data) fieldLengths.length",fieldsCount,fieldLengths.length);
  Assert.assertEquals("(test data) fieldPrecisions.length",fieldsCount,fieldPrecisions.length);
  Assert.assertEquals("(test data) setEmptyStrings.length",fieldsCount,setEmptyStrings.length);
  final String[][] dataRows=new String[][]{new String[]{"1","2","3"},new String[]{"a","b","34"},new String[]{" ","  "," "},new String[]{"","",""},new String[]{null,null,null}};
  final int rowCount=dataRows.length;
  assertSize("(test data) dataRows",rowCount,fieldsCount,dataRows);
  meta.setFieldName(fieldNames);
  meta.setFieldType(fieldTypes);
  meta.setFieldFormat(fieldFormats);
  meta.setCurrency(currencies);
  meta.setDecimal(decimals);
  meta.setGroup(groups);
  meta.setFieldLength(fieldLengths);
  meta.setFieldPrecision(fieldPrecisions);
  meta.setEmptyString(setEmptyStrings);
  final String[] expectedFieldNames=fieldNames;
  final int[] expectedFieldTypes=new int[]{ValueMetaInterface.TYPE_STRING,ValueMetaInterface.TYPE_STRING,ValueMetaInterface.TYPE_NUMBER};
  final int expectedRowCount=rowCount;
  final int expectedFieldsCount=fieldsCount;
  Assert.assertEquals("(test data) expectedFieldNames.length",expectedFieldsCount,expectedFieldNames.length);
  Assert.assertEquals("(test data) expectedFieldTypes.length",expectedFieldsCount,expectedFieldTypes.length);
  Assert.assertEquals("(test data) expectedFieldTypes.length",expectedFieldsCount,expectedFieldTypes.length);
  Object[][] expectedRows=new Object[][]{new Object[]{"1","",3.0},new Object[]{"a","",34.0},new Object[]{"","",null},new Object[]{"","",null},new Object[]{null,"",null}};
  assertSize("(test data) expectedRows",expectedRowCount,expectedFieldsCount,expectedRows);
  meta.setDataLines(buildListListString(dataRows));
{
    final TransMeta transMeta=TransTestFactory.generateTestTransformation(null,meta,STEP_NAME);
    final List<RowMetaAndData> inputList=java.util.Collections.singletonList(new RowMetaAndData(new RowMeta(),new Object[0]));
    List<RowMetaAndData> ret=TransTestFactory.executeTestTransformation(transMeta,TransTestFactory.INJECTOR_STEPNAME,STEP_NAME,TransTestFactory.DUMMY_STEPNAME,inputList);
    assertResultRows("empty input data",expectedRows,expectedFieldNames,expectedFieldTypes,ret);
  }
{
    final TransMeta transMeta=TransTestFactory.generateTestTransformation(null,meta,STEP_NAME);
    final RowMetaInterface inputRowMeta=buildRowMeta(new ValueMetaString("ff"));
    final Object[] inputRowData=new Object[]{"asdf"};
    final List<RowMetaAndData> inputList=java.util.Collections.singletonList(new RowMetaAndData(inputRowMeta,inputRowData));
    List<RowMetaAndData> ret=TransTestFactory.executeTestTransformation(transMeta,TransTestFactory.INJECTOR_STEPNAME,STEP_NAME,TransTestFactory.DUMMY_STEPNAME,inputList);
    assertResultRows("not empty input data",expectedRows,expectedFieldNames,expectedFieldTypes,ret);
  }
}
