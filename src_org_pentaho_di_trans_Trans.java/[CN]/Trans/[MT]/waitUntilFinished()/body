{
  if (!finished.get()) {
    try {
      final BlockingQueue<Object> queue=new ArrayBlockingQueue<Object>(10);
      addTransListener(new TransAdapter(){
        public void transFinished(        Trans trans) throws KettleException {
          queue.add(new Object());
        }
      }
);
      while (!finished.get() || queue.poll(1,TimeUnit.SECONDS) == null)       ;
    }
 catch (    InterruptedException e) {
      throw new RuntimeException("Waiting for transformation to be finished interrupted!",e);
    }
  }
}
