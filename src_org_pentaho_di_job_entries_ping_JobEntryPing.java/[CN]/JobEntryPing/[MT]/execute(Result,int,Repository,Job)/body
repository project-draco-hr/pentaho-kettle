{
  LogWriter log=LogWriter.getInstance();
  Result result=previousResult;
  result.setNrErrors(1);
  result.setResult(false);
  String hostname=getRealHostname();
  int timeoutInt=Const.toInt(getRealTimeOut(),300);
  int packets=Const.toInt(getRealNbrPackets(),2);
  boolean status=false;
  if (Const.isEmpty(hostname)) {
    log.logError(toString(),Messages.getString("JobPing.SpecifyHost.Label"));
    return result;
  }
  try {
    if (ipingtype == isystemPing || ipingtype == ibothPings) {
      status=SystemPing(hostname,timeoutInt,log);
      if (status) {
        if (log.isDetailed())         log.logDetailed(Messages.getString("JobPing.SystemPing"),Messages.getString("JobPing.OK.Label",hostname));
      }
 else       log.logError(Messages.getString("JobPing.SystemPing"),Messages.getString("JobPing.NOK.Label",hostname));
    }
    if ((ipingtype == iclassicPing) || (ipingtype == ibothPings && !status)) {
      status=ClassicPing(hostname,packets,log);
      if (status) {
        if (log.isDetailed())         log.logDetailed(Messages.getString("JobPing.ClassicPing"),Messages.getString("JobPing.OK.Label",hostname));
      }
 else       log.logError(Messages.getString("JobPing.ClassicPing"),Messages.getString("JobPing.NOK.Label",hostname));
    }
  }
 catch (  Exception ex) {
    log.logError(toString(),Messages.getString("JobPing.Error.Label") + ex.getMessage());
  }
  if (status) {
    if (log.isDetailed())     log.logDetailed(toString(),Messages.getString("JobPing.OK.Label",hostname));
    result.setNrErrors(0);
    result.setResult(true);
  }
 else   log.logError(toString(),Messages.getString("JobPing.NOK.Label",hostname));
  return result;
}
